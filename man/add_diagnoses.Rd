% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_diagnoses_and_operations.R
\name{add_diagnoses}
\alias{add_diagnoses}
\title{Add diagnosis data to skeleton}
\usage{
add_diagnoses(
  skeleton,
  dataset,
  id_name,
  diag_type = "both",
  diags = list(icd10_F64_0 = c("F640"), icd10_F64_89 = c("F6489"), icd10_F64_089 =
    c("F640", "F648", "F649"))
)
}
\arguments{
\item{skeleton}{A data.table containing the main skeleton structure created by \code{\link{create_skeleton}}}

\item{dataset}{A data.table containing hospital registry data with diagnosis codes.
Must have columns for person ID, date variables, and diagnosis codes (hdia, dia1, dia2, etc.)}

\item{id_name}{Character string specifying the name of the ID variable in the dataset}

\item{diag_type}{Character string specifying which diagnosis types to search:
\itemize{
  \item "both" (default) - Search in both main (hdia) and secondary (dia1, dia2, etc.) diagnoses
  \item "main" - Search only in main diagnoses (hdia)
}}

\item{diags}{Named list of ICD-10 code patterns to search for. Names become variable names in skeleton.
Patterns should NOT include "^" prefix (automatically added). Use exclusions with "!" prefix.
Example: \code{list("depression" = c("F32", "F33"), "anxiety" = c("F40", "F41"))}}
}
\value{
The skeleton data.table is modified by reference with diagnosis variables added.
  New boolean variables are created for each diagnosis pattern, TRUE when diagnosis is present.
}
\description{
Searches for specific ICD-10 diagnosis codes in Swedish hospital registry data
and adds corresponding boolean variables to the skeleton. Can search in main
diagnoses only or both main and secondary diagnoses.
}
\examples{
# Load fake data
data("fake_person_ids", package = "swereg")
data("fake_inpatient_diagnoses", package = "swereg")
swereg::make_lowercase_names(fake_inpatient_diagnoses, date_columns = "indatum")

# Create skeleton
skeleton <- create_skeleton(fake_person_ids[1:10], "2020-01-01", "2020-12-31")

# Add diagnoses
diag_patterns <- list(
  "depression" = c("F32", "F33"),
  "anxiety" = c("F40", "F41")
)
add_diagnoses(skeleton, fake_inpatient_diagnoses, "lopnr", "both", diag_patterns)
}
\seealso{
\code{\link{create_skeleton}} for creating the skeleton structure,
  \code{\link{add_operations}} for surgical procedures,
  \code{\link{add_rx}} for prescription data,
  \code{\link{make_lowercase_names}} for data preprocessing

Other data_integration: 
\code{\link{add_annual}()},
\code{\link{add_cods}()},
\code{\link{add_onetime}()},
\code{\link{add_operations}()},
\code{\link{add_rx}()}
}
\concept{data_integration}
