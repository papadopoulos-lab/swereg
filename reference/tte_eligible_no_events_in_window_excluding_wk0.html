<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check eligibility based on no events in prior window (excluding baseline week) — tte_eligible_no_events_in_window_excluding_wk0 • swereg</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check eligibility based on no events in prior window (excluding baseline week) — tte_eligible_no_events_in_window_excluding_wk0"><meta name="description" content="Adds a logical column indicating whether there were NO TRUE values in the
specified event variable within the prior window, EXCLUDING the current
(baseline) week. This is the correct semantic for trial eligibility: we want
to know if someone had the event BEFORE they could potentially enter the trial."><meta property="og:description" content="Adds a logical column indicating whether there were NO TRUE values in the
specified event variable within the prior window, EXCLUDING the current
(baseline) week. This is the correct semantic for trial eligibility: we want
to know if someone had the event BEFORE they could potentially enter the trial."><meta property="og:image" content="https://papadopoulos-lab.github.io/swereg/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">swereg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">26.2.20</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/skeleton-concept.html">Skeleton concept</a></li>
    <li><a class="dropdown-item" href="../articles/rowdep-rowind-concept.html">Variable types: rowdep vs rowind</a></li>
    <li><a class="dropdown-item" href="../articles/tte-nomenclature.html">Target trial emulation nomenclature</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Implementation</h6></li>
    <li><a class="dropdown-item" href="../articles/skeleton1-create.html">Building the data skeleton (skeleton1_create)</a></li>
    <li><a class="dropdown-item" href="../articles/skeleton2-clean.html">Cleaning and deriving variables (skeleton2_clean)</a></li>
    <li><a class="dropdown-item" href="../articles/skeleton3-analyze.html">Batching (skeleton3_analyze)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cookbooks</h6></li>
    <li><a class="dropdown-item" href="../articles/cookbook-survival-analysis.html">Survival analysis with time-varying covariates</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/papadopoulos-lab/swereg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Check eligibility based on no events in prior window (excluding baseline week)</h1>
      <small class="dont-index">Source: <a href="https://github.com/papadopoulos-lab/swereg/blob/main/R/tte_eligibility.R" class="external-link"><code>R/tte_eligibility.R</code></a></small>
      <div class="d-none name"><code>tte_eligible_no_events_in_window_excluding_wk0.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Adds a logical column indicating whether there were NO TRUE values in the
specified event variable within the prior window, EXCLUDING the current
(baseline) week. This is the correct semantic for trial eligibility: we want
to know if someone had the event BEFORE they could potentially enter the trial.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tte_eligible_no_events_in_window_excluding_wk0</span><span class="op">(</span></span>
<span>  <span class="va">dt</span>,</span>
<span>  <span class="va">event_var</span>,</span>
<span>  window <span class="op">=</span> <span class="fl">52</span>,</span>
<span>  col_name <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dt">dt<a class="anchor" aria-label="anchor" href="#arg-dt"></a></dt>
<dd><p>A data.table with the specified event variable. Must be grouped
by person ID for proper calculation.</p></dd>


<dt id="arg-event-var">event_var<a class="anchor" aria-label="anchor" href="#arg-event-var"></a></dt>
<dd><p>Character. Name of a logical column indicating event
occurrence.</p></dd>


<dt id="arg-window">window<a class="anchor" aria-label="anchor" href="#arg-window"></a></dt>
<dd><p>Integer or Inf. Number of prior weeks to check (excluding
current week). Use `Inf` to check entire lifetime history.
Default: 52 (one year).</p></dd>


<dt id="arg-col-name">col_name<a class="anchor" aria-label="anchor" href="#arg-col-name"></a></dt>
<dd><p>Character or NULL. Name of the eligibility column to create.
If NULL, auto-generates as "eligible_no_&lt;event_var&gt;_&lt;window&gt;wk" or
"eligible_no_&lt;event_var&gt;_ever" for Inf window.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The input data.table (invisibly), modified by reference with the new
  eligibility column.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Uses [any_events_prior_to()] internally with `.after = -1L`, which always
excludes the current row.</p>

<p>**Why exclude baseline week?**</p>
<p>In target trial emulation, eligibility is assessed at the moment of potential
trial entry. An event occurring IN the baseline week cannot be used to
determine eligibility because it happens simultaneously with (or after)
the eligibility assessment. The semantic is: "Did this person have the
event BEFORE this week?"</p>
<p>Using `cumsum(x) == 0` is INCORRECT because it INCLUDES the current week.
This function correctly excludes the current week.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>[any_events_prior_to()] for the underlying function,
  [tte_eligible_combine()] to combine multiple eligibility criteria</p>
<p>Other tte_eligibility:
<code><a href="tte_eligible_age_range.html">tte_eligible_age_range()</a></code>,
<code><a href="tte_eligible_combine.html">tte_eligible_combine()</a></code>,
<code><a href="tte_eligible_isoyears.html">tte_eligible_isoyears()</a></code>,
<code><a href="tte_eligible_no_observation_in_window_excluding_wk0.html">tte_eligible_no_observation_in_window_excluding_wk0()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># No psychosis diagnosis ever (excluding baseline week)</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">tte_eligible_no_events_in_window_excluding_wk0</span><span class="op">(</span><span class="st">"icd10_f20_f29"</span>, window <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># No antipsychotic prescriptions in prior year (excluding baseline week)</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">tte_eligible_no_events_in_window_excluding_wk0</span><span class="op">(</span><span class="st">"rx_n05a"</span>, window <span class="op">=</span> <span class="fl">52</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Crafted by <a href="https://www.rwhite.no" class="external-link">Richard Aubrey White</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

