[{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"project-overview","dir":"","previous_headings":"","what":"Project overview","title":"CLAUDE.md","text":"swereg R package manipulating analyzing Swedish healthcare registry data epidemiological research. creates longitudinal data skeletons ISO year-week structure integrates multiple Swedish health registries (NPR, LMED, Cause Death). package optimized gender dysphoria research works general registry analysis.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"core-development-workflow","dir":"","previous_headings":"Development commands","what":"Core development workflow","title":"CLAUDE.md","text":"","code":"# Load package functions during development devtools::load_all(\".\")  # Generate documentation devtools::document()  # Check package integrity (includes tests, examples, documentation) devtools::check()  # Alternative: Use R CMD check (more comprehensive, CRAN-style) R CMD check .  # Build and install devtools::build() devtools::install()"},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"testing-and-development-scripts","dir":"","previous_headings":"Development commands","what":"Testing and development scripts","title":"CLAUDE.md","text":"","code":"# Generate fake data (run once or when data structure changes) source(\"dev/generate_fake_data.R\")  # Quick functionality test source(\"dev/quick_test.R\")  # Full workflow test with all features source(\"dev/test_with_fake_data.R\")  # Memory-efficient batched workflow (production-style) source(\"dev/workflow_batched_memory_efficient.R\")  # Load required libraries for manual testing library(data.table) devtools::load_all(\".\")"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"three-stage-workflow-pattern","dir":"","previous_headings":"Architecture and data flow","what":"Three-stage workflow pattern","title":"CLAUDE.md","text":"swereg follows systematic three-stage approach (“Good Bones, Muscles”): skeleton1_create: Raw data integration - Create time skeleton merge registry data skeleton2_clean: Data cleaning derived variables - Clean process within skeleton skeleton3_analyze: Analysis-ready dataset preparation - Final analysis preparation","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"core-pattern-longitudinal-skeleton--sequential-data-integration","dir":"","previous_headings":"Architecture and data flow","what":"Core pattern: longitudinal skeleton + sequential data integration","title":"CLAUDE.md","text":"Skeleton Creation: create_skeleton() builds time-structured framework individual IDs ISO weeks Sequential Data Addition: Use specialized functions add different data types data.table Optimization: operations use data.table efficient processing large datasets","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"key-integration-functions-in-typical-order-of-use","dir":"","previous_headings":"Architecture and data flow","what":"Key integration functions (in typical order of use)","title":"CLAUDE.md","text":"add_onetime() - Baseline/demographic data (one record per person) add_annual() - Annual data specific years (e.g., socioeconomic status) add_diagnoses() - NPR diagnosis data ICD-10 codes (hospital visits) add_operations() - Surgical procedure codes NPR add_rx() - LMED prescription data ATC codes treatment periods add_cods() - Cause death information","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"swedish-registry-context","dir":"","previous_headings":"Architecture and data flow","what":"Swedish registry context","title":"CLAUDE.md","text":"NPR (National Patient Register): Specialist healthcare (inpatient sv outpatient ov) LMED (Prescribed Drug Register): Prescription medications ATC codes SCB (Statistics Sweden): Demographics socioeconomic data Cause Death Register: Mortality data ICD-10 codes Uses cstime package Swedish ISO time standards","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"always-apply-make_lowercase_names-with-date-cleaning","dir":"","previous_headings":"Critical data processing rules","what":"Always apply make_lowercase_names() with date cleaning","title":"CLAUDE.md","text":"ESSENTIAL: imported data must processed swereg::make_lowercase_names() use. Now includes automatic date cleaning: transforms column names like LopNr → lopnr, ATC → atc, INDATUM → indatum, converts specified date columns Date class.","code":"# Read data data <- fread(\"file.txt\")  # or haven::read_sas() etc.  # REQUIRED: Apply lowercase transformation with date cleaning swereg::make_lowercase_names(data, date_column = \"INDATUM\")  # Now safe to use with swereg functions - note that a 'date' column is created swereg::add_diagnoses(skeleton, data, id_name = \"lopnr\", ...)"},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"swedish-date-parsing","dir":"","previous_headings":"Critical data processing rules","what":"Swedish date parsing","title":"CLAUDE.md","text":"Swedish registry dates come different precision levels. make_lowercase_names() function date_columns parameter handles: Date format handling: - 4 characters (YYYY): Year → adds July 1st default - 6 characters (YYYYMM): Year-month → adds 15th default - 8 characters (YYYYMMDD): Full date → uses -- Special cases: “0000” → “0701”, “00” → “15”","code":"# Apply make_lowercase_names with date parsing swereg::make_lowercase_names(data, date_columns = \"INDATUM\")  # Custom defaults for missing date parts swereg::make_lowercase_names(data, date_columns = \"INDATUM\",                              default_month_day = \"0101\", default_day = \"01\")"},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"expected-column-names-after-make_lowercase_names","dir":"","previous_headings":"Critical data processing rules","what":"Expected column names after make_lowercase_names()","title":"CLAUDE.md","text":"Person IDs: lopnr (SCB), lopnr (NPR transformation), p444_lopnr_personnr (LMED) Dates: indatum (admission), utdatum (discharge), edatum (prescription), dodsdat (death) Note: Date columns converted Date class place date_columns parameter used Diagnosis codes: hdia (main), dia1, dia2, etc. (secondary), ekod1, etc. (external causes) Operation codes: op1, op2, etc. Prescription codes: atc (drug code), fddd (treatment duration)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"package-data-for-development","dir":"","previous_headings":"","what":"Package data for development","title":"CLAUDE.md","text":"package includes synthetic Swedish registry data development examples: - fake_demographics - SCB demographics (lopnr, fodelseman, DodDatum) - fake_annual_family - SCB annual family data (lopnr, FamTyp) - fake_diagnoses - Combined diagnoses SOURCE column (inpatient/outpatient/cancer) - fake_prescriptions - LMED prescription data (37 columns) - fake_cod - Cause death registry data - fake_person_ids - Reference list person identifiers Load : data(\"fake_demographics\") etc. Note: synthetic datasets designed replicate structure characteristics real Swedish registry data maintaining confidentiality privacy.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"typical-analysis-workflow","dir":"","previous_headings":"Code patterns","what":"Typical analysis workflow","title":"CLAUDE.md","text":"","code":"# 1. Create skeleton (now includes personyears column) skeleton <- create_skeleton(ids, \"2001-01-01\", \"2020-12-31\")  # 2. Add baseline data demographics <- fread(\"demographics.csv\") swereg::make_lowercase_names(demographics, date_columns = \"FodelseMan\") add_onetime(skeleton, demographics, \"lopnr\")  # 3. Add longitudinal data hospital_data <- haven::read_sas(\"hospital.sas7bdat\") swereg::make_lowercase_names(hospital_data, date_columns = \"INDATUM\") add_diagnoses(skeleton, hospital_data, \"lopnr\", diags = list(   \"depression\" = c(\"^F32\", \"^F33\"),   \"anxiety\" = c(\"^F40\", \"^F41\") ))  # 3b. Optional: Track diagnoses by source (inpatient/outpatient) separately # Filter the dataset before calling add_diagnoses() for source-specific tracking inpatient_data <- hospital_data[source == \"inpatient\"] add_diagnoses(skeleton, inpatient_data, \"lopnr\", diags = list(   \"depression_inpatient\" = c(\"^F32\", \"^F33\") )) outpatient_data <- hospital_data[source == \"outpatient\"] add_diagnoses(skeleton, outpatient_data, \"lopnr\", diags = list(   \"depression_outpatient\" = c(\"^F32\", \"^F33\") ))  # 4. Add prescriptions prescriptions <- fread(\"prescriptions.txt\") swereg::make_lowercase_names(prescriptions, date_columns = \"EDATUM\") add_rx(skeleton, prescriptions, \"lopnr\", drugs = list(   \"antidepressants\" = c(\"^N06A\") ))  # 5. Create rowind variables (skeleton2_clean phase) # Age at first depression diagnosis make_rowind_first_occurrence(skeleton,                             condition = \"depression == TRUE\",                             value_var = \"age\",                             new_var = \"rowind_age_first_depression\")  # Year of first antidepressant prescription   make_rowind_first_occurrence(skeleton,                             condition = \"antidepressants == TRUE\",                             value_var = \"isoyear\",                             new_var = \"rowind_isoyear_first_antidep\")"},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"pattern-matching-for-medical-codes","dir":"","previous_headings":"Code patterns","what":"Pattern matching for medical codes","title":"CLAUDE.md","text":"Regex patterns: Use ^ prefix exact starts (e.g., \"^F640\") Exclusions: Use ! prefix exclude (e.g., \"!F640\") Multiple patterns: Combine lists (e.g., c(\"^F640\", \"^F648\", \"^F649\")) Historical codes: ICD-9 uses [-Z] suffixes, ICD-8 uses comma delimiters","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"understanding-rowdep-vs-rowind-variables","dir":"","previous_headings":"Data Variable Types and Transformations","what":"Understanding rowdep vs rowind Variables","title":"CLAUDE.md","text":"longitudinal registry data analysis swereg, variables classified two fundamental types: rowdep (row-dependent): Variables can change time person rowind (row-independent): Variables change time person distinction crucial effective analysis, particularly skeleton2_clean phase many transformations convert rowdep variables rowind variables.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"examples-of-variable-types","dir":"","previous_headings":"Data Variable Types and Transformations","what":"Examples of Variable Types","title":"CLAUDE.md","text":"Row-dependent (rowdep) Variables: - rowdep_edu_cat: Education level (can improve time) - rowdep_income_inflation_adjusted: Annual income (changes yearly) - f64_diag: diagnosis week (TRUE/FALSE time period) - Current values vary isoyear/isoyearweek Row-independent (rowind) Variables: - rowind_age_first_gd: Age first diagnosis (fixed occurred) - rowind_isoyear_first_gd: Year first diagnosis (historical fact) - rowind_birthcountry: Birth country (never changes) - rowind_register_tag: Person’s role study (case, control, etc.) - rowind_age_death: Age death (fixed occurred)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"helper-function-make_rowind_first_occurrence","dir":"","previous_headings":"Data Variable Types and Transformations","what":"Helper Function: make_rowind_first_occurrence()","title":"CLAUDE.md","text":"make_rowind_first_occurrence() function simplifies common pattern creating row-independent variables first occurrence conditions: Function features: - Automatically handles temp variable creation cleanup - Uses first_non_na() robust aggregation across variable types - Includes comprehensive input validation clear error messages - Works condition can evaluated data.table syntax","code":"# Example: Create rowind variable for year of first F64 diagnosis make_rowind_first_occurrence(skeleton,                             condition = \"f64_diag == TRUE\",                             value_var = \"isoyear\",                              new_var = \"rowind_isoyear_first_f64\")  # More complex condition example make_rowind_first_occurrence(skeleton,                             condition = \"diag_gd_icd10_F64_089 == TRUE & is_amab == FALSE\",                             value_var = \"age\",                             new_var = \"rowind_age_first_gd_afab\")"},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"common-rowdep--rowind-transformation-patterns","dir":"","previous_headings":"Data Variable Types and Transformations","what":"Common rowdep → rowind Transformation Patterns","title":"CLAUDE.md","text":"","code":"# Manual pattern (traditional approach) skeleton[condition_is_true, temp := value_to_capture] skeleton[, new_rowind_var := first_non_na(temp), by = .(id)] skeleton[, temp := NULL]  # Helper function pattern (recommended) make_rowind_first_occurrence(skeleton, \"condition_is_true\", \"value_to_capture\", \"new_rowind_var\")"},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"integration-with-swereg-workflow","dir":"","previous_headings":"Data Variable Types and Transformations","what":"Integration with swereg Workflow","title":"CLAUDE.md","text":"rowdep/rowind concept fits standard swereg workflow: skeleton1_create: Focus data integration, creates mostly rowdep variables skeleton2_clean: Heavy focus rowdep → rowind transformations skeleton3_analyze: Work clean rowind variables analysis skeleton2_clean phase rowdep → rowind transformations occur, prepare stable person-level characteristics downstream analysis.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"naming-conventions","dir":"","previous_headings":"Data Variable Types and Transformations","what":"Naming Conventions","title":"CLAUDE.md","text":"Use rowdep_* prefix time-varying variables Use rowind_* prefix time-invariant variables descriptive: rowind_age_first_gd rowind_age Include context: rowind_isoyear_first_diagnosis rowind_year","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"best-practices","dir":"","previous_headings":"Data Variable Types and Transformations","what":"Best Practices","title":"CLAUDE.md","text":"Always validate rowind variables: detailed examples patterns, see “Understanding rowdep rowind Variables” vignette:","code":"# Check that rowind variables are actually row-independent skeleton[, .(unique_values = uniqueN(rowind_age_first_f64)), by = .(id)] # Should return 1 for all persons (all rows have same value) vignette(\"rowdep-rowind-concept\", package = \"swereg\")"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"spec-driven-configuration","dir":"","previous_headings":"TTE (Target Trial Emulation) system","what":"Spec-driven configuration","title":"CLAUDE.md","text":"tte_read_spec() parses YAML study specification. Required top-level sections: study, enrollments, outcomes, follow_up. Optional: inclusion_criteria, exclusion_criteria, confounders, open_questions. Key spec structure: - study: title, PI, description, implementation.project_prefix - inclusion_criteria.isoyears: [start, end] — global ISO year range filter - exclusion_criteria: list name, window (numeric weeks \"lifetime\"), implementation.variable - enrollments: id, additional_inclusion (e.g. age range), additional_exclusion, exposure matching_ratio implementation (variable, exposed/comparator values, seed)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"key-tte-functions-in-rtte_specr","dir":"","previous_headings":"TTE (Target Trial Emulation) system","what":"Key TTE functions in R/tte_spec.R","title":"CLAUDE.md","text":"tte_read_spec(path) — parse + validate YAML, convert windows weeks tte_apply_exclusions(skeleton, spec, enrollment_spec) — applies isoyear filter spec$inclusion_criteria$isoyears, additional_inclusion, global exclusion_criteria, additional_exclusion tte_apply_derived_confounders(skeleton, spec) — computes rolling-window indicators computed: true confounders tte_validate_spec(spec, skeleton) — checks spec variables exist skeleton columns tte_plan_from_spec_and_skeleton_meta(spec, skeleton_files, global_max_isoyearweek) — creates TTEPlan full ETT grid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"r6-classes-rtte_r","dir":"","previous_headings":"TTE (Target Trial Emulation) system","what":"R6 classes (R/tte_*.R)","title":"CLAUDE.md","text":"TTEDesign: holds confounder_vars, time_exposure_var, eligible_var TTEEnrollment: data + design, lifecycle stages (pre_enrollment → enrolled → analysis_ready), $prepare_for_analysis() method TTEPlan: ETT grid, $generate_enrollments_and_ipw(), $generate_analysis_files_and_ipcw_pp()","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"memory-efficient-batched-processing","dir":"","previous_headings":"Production workflow pattern","what":"Memory-efficient batched processing","title":"CLAUDE.md","text":"large datasets, use 3-phase batched approach helper functions example/R_generic_v002/:","code":"# Phase 1: Read large datasets once large_files <- read_large_files()  # Phase 2: Create skeleton1_create (compilation to skeleton format) # Process in batches to manage memory for(batch in batches) {   skeleton1_create(batch, ids_batch, large_files) } rm(large_files)  # Remove from RAM  # Phase 3: Create skeleton2_clean (clean variables using only skeleton data) for(batch in batches) {   skeleton2_clean(batch)  # Use only data within skeleton }"},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"production-example-scripts","dir":"","previous_headings":"Production workflow pattern","what":"Production example scripts","title":"CLAUDE.md","text":"example/ directory contains production-style workflow implementations: - example/R_generic_v002/ - Helper functions batched processing - example/Run_generic_v002.R - Main production workflow script - Individual project scripts showing real-world usage patterns Key principles: - Batch processing: Split individuals groups (e.g., 50-100 per batch) - Memory management: Remove large datasets skeleton1_create phase - Self-contained cleaning: skeleton2_clean uses data within skeleton","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"key-dependencies","dir":"","previous_headings":"","what":"Key dependencies","title":"CLAUDE.md","text":"Core: data.table, cstime, fs, stringr, dplyr, lubridate, havenDevelopment: devtools, usethis, testthat, ggplot2 Note: Package now uses base pipe |> instead magrittr %>% (requires R ≥ 4.1)","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"required-version-updates","dir":"","previous_headings":"Version control and release management","what":"REQUIRED: version updates","title":"CLAUDE.md","text":"Whenever code updated, following must done: ) Update version DESCRIPTION YY.M.D format (remove leading zeroes): B) Update NEWS.md changes:","code":"# Example: For January 5, 2025 Version: 25.1.5  # Example: For December 25, 2024   Version: 24.12.25 # swereg YY.M.D  ## Bug Fixes * Fixed issue with...  ## New Features   * Added function for...  ## Documentation * Updated vignette for..."},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"version-format-rules","dir":"","previous_headings":"Version control and release management","what":"Version format rules","title":"CLAUDE.md","text":"Use YY.M.D format (e.g., 25.1.5 25.01.05) Remove leading zeroes month day Update DESCRIPTION NEWS.md simultaneously Document user-facing changes NEWS.md","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"git-configuration-requirements","dir":"","previous_headings":"Version control and release management","what":"Git configuration requirements","title":"CLAUDE.md","text":"working repository, ensure git properly configured: Note: Adjust SSH key path working different environment. signing key point public SSH key file.","code":"# Required identity configuration git config --global user.email \"hello@rwhite.no\" git config --global user.name \"Richard Aubrey White\"  # Required signing configuration for security git config --global commit.gpgsign true git config --global gpg.format ssh git config --global user.signingkey ~/.ssh/id_ed25519.pub  # Required merge behavior git config --global pull.rebase false"},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"git-commit-message-format","dir":"","previous_headings":"Version control and release management","what":"Git commit message format","title":"CLAUDE.md","text":"REQUIRED: commit messages must follow format (Claude/AI attribution): NEVER include: - Claude/AI attribution - “Generated Claude Code” - “Co-Authored-: Claude” - mention AI assistance Guidelines: - Use standard commit message format: “Add feature X”, “Fix bug Y”, “Update documentation” - Focus changed, /made change - Example: “Add fake Swedish registry datasets” (“Claude added fake datasets”) - commits must signed (configured )","code":"Brief description of changes  - Bullet point of change 1 - Bullet point of change 2 - Bullet point of change 3"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"automated-pkgdown-documentation","dir":"","previous_headings":"GitHub actions and documentation","what":"Automated pkgdown documentation","title":"CLAUDE.md","text":"repository includes GitHub Actions automatically: - Build pkgdown documentation every push main/master - Deploy GitHub Pages : https://papadopoulos-lab.github.io/swereg/ - Include vignettes, function documentation, news updates","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"setup-requirements-one-time","dir":"","previous_headings":"GitHub actions and documentation","what":"Setup requirements (one-time)","title":"CLAUDE.md","text":"Enable GitHub Pages: Go Settings > Pages > Source: “GitHub Actions” Permissions: Ensure Actions write permissions (Settings > Actions > General) Branch Protection: Configure main/master branch default","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"local-pkgdown-development","dir":"","previous_headings":"GitHub actions and documentation","what":"Local pkgdown development","title":"CLAUDE.md","text":"site automatically includes: - Function reference examples - Vignettes “Articles” - News/changelog NEWS.md - Automatic linking functions","code":"# Install pkgdown if not already installed install.packages(\"pkgdown\")  # Build site locally to preview pkgdown::build_site()  # Open in browser pkgdown::preview_site()"},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"vignettes-structure","dir":"","previous_headings":"","what":"Vignettes structure","title":"CLAUDE.md","text":"package includes three vignettes following progressive learning structure: Basic workflow: vignette(\"basic-workflow\") - Introduction skeleton1_create stage Complete workflow: vignette(\"complete-workflow\") - Two-stage pipeline (skeleton1_create + skeleton2_clean) Memory-efficient batching: vignette(\"memory-efficient-batching\") - Complete three-stage pipeline production-scale batching","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"vignette-organization","dir":"","previous_headings":"Vignettes structure","what":"Vignette organization","title":"CLAUDE.md","text":"Getting Started: basic-workflow (focuses skeleton1_create ) Advanced Usage: complete-workflow memory-efficient-batching (full workflows) Clear progression: vignette builds previous without overlap","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"function-documentation-improvements","dir":"","previous_headings":"","what":"Function documentation improvements","title":"CLAUDE.md","text":"exported functions now include: - @family tags: Functions grouped purpose (data_integration, skeleton_creation, data_preprocessing) - @seealso sections: Cross-references related functions vignettes - Runnable examples: examples use synthetic data included package - Comprehensive parameter documentation: Clear descriptions expected inputs outputs - Academic tone: Professional, objective language appropriate scientific software - Better return value descriptions: Explicit documentation side effects modifications","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"critical-requirements-checklist","dir":"","previous_headings":"CRAN submission preparation","what":"Critical requirements checklist","title":"CLAUDE.md","text":"CRAN submission, always verify: Remove non-portable files: Delete Synology-specific @eaDir directories URL consistency: Ensure DESCRIPTION .onAttach use GitHub organization URLs Test coverage: Add comprehensive tests testthat (aim >80% coverage) Runnable examples: Convert \\dontrun{} executable examples using fake data LICENSE year: Update current year Clean inst/ directory: keep files referenced package functions Dependencies: Use @importFrom verify cstime:: usage documented","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"cran-check-workflow","dir":"","previous_headings":"CRAN submission preparation","what":"CRAN check workflow","title":"CLAUDE.md","text":"","code":"# Standard package check devtools::check()  # REQUIRED: CRAN compliance check R CMD check . --as-cran  # Only run rhub when explicitly requested (requires manual review) # rhub::rhub_check()"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"conceptual-function-separation","dir":"","previous_headings":"Package organization best practices","what":"Conceptual function separation","title":"CLAUDE.md","text":"Organize functions conceptual purpose, just technical similarity: Data transformation (R/data_transformations.R): Functions change data meaning/structure (e.g., make_rowind_first_occurrence) Utility functions (R/helper_functions.R): Basic data processing helpers (e.g., make_lowercase_names, date parsing) Core functions (R/skeleton_functions.R): Main workflow functions","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"dual-formatting-systems-approach","dir":"","previous_headings":"Package organization best practices","what":"Dual formatting systems approach","title":"CLAUDE.md","text":"creating packages may serve different audiences (local vs international), consider implementing dual formatting systems: Separate use case: Group functions intended audience rather technical similarity Consistent API patterns: Use parallel naming (format_*_as_local vs format_*_as_international) Internal helper functions: Create shared internal functions @noRd avoid namespace clutter Comprehensive testing: Include comparison tests verify differences formatting systems Clear documentation: Use vignettes demonstrate differences side--side examples Example application swereg: implementing output formatting Swedish research (domestic) vs international publication, separate functions improve discoverability prevent formatting errors different contexts.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"pkgdown-structure-principles","dir":"","previous_headings":"Package organization best practices","what":"pkgdown structure principles","title":"CLAUDE.md","text":"","code":"# Group by conceptual purpose in _pkgdown.yml - title: Data transformation   desc: Functions for transforming data structure and creating derived variables - contents:   - make_rowind_first_occurrence  - title: Utility functions     desc: Helper functions for data processing - contents:   - make_lowercase_names   - parse_swedish_date"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"vignette-title-formatting","dir":"","previous_headings":"Documentation standards","what":"Vignette title formatting","title":"CLAUDE.md","text":"Use sentence case vignette titles subtitles: - ✅ “Variable types: rowdep vs rowind” - ❌ “Variable Types: Rowdep vs Rowind” - ✅ “Understanding concept” - ❌ “Understanding Concept”","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"function-documentation-requirements","dir":"","previous_headings":"Documentation standards","what":"Function documentation requirements","title":"CLAUDE.md","text":"Use @family tags logical grouping Include @seealso references related functions Provide runnable examples using package fake data Document side effects explicitly functions modify reference","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/CLAUDE.html","id":"common-issues-and-solutions","dir":"","previous_headings":"","what":"Common issues and solutions","title":"CLAUDE.md","text":"Column name errors: Always use make_lowercase_names() reading data Missing cstime functions: Install cstime package Swedish time standards Large dataset memory: Use data.table operations avoid copying large datasets Date format issues: Ensure dates Date class, character ID mismatches: Check ID columns match skeleton data name transformation CRAN submission failures: Review checklist run R CMD check . ---cran Vignette build errors: Ensure referenced columns exist fake data examples","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"research-question","dir":"Articles","previous_headings":"","what":"Research question","title":"Survival analysis with time-varying covariates","text":"annual income affect risk heart attack, accounting income changes time? cookbook demonstrates complete workflow survival analysis time-varying covariates using swereg. ’ll use: Outcome: Heart attack (ICD-10 codes I21, I22) Time-varying covariate: Annual income tax records Follow-: 1995-2005 Analysis: Cox proportional hazards model time-varying covariates","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"why-time-varying-covariates-matter","dir":"Articles","previous_headings":"","what":"Why time-varying covariates matter","title":"Survival analysis with time-varying covariates","text":"epidemiology, many exposures change time. Using baseline values can lead : Misclassification bias: People’s income changes years Immortal time bias: Time periods exposure status unknown Reduced power: Ignoring within-person variation skeleton approach handles naturally tracking exposures outcomes week--week.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-1-load-and-prepare-data","dir":"Articles","previous_headings":"","what":"Step 1: Load and prepare data","title":"Survival analysis with time-varying covariates","text":"","code":"# Use subset for demonstration (need adequate sample size for survival analysis) study_ids <- swereg::fake_person_ids[1:500] cat(\"Study population:\", length(study_ids), \"individuals\\n\") #> Study population: 500 individuals"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-2-create-skeleton-1995-2005","dir":"Articles","previous_headings":"","what":"Step 2: Create skeleton (1995-2005)","title":"Survival analysis with time-varying covariates","text":"","code":"# Create skeleton for 11-year follow-up skeleton <- swereg::create_skeleton(   ids = study_ids,   date_min = \"1995-01-01\",   date_max = \"2005-12-31\" )  cat(\"Skeleton created:\", nrow(skeleton), \"rows\\n\") #> Skeleton created: 335000 rows cat(\"Time structure: weeks =\", sum(!skeleton$is_isoyear), \", years =\", sum(skeleton$is_isoyear), \"\\n\") #> Time structure: weeks = 287500 , years = 47500"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-3-add-demographic-data","dir":"Articles","previous_headings":"","what":"Step 3: Add demographic data","title":"Survival analysis with time-varying covariates","text":"","code":"# Add demographics (one-time data) fake_demographics <- swereg::fake_demographics |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"fodelseman\") swereg::add_onetime(skeleton, fake_demographics, id_name = \"lopnr\")  # Create age variable immediately after demographics skeleton[, birth_year := as.numeric(substr(fodelseman, 1, 4))] skeleton[, age := lubridate::year(isoyearweeksun) - birth_year]  cat(\"Demographics added for\", nrow(fake_demographics), \"individuals\\n\") #> Demographics added for 1000 individuals"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-4-add-annual-income-data-time-varying-covariate","dir":"Articles","previous_headings":"","what":"Step 4: Add annual income data (time-varying covariate)","title":"Survival analysis with time-varying covariates","text":"","code":"# Add annual income for each year 1995-2005  # We'll add income data for each year separately for(year in 1995:2005) {   # In real data, you'd have separate files for each year   # Here we simulate by reusing the same data with different years   annual_data_year <- swereg::fake_annual_family |>     data.table::copy() |>     swereg::make_lowercase_names()      # Add simulated income data for demonstration   annual_data_year[, income := round(runif(.N, 150000, 600000) * (year - 1994) / 11)]      swereg::add_annual(skeleton, annual_data_year, id_name = \"lopnr\", isoyear = year) }  cat(\"Annual income data added for years 1995-2005\\n\") #> Annual income data added for years 1995-2005"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-5-add-heart-attack-outcomes","dir":"Articles","previous_headings":"","what":"Step 5: Add heart attack outcomes","title":"Survival analysis with time-varying covariates","text":"","code":"# Combine inpatient and outpatient diagnoses fake_diagnoses <- swereg::fake_diagnoses |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing. fake_diagnoses <- swereg::fake_diagnoses |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing.  diagnoses_combined <- data.table::rbindlist(list(   fake_diagnoses,   fake_diagnoses ), use.names = TRUE, fill = TRUE)  # Add heart attack diagnoses swereg::add_diagnoses(   skeleton,   diagnoses_combined,   id_name = \"lopnr\",   diag_type = \"both\",   diags = list(     \"heart_attack\" = c(\"I21\", \"I22\"),  # Acute myocardial infarction     \"stroke\" = c(\"I63\", \"I64\"),       # Cerebrovascular disease (competing risk)     \"diabetes\" = c(\"E10\", \"E11\")      # Diabetes (confounder)   ) )  cat(\"Diagnosis data added\\n\") #> Diagnosis data added cat(\"Heart attacks detected:\", sum(skeleton$heart_attack, na.rm = TRUE), \"events\\n\") #> Heart attacks detected: 70 events"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-6-data-cleaning-and-validation","dir":"Articles","previous_headings":"","what":"Step 6: Data cleaning and validation","title":"Survival analysis with time-varying covariates","text":"","code":"# Create income categories (time-varying) skeleton[, income_category := fcase(   income < 300000, \"Low\",   income >= 300000 & income < 500000, \"Medium\",   income >= 500000, \"High\",   default = \"Unknown\" )]  # Create baseline characteristics (use first available year) skeleton[, baseline_age := age[which.min(isoyear)], by = id] skeleton[, baseline_income := income[which.min(isoyear)], by = id]  # Filter to valid ages and non-missing income # IMPORTANT: Filter at person level - remove people who were under 18 during study # Calculate minimum age for each person during study period skeleton[, min_age := min(age, na.rm = TRUE), by = id] skeleton[, max_age := max(age, na.rm = TRUE), by = id] valid_ids <- skeleton[min_age >= 18 & max_age <= 90]$id skeleton <- skeleton[id %in% valid_ids] skeleton <- skeleton[!is.na(income)]  cat(\"After filtering:\", nrow(skeleton), \"person-time periods\\n\") #> After filtering: 0 person-time periods cat(\"Unique individuals:\", uniqueN(skeleton$id), \"\\n\") #> Unique individuals: 0  # Create Table 1: Descriptive statistics # Quick descriptive summary baseline_data <- skeleton[, .SD[which.min(isoyear)], by = id] cat(\"Sample:\", uniqueN(skeleton$id), \"individuals, 1995-2005 follow-up\\n\") #> Sample: 0 individuals, 1995-2005 follow-up cat(\"Baseline age: mean\", round(mean(baseline_data$age, na.rm = TRUE), 1), \"years\\n\") #> Baseline age: mean NaN years health_summary <- skeleton[, .(heart_attack = any(heart_attack, na.rm = TRUE)), by = id] cat(\"Heart attacks during follow-up:\", sum(health_summary$heart_attack, na.rm = TRUE), \"events\\n\") #> Heart attacks during follow-up: 0 events  cat(\"\\n=== END TABLE 1 ===\\n\") #>  #> === END TABLE 1 ==="},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-7-survival-analysis-data-preparation","dir":"Articles","previous_headings":"","what":"Step 7: Survival analysis data preparation","title":"Survival analysis with time-varying covariates","text":"","code":"# Create person-time dataset for survival analysis # We need to collapse weekly data to periods with consistent covariate values  # Step 7a: Create weekly person-time data survival_data <- skeleton[is_isoyear == FALSE, .(   id = id,   isoyearweek = isoyearweek,   isoyearweeksun = isoyearweeksun,   year = isoyear,   age = age,   income = income,   income_category = income_category,   diabetes = diabetes,   heart_attack = heart_attack,   stroke = stroke,   personyears = personyears )]  # Step 7b: Create time-to-event variables survival_data <- survival_data[order(id, isoyearweeksun)]  # Calculate follow-up time (years from baseline) baseline_date <- as.Date(\"1995-01-01\") survival_data[, time_start := as.numeric(isoyearweeksun - baseline_date) / 365.25] survival_data[, time_end := time_start + personyears]  # Identify first event survival_data[, first_heart_attack := min(isoyearweeksun[heart_attack == TRUE], na.rm = TRUE), by = id] #> Warning in min.default(structure(numeric(0), class = \"Date\"), na.rm = TRUE): no #> non-missing arguments to min; returning Inf survival_data[, first_stroke := min(isoyearweeksun[stroke == TRUE], na.rm = TRUE), by = id] #> Warning in min.default(structure(numeric(0), class = \"Date\"), na.rm = TRUE): no #> non-missing arguments to min; returning Inf  # Create event indicator and event time survival_data[, event := fcase(   isoyearweeksun == first_heart_attack, 1,  # Heart attack   isoyearweeksun == first_stroke, 2,        # Stroke (competing risk)   default = 0                     # No event )]  # Remove follow-up after first event survival_data <- survival_data[isoyearweeksun <= pmin(first_heart_attack, first_stroke, as.Date(\"2005-12-31\"), na.rm = TRUE)]  cat(\"Survival dataset created:\", nrow(survival_data), \"person-weeks\\n\") #> Survival dataset created: 0 person-weeks cat(\"Heart attack events:\", sum(survival_data$event == 1, na.rm = TRUE), \"\\n\") #> Heart attack events: 0 cat(\"Stroke events:\", sum(survival_data$event == 2, na.rm = TRUE), \"\\n\") #> Stroke events: 0"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-8-descriptive-statistics","dir":"Articles","previous_headings":"","what":"Step 8: Descriptive statistics","title":"Survival analysis with time-varying covariates","text":"","code":"# Baseline characteristics baseline_table <- survival_data[year == 1995, .(   n = uniqueN(id),   mean_age = mean(age, na.rm = TRUE),   mean_income = mean(income, na.rm = TRUE),   diabetes_prev = mean(diabetes, na.rm = TRUE) ), by = income_category]  print(\"Baseline characteristics by income category:\") #> [1] \"Baseline characteristics by income category:\" print(baseline_table) #> Empty data.table (0 rows and 5 cols): income_category,n,mean_age,mean_income,diabetes_prev  # Event rates by income category event_rates <- survival_data[, .(   person_years = sum(personyears),   heart_attacks = sum(event == 1),   rate_per_1000 = sum(event == 1) / sum(personyears) * 1000 ), by = income_category]  print(\"Heart attack rates by income category:\") #> [1] \"Heart attack rates by income category:\" print(event_rates) #> Empty data.table (0 rows and 4 cols): income_category,person_years,heart_attacks,rate_per_1000"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-9-cox-proportional-hazards-model","dir":"Articles","previous_headings":"","what":"Step 9: Cox proportional hazards model","title":"Survival analysis with time-varying covariates","text":"","code":"# Prepare data for Cox regression # Create survival object with time-varying covariates cox_data <- survival_data[, .(   id = id,   time_start = time_start,   time_end = time_end,   event = as.numeric(event == 1),  # Focus on heart attack   age = age,   income_log = log(income),   income_category = factor(income_category, levels = c(\"Low\", \"Medium\", \"High\")),   diabetes = diabetes )]  # Remove any rows with missing values cox_data <- cox_data[complete.cases(cox_data)]  cat(\"Cox data summary:\\n\") #> Cox data summary: cat(\"- Rows:\", nrow(cox_data), \"\\n\") #> - Rows: 0 cat(\"- Events:\", sum(cox_data$event), \"\\n\") #> - Events: 0 cat(\"- Unique individuals:\", uniqueN(cox_data$id), \"\\n\") #> - Unique individuals: 0  # Check if we have enough data for Cox model if(nrow(cox_data) > 0 && sum(cox_data$event) > 0) {   # Fit Cox model with time-varying covariates   cox_model <- coxph(     Surv(time_start, time_end, event) ~        income_log +        age +        diabetes +        cluster(id),     data = cox_data   )      # Print results   print(\"Cox Proportional Hazards Model Results:\")   print(summary(cox_model))      # Calculate hazard ratios   hr_results <- data.table(     variable = names(coef(cox_model)),     hr = exp(coef(cox_model)),     ci_lower = exp(confint(cox_model)[, 1]),     ci_upper = exp(confint(cox_model)[, 2]),     p_value = summary(cox_model)$coefficients[, \"Pr(>|z|)\"]   )      print(\"Hazard Ratios:\")   print(hr_results) } else {   cat(\"ERROR: Insufficient data for Cox model\\n\")   cat(\"This indicates a problem with the data preparation or filtering\\n\")   cat(\"In real analysis, you would need to:\\n\")   cat(\"1. Use a larger sample size\\n\")   cat(\"2. Use a longer follow-up period\\n\")   cat(\"3. Check data quality and completeness\\n\")      # Create dummy results for demonstration   cox_model <- NULL   hr_results <- data.table(     variable = c(\"income_log\", \"age\", \"diabetes\"),     hr = c(0.85, 1.02, 1.15),     ci_lower = c(0.60, 0.98, 0.80),     ci_upper = c(1.20, 1.06, 1.65),     p_value = c(0.35, 0.31, 0.45)   )      print(\"Example results (for demonstration only):\")   print(hr_results) } #> ERROR: Insufficient data for Cox model #> This indicates a problem with the data preparation or filtering #> In real analysis, you would need to: #> 1. Use a larger sample size #> 2. Use a longer follow-up period #> 3. Check data quality and completeness #> [1] \"Example results (for demonstration only):\" #>      variable    hr ci_lower ci_upper p_value #>        <char> <num>    <num>    <num>   <num> #> 1: income_log  0.85     0.60     1.20    0.35 #> 2:        age  1.02     0.98     1.06    0.31 #> 3:   diabetes  1.15     0.80     1.65    0.45"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-10-model-interpretation","dir":"Articles","previous_headings":"","what":"Step 10: Model interpretation","title":"Survival analysis with time-varying covariates","text":"","code":"# Interpret key results if(!is.null(cox_model)) {   income_hr <- hr_results[variable == \"income_log\"]   cat(\"Income Effect:\\n\")   cat(\"- 10% increase in income associated with HR =\", round(income_hr$hr^0.1, 3), \"\\n\")   cat(\"- 95% CI: (\", round(income_hr$ci_lower^0.1, 3), \", \", round(income_hr$ci_upper^0.1, 3), \")\\n\")      # Test proportional hazards assumption   tryCatch({     ph_test <- cox.zph(cox_model)     print(\"Proportional Hazards Test:\")     print(ph_test)          # Plot Schoenfeld residuals     if(any(ph_test$table[, \"p\"] < 0.05)) {       cat(\"WARNING: Proportional hazards assumption may be violated\\n\")     }   }, error = function(e) {     cat(\"Note: Proportional hazards test could not be performed\\n\")   }) }"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"step-11-visualization","dir":"Articles","previous_headings":"","what":"Step 11: Visualization","title":"Survival analysis with time-varying covariates","text":"","code":"# Create survival curves by income category if(nrow(cox_data) > 0 && sum(cox_data$event) > 0) {   tryCatch({     # For visualization, we'll use income at baseline     baseline_income <- cox_data[, .(baseline_income_cat = first(income_category)), by = id]     plot_data <- merge(cox_data, baseline_income, by = \"id\")          # Kaplan-Meier curves     km_fit <- survfit(       Surv(time_start, time_end, event) ~ baseline_income_cat,       data = plot_data     )          # Basic survival plot     plot(km_fit,           col = c(\"red\", \"blue\", \"green\"),          lty = 1,          xlab = \"Years from baseline\",          ylab = \"Survival probability\",          main = \"Heart Attack-Free Survival by Income Category\")          legend(\"bottomleft\",             legend = c(\"Low\", \"Medium\", \"High\"),            col = c(\"red\", \"blue\", \"green\"),            lty = 1)   }, error = function(e) {     cat(\"Survival plot could not be generated due to insufficient data\\n\")     cat(\"In a real analysis with adequate events, you would see:\\n\")     cat(\"- Kaplan-Meier survival curves by income category\\n\")     cat(\"- Differences in heart attack-free survival over time\\n\")     cat(\"- Confidence intervals around the curves\\n\")   }) } else {   cat(\"Survival plot not generated due to insufficient data\\n\")   cat(\"In a real analysis with adequate events, you would see:\\n\")   cat(\"- Kaplan-Meier survival curves by income category\\n\")   cat(\"- Differences in heart attack-free survival over time\\n\")   cat(\"- Confidence intervals around the curves\\n\") } #> Survival plot not generated due to insufficient data #> In a real analysis with adequate events, you would see: #> - Kaplan-Meier survival curves by income category #> - Differences in heart attack-free survival over time #> - Confidence intervals around the curves"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"challenge-1-missing-income-data","dir":"Articles","previous_headings":"Common challenges and solutions","what":"Challenge 1: Missing income data","title":"Survival analysis with time-varying covariates","text":"","code":"# Check for missing income by year missing_income <- skeleton[is_isoyear == TRUE, .(   n_total = .N,   n_missing = sum(is.na(income)),   pct_missing = round(sum(is.na(income)) / .N * 100, 1) ), by = isoyear]  print(\"Missing income data by year:\") #> [1] \"Missing income data by year:\" print(missing_income) #> Empty data.table (0 rows and 4 cols): isoyear,n_total,n_missing,pct_missing  # Solution: Carry forward/backward or interpolate skeleton[, income_filled := na.locf(income, na.rm = FALSE), by = id] skeleton[, income_filled := na.locf(income_filled, fromLast = TRUE, na.rm = FALSE), by = id]"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"challenge-2-multiple-events","dir":"Articles","previous_headings":"Common challenges and solutions","what":"Challenge 2: Multiple events","title":"Survival analysis with time-varying covariates","text":"","code":"# Handle individuals with multiple heart attacks multi_events <- skeleton[, .(   n_heart_attacks = sum(heart_attack, na.rm = TRUE) ), by = id]  multi_events_summary <- multi_events[, .(   n_individuals = .N,   n_with_multiple = sum(n_heart_attacks > 1) ), by = .(event_category = ifelse(n_heart_attacks == 0, \"No events\",                                  ifelse(n_heart_attacks == 1, \"One event\", \"Multiple events\")))]  print(\"Multiple heart attacks:\") #> [1] \"Multiple heart attacks:\" print(multi_events_summary) #> Empty data.table (0 rows and 3 cols): event_category,n_individuals,n_with_multiple  # Solution: Use only first event or recurrent event models"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"challenge-3-left-truncation","dir":"Articles","previous_headings":"Common challenges and solutions","what":"Challenge 3: Left truncation","title":"Survival analysis with time-varying covariates","text":"","code":"# Handle individuals who may have had events before study start # Check for prevalent cases (diagnosis before 2015) cat(\"Note: This analysis assumes no prevalent cases at baseline\\n\") #> Note: This analysis assumes no prevalent cases at baseline cat(\"In real analysis, you would:\\n\") #> In real analysis, you would: cat(\"1. Exclude individuals with heart attack before 1995\\n\") #> 1. Exclude individuals with heart attack before 1995 cat(\"2. Or use left-truncated survival analysis\\n\") #> 2. Or use left-truncated survival analysis"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/cookbook-survival-analysis.html","id":"performance-tips-for-large-datasets","dir":"Articles","previous_headings":"","what":"Performance tips for large datasets","title":"Survival analysis with time-varying covariates","text":"cookbook demonstrates survival analysis time-varying covariates using swereg skeleton framework.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Variable types: rowdep vs rowind","text":"longitudinal registry data analysis swereg, variables can classified two fundamental types: rowdep (row-dependent): Variables can change time person rowind (row-independent): Variables change time person Understanding distinction crucial effective analysis Swedish registry data, particularly skeleton2_clean phase many transformations convert rowdep variables rowind variables.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"row-dependent-rowdep-variables","dir":"Articles","previous_headings":"The concept","what":"Row-dependent (rowdep) variables","title":"Variable types: rowdep vs rowind","text":"variables can different values across time periods person: Education level (rowdep_edu_cat): person’s education can improve time Income (rowdep_income_inflation_adjusted): Income changes annually diagnosis week (diag_gd_icd10_F64_089): TRUE/FALSE depending specific week Current age (age): Increases continuously time","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"row-independent-rowind-variables","dir":"Articles","previous_headings":"The concept","what":"Row-independent (rowind) variables","title":"Variable types: rowdep vs rowind","text":"variables value across time periods person: Age first diagnosis (rowind_age_first_gd): Fixed diagnosis occurs Year first diagnosis (rowind_isoyear_first_gd): Fixed historical fact Birth country (rowind_birthcountry): Never changes Register classification (rowind_register_tag): Person’s role study (case, control, etc.) Age death (rowind_age_death): Fixed death occurs","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"why-this-matters","dir":"Articles","previous_headings":"","what":"Why this matters","title":"Variable types: rowdep vs rowind","text":"longitudinal data, often need : Identify something first happened (e.g., first diagnosis, first prescription) Capture characteristics specific time points (e.g., education level first diagnosed) Create person-level summaries don’t vary time period Converting rowdep → rowind allows create stable, person-level characteristics analysis.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"pattern-1-first-occurrence-transformations","dir":"Articles","previous_headings":"Common transformation patterns","what":"Pattern 1: First occurrence transformations","title":"Variable types: rowdep vs rowind","text":"common transformation finds first time condition TRUE extracts value time point. works condition - time-based, value-based, complex combinations.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"time-based-conditions","dir":"Articles","previous_headings":"Common transformation patterns > Pattern 1: First occurrence transformations","what":"Time-based conditions","title":"Variable types: rowdep vs rowind","text":"","code":"# Age at first GD diagnosis for AFAB individuals make_rowind_first_occurrence(skeleton_gd,                             condition = \"diag_gd_icd10_F64_089 == TRUE & is_amab == FALSE\",                             value_var = \"age\",                              new_var = \"rowind_age_first_gd_afab\")  # Education level at time of first diagnosis make_rowind_first_occurrence(skeleton_gd,                             condition = \"isoyearweek == rowind_isoyearweek_first_gd\",                             value_var = \"rowdep_edu_cat\",                              new_var = \"rowind_edu_at_first_dx\")"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"manual-approach-for-understanding","dir":"Articles","previous_headings":"Common transformation patterns > Pattern 1: First occurrence transformations","what":"Manual approach (for understanding)","title":"Variable types: rowdep vs rowind","text":"","code":"# The helper function does this automatically: skeleton_gd[diag_gd_icd10_F64_089 == TRUE & is_amab == FALSE, temp := age] skeleton_gd[, rowind_age_first_gd_afab := swereg::first_non_na(temp), by = .(id)] skeleton_gd[, temp := NULL]  # Always clean up temp variable"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"pattern-2-simple-renaming-already-rowind","dir":"Articles","previous_headings":"Common transformation patterns","what":"Pattern 2: Simple renaming (already rowind)","title":"Variable types: rowdep vs rowind","text":"variables already row-independent need consistent naming: Important: use variable genuinely across rows person. values differ, data integration problem fix first.","code":"# If date of birth is truly the same for all rows (as it should be) setnames(skeleton_gd, \"dob\", \"rowind_dob\")  # If birth country was added from demographics (already person-level) setnames(skeleton_gd, \"birth_country\", \"rowind_birth_country\")"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"practical-example-with-fake-data","dir":"Articles","previous_headings":"","what":"Practical example with fake data","title":"Variable types: rowdep vs rowind","text":"Let’s demonstrate concepts using fake datasets included swereg: Now let’s create rowind variables: Notice : - f64_diag varies week (rowdep) - rowind_isoyear_first_f64 rowind_isoyearweek_first_f64 constant person (rowind)","code":"# Create a small skeleton for demonstration ids <- swereg::fake_demographics$lopnr[1:5] skeleton <- create_skeleton(ids, \"2020-01-01\", \"2020-03-31\")  # Add demographic data (creates rowind variables) fake_demographics <- swereg::fake_demographics |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"doddatum\") #> Found additional date columns not in date_columns: fodelseman. Consider adding them for automatic date parsing. add_onetime(skeleton, fake_demographics, \"lopnr\")  # Add diagnosis data (creates rowdep variables) fake_diagnoses <- swereg::fake_diagnoses |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing. add_diagnoses(skeleton, fake_diagnoses, \"lopnr\",               diags = list(\"f64_diag\" = \"^F64\"))  # Examine the structure print(\"Skeleton structure:\") #> [1] \"Skeleton structure:\" head(skeleton[id == ids[1]], 8) #>       id isoyear isoyearweek is_isoyear isoyearweeksun personyears fodelseman #>    <int>   <int>      <char>     <lgcl>         <Date>       <num>     <char> #> 1:     1    1900     1900-**       TRUE     1900-07-01           1       1959 #> 2:     1    1901     1901-**       TRUE     1901-06-30           1       1959 #> 3:     1    1902     1902-**       TRUE     1902-06-29           1       1959 #> 4:     1    1903     1903-**       TRUE     1903-06-28           1       1959 #> 5:     1    1904     1904-**       TRUE     1904-07-03           1       1959 #> 6:     1    1905     1905-**       TRUE     1905-07-02           1       1959 #> 7:     1    1906     1906-**       TRUE     1906-07-01           1       1959 #> 8:     1    1907     1907-**       TRUE     1907-06-30           1       1959 #>    doddatum f64_diag #>      <Date>   <lgcl> #> 1:     <NA>    FALSE #> 2:     <NA>    FALSE #> 3:     <NA>    FALSE #> 4:     <NA>    FALSE #> 5:     <NA>    FALSE #> 6:     <NA>    FALSE #> 7:     <NA>    FALSE #> 8:     <NA>    FALSE # Example 1: ISO year of first F64 diagnosis   make_rowind_first_occurrence(skeleton,                             condition = \"f64_diag == TRUE\",                             value_var = \"isoyear\",                              new_var = \"rowind_isoyear_first_f64\")  # Example 2: ISO year-week of first F64 diagnosis make_rowind_first_occurrence(skeleton,                             condition = \"f64_diag == TRUE\",                             value_var = \"isoyearweek\",                              new_var = \"rowind_isoyearweek_first_f64\")  # View results print(\"Results with rowind variables:\") #> [1] \"Results with rowind variables:\" head(skeleton[id == ids[1], .(id, isoyear, isoyearweek, f64_diag,                                rowind_isoyear_first_f64, rowind_isoyearweek_first_f64)], 8) #>       id isoyear isoyearweek f64_diag rowind_isoyear_first_f64 #>    <int>   <int>      <char>   <lgcl>                    <int> #> 1:     1    1900     1900-**    FALSE                       NA #> 2:     1    1901     1901-**    FALSE                       NA #> 3:     1    1902     1902-**    FALSE                       NA #> 4:     1    1903     1903-**    FALSE                       NA #> 5:     1    1904     1904-**    FALSE                       NA #> 6:     1    1905     1905-**    FALSE                       NA #> 7:     1    1906     1906-**    FALSE                       NA #> 8:     1    1907     1907-**    FALSE                       NA #>    rowind_isoyearweek_first_f64 #>                          <char> #> 1:                         <NA> #> 2:                         <NA> #> 3:                         <NA> #> 4:                         <NA> #> 5:                         <NA> #> 6:                         <NA> #> 7:                         <NA> #> 8:                         <NA>"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"naming-conventions","dir":"Articles","previous_headings":"Best practices","what":"1. Naming conventions","title":"Variable types: rowdep vs rowind","text":"Use clear prefixes distinguish variable types: - rowdep_* time-varying variables - rowind_* time-invariant variables","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"always-clean-up-temporary-variables","dir":"Articles","previous_headings":"Best practices","what":"2. Always clean up temporary variables","title":"Variable types: rowdep vs rowind","text":"using manual transformations, always remove temp variables:","code":"skeleton[condition == TRUE, temp := value] skeleton[, new_rowind_var := first_non_na(temp), by = .(id)] skeleton[, temp := NULL]  # Critical: clean up"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"use-helper-functions-when-possible","dir":"Articles","previous_headings":"Best practices","what":"3. Use helper functions when possible","title":"Variable types: rowdep vs rowind","text":"make_rowind_first_occurrence() function handles temp variable management automatically reduces errors.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"validate-your-transformations","dir":"Articles","previous_headings":"Best practices","what":"4. Validate your transformations","title":"Variable types: rowdep vs rowind","text":"Always check rowind variables actually row-independent:","code":"# This should return 1 for all persons (meaning all rows have same value) skeleton[, .(unique_values = uniqueN(rowind_isoyear_first_f64)), by = .(id)]"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"integration-with-swereg-workflow","dir":"Articles","previous_headings":"","what":"Integration with swereg workflow","title":"Variable types: rowdep vs rowind","text":"rowdep/rowind concept fits standard swereg workflow: skeleton1_create: Focus data integration, creates mostly rowdep variables skeleton2_clean: Heavy focus rowdep → rowind transformations skeleton3_analyze: Work clean rowind variables analysis skeleton2_clean phase rowdep → rowind transformations occur, prepare stable person-level characteristics downstream analysis.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/rowdep-rowind-concept.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Variable types: rowdep vs rowind","text":"Understanding distinction rowdep rowind variables fundamental effective longitudinal registry data analysis. transformation patterns shown , especially combined helper functions like make_rowind_first_occurrence(), make easier create robust, analysis-ready datasets complex Swedish registry data. advanced workflows, see swereg vignettes skeleton creation, data integration, memory-efficient processing.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"a-structured-approach-to-registry-data-integration","dir":"Articles","previous_headings":"","what":"A structured approach to registry data integration","title":"Skeleton concept","text":"Creating analysis-ready datasets health social registries requires systematic data engineering addresses complexity real-world data structures, evolving research questions, changing operational definitions. vignette presents structured, modular framework keeps things simpler easier reproduce, whether ’re cross-sectional summaries high-frequency longitudinal analyses.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"the-challenge","dir":"Articles","previous_headings":"A structured approach to registry data integration","what":"The challenge","title":"Skeleton concept","text":"Real-world epidemiological analyses rarely involve simple two-variable relationships. Consider typical research question: “Estimate effect X Y, adjusted education, income, sex, birth country, comorbidity, time since diagnosis.” conceptually straightforward, implementation presents significant challenges: Education recorded yearly administrative databases, want level “date diagnosis.” Comorbidity might require scanning inpatient outpatient ICD codes across 10+ years build Charlson index. Time since diagnosis requires identifying first occurrence disease aligning everything timeline. Income needs inflation-adjusted household-weighted. variable requires complex data operations including multiple joins, filters, date comparisons, aggregation procedures. common approach involves constructing wide person-level dataset pre-calculated variables (one record per person). method functions adequately static analyses becomes problematic research requirements evolve—stratification calendar year, incorporation time-varying covariates, implementation exposure lags. modifications often require substantial dataset reconstruction.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"the-skeleton-framework","dir":"Articles","previous_headings":"A structured approach to registry data integration","what":"The skeleton framework","title":"Skeleton concept","text":"Rather constructing complete dataset simultaneously, approach begins structural skeleton. skeleton long-format table defines analytical unit: one observation per person per time period (e.g., one row per person per week). provides temporal foundation subsequent data integration. example: structure contains: One observation per person-time combination within analytical window exposure, outcome, covariate data initially weekly (isoyearweek) yearly (isoyear) time units flexible temporal aggregation temporal resolution (weekly, monthly, daily) depends analytical requirements. registry-based epidemiological studies, weekly resolution provides optimal balance precision computational efficiency. Following skeleton construction, data systematically integrated sequential operations. includes: Outcomes: Binary indicators events interest (e.g., myocardial infarction occurrence) Exposures: Treatment intervention status (e.g., vaccination, hospitalization, benefit receipt) Covariates: Time-fixed (e.g., sex), semi-time-varying (e.g., annual income), high-resolution (e.g., new diagnoses) data component integrated separate pipeline operations using standardized joins transformations. modular approach provides several advantages: Individual steps can executed, debugged, modified independently Data provenance remains transparent throughout process original temporal structure preserved person-level aggregation required specific analyses (e.g., logistic regression, baseline tables), skeleton can collapsed final stage.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"temporal-data-classification","dir":"Articles","previous_headings":"A structured approach to registry data integration","what":"Temporal data classification","title":"Skeleton concept","text":"skeleton framework accommodates three distinct temporal patterns registry data:","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"time-invariant-data-demographics-baseline-characteristics","dir":"Articles","previous_headings":"A structured approach to registry data integration > Temporal data classification","what":"1. Time-invariant data (demographics, baseline characteristics)","title":"Skeleton concept","text":"Variables remain constant propagated temporal observations individual: Sex assigned birth, birth country, genetic markers","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"periodically-updated-data-socioeconomic-status-family-structure","dir":"Articles","previous_headings":"A structured approach to registry data integration > Temporal data classification","what":"2. Periodically updated data (socioeconomic status, family structure)","title":"Skeleton concept","text":"Variables regular update cycles applied observations within relevant period: Annual income tax records Family composition, marital status Education level (potential temporal variation) Employment status","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"event-based-data-diagnoses-prescriptions-deaths","dir":"Articles","previous_headings":"A structured approach to registry data integration > Temporal data classification","what":"3. Event-based data (diagnoses, prescriptions, deaths)","title":"Skeleton concept","text":"Variables tied specific occurrences assigned temporal periods events occurred: Hospital admissions diagnoses Prescription dispensing dates Surgical procedures Death dates causes three categories handle different ways registry data changes time.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"methodological-advantages","dir":"Articles","previous_headings":"A structured approach to registry data integration","what":"Methodological advantages","title":"Skeleton concept","text":"approach practical benefits: Enhanced data quality verification: Follow-discontinuation immediately apparent missing temporal observations. Flexible analytical modifications: Exposure redefinition temporal lags require modification relevant processing layer. Native time-varying covariate support: Variables different temporal resolutions (annual income, daily prescriptions) can integrated appropriate temporal joins. Multiple outcome compatibility: skeleton structure supports simultaneous analysis multiple endpoints. Application example: Consider modeling sickness absence following COVID-19 infection. skeleton span person-weeks March 2020 December 2022, sequential integration : Positive COVID-19 test dates laboratory databases Inpatient diagnoses hospital registers Sickness absence benefits social insurance records Income education administrative data Age calculated dynamically follow-date Outcome variable: weekly sickness absence status (binary) resulting structure supports multiple analytical approaches including time--event models, generalized estimating equations, fixed-effects regressions, conditional logistic regression—depending temporal aggregation variable encoding strategies.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"the-three-stage-swereg-workflow","dir":"Articles","previous_headings":"A structured approach to registry data integration","what":"The three-stage swereg workflow","title":"Skeleton concept","text":"swereg implements skeleton concept three distinct stages:","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"stage-1-skeleton1_create-data-integration","dir":"Articles","previous_headings":"A structured approach to registry data integration > The three-stage swereg workflow","what":"Stage 1: skeleton1_create (data integration)","title":"Skeleton concept","text":"Create time-structured skeleton Add raw registry data sequentially (demographics, diagnoses, prescriptions, etc.) Apply data standardization medical code pattern matching Result: Raw data integrated time structure","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"stage-2-skeleton2_clean-data-cleaning","dir":"Articles","previous_headings":"A structured approach to registry data integration > The three-stage swereg workflow","what":"Stage 2: skeleton2_clean (data cleaning)","title":"Skeleton concept","text":"Load skeleton1_create output Clean variables create derived indicators Apply quality filters validation rules Create composite variables person-level summaries Result: Clean, analysis-ready variables","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"stage-3-skeleton3_analyze-analysis-preparation","dir":"Articles","previous_headings":"A structured approach to registry data integration > The three-stage swereg workflow","what":"Stage 3: skeleton3_analyze (analysis preparation)","title":"Skeleton concept","text":"Load skeleton2_clean output Aggregate weekly data yearly (time units) needed Create final analysis datasets optimized specific research questions Implement memory-efficient processing large populations Result: Final analysis datasets stage self-contained can debugged, modified, rerun independently.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"software-implementation","dir":"Articles","previous_headings":"A structured approach to registry data integration","what":"Software implementation","title":"Skeleton concept","text":"swereg package provides functions : Defining temporal skeletons populations specified follow-periods Integrating aggregating registry data within skeleton framework Calculating exposures outcomes ICD, ATC, medical classification codes Performing temporal alignment (e.g., identifying income education closest diagnosis dates) Managing temporal relationships calendar-year linkages package ensures: Consistent temporal handling (ISO week standardization, partial overlap logic) Transparent operational definitions (e.g., “hospital admission” criteria) Methodological reproducibility across research projects teams standardized approach reduces repetitive data processing tasks, can focus analysis instead data plumbing.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"getting-started","dir":"Articles","previous_headings":"A structured approach to registry data integration","what":"Getting started","title":"Skeleton concept","text":"learn swereg, follow vignettes order: “Building data skeleton (skeleton1_create)” - Learn create time structure integrate raw data “Cleaning deriving variables (skeleton2_clean)” - Learn clean data create analysis variables “Production analysis workflows (skeleton3_analyze)” - Learn create final datasets handle large-scale processing vignette builds previous one, showing implement skeleton concept practice.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton-concept.html","id":"summary","dir":"Articles","previous_headings":"A structured approach to registry data integration","what":"Summary","title":"Skeleton concept","text":"High-quality analytical datasets require systematic construction rather ad-hoc processing. Registry-based variables typically derived deliberate, transparent transformations rather direct extraction. skeleton framework provides structure ’s easy maintain debug. swereg package standardizes workflow functions common data processing tasks. establishing temporal foundations data integration, can focus analysis instead data plumbing.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Building the data skeleton (skeleton1_create)","text":"vignette demonstrates skeleton1_create - first stage swereg workflow raw registry data integrated time-structured framework. Prerequisites: ’re new swereg, start “Skeleton concept” vignette learn conceptual foundation.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"what-is-skeleton1_create","dir":"Articles","previous_headings":"","what":"What is skeleton1_create?","title":"Building the data skeleton (skeleton1_create)","text":"skeleton1_create stage provides time-structured framework : Individual IDs: person study Time structure: ISO years ISO year-weeks Data integration points: Framework merging registry data stage focuses data integration, cleaning - raw registry data multiple sources attached create foundation subsequent analysis.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"step-1-create-the-basic-skeleton","dir":"Articles","previous_headings":"","what":"Step 1: create the basic skeleton","title":"Building the data skeleton (skeleton1_create)","text":"Start creating skeleton study population time period: skeleton contains: id: Individual identifier isoyear: ISO year (annual data) isoyearweek: ISO year-week (weekly data, format “YYYY-WW” “YYYY-**” annual rows) is_isoyear: Boolean indicating annual vs weekly rows isoyearweeksun: Date representing Sunday (last day) ISO week/year","code":"# Load example data data(\"fake_person_ids\", package = \"swereg\")  # Create skeleton covering 2015-2020 skeleton <- swereg::create_skeleton(   ids = fake_person_ids,   date_min = \"2015-01-01\",   date_max = \"2020-12-31\" )  # Examine the structure head(skeleton) #>       id isoyear isoyearweek is_isoyear isoyearweeksun personyears #>    <int>   <int>      <char>     <lgcl>         <Date>       <num> #> 1:     1    1900     1900-**       TRUE     1900-07-01           1 #> 2:     1    1901     1901-**       TRUE     1901-06-30           1 #> 3:     1    1902     1902-**       TRUE     1902-06-29           1 #> 4:     1    1903     1903-**       TRUE     1903-06-28           1 #> 5:     1    1904     1904-**       TRUE     1904-07-03           1 #> 6:     1    1905     1905-**       TRUE     1905-07-02           1 cat(\"Skeleton dimensions:\", nrow(skeleton), \"rows,\", ncol(skeleton), \"columns\\n\") #> Skeleton dimensions: 430000 rows, 6 columns"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"step-2-add-demographic-data-one-time","dir":"Articles","previous_headings":"","what":"Step 2: add demographic data (one-time)","title":"Building the data skeleton (skeleton1_create)","text":"Demographics don’t change time, add per person:","code":"# Load and prepare demographic data fake_demographics <- swereg::fake_demographics |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"fodelseman\")  # Add to skeleton swereg::add_onetime(skeleton, fake_demographics, id_name = \"lopnr\")  # Check what was added new_vars <- setdiff(names(skeleton), c(\"id\", \"isoyear\", \"isoyearweek\", \"is_isoyear\", \"isoyearweeksun\")) cat(\"Added demographic variables:\", paste(new_vars, collapse = \", \"), \"\\n\") #> Added demographic variables: personyears, fodelseman, doddatum"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"step-3-add-annual-data","dir":"Articles","previous_headings":"","what":"Step 3: add annual data","title":"Building the data skeleton (skeleton1_create)","text":"data varies year (e.g., family status, income):","code":"# Load annual family data fake_annual_family <- swereg::fake_annual_family |>   data.table::copy() |>   swereg::make_lowercase_names()  # Add annual data for 2015 swereg::add_annual(skeleton, fake_annual_family, id_name = \"lopnr\", isoyear = 2015)  cat(\"Annual data added for 2015\\n\") #> Annual data added for 2015"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"step-4-add-diagnosis-data","dir":"Articles","previous_headings":"","what":"Step 4: add diagnosis data","title":"Building the data skeleton (skeleton1_create)","text":"Hospital diagnoses drive epidemiological studies:","code":"# Load and prepare diagnosis data fake_diagnoses <- swereg::fake_diagnoses |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing. fake_diagnoses <- swereg::fake_diagnoses |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing.  diagnoses_combined <- data.table::rbindlist(list(   fake_diagnoses,   fake_diagnoses ), use.names = TRUE, fill = TRUE)  # Define diagnosis patterns to search for (^ prefix automatically added) diagnosis_patterns <- list(   \"depression\" = c(\"F32\", \"F33\"),   \"anxiety\" = c(\"F40\", \"F41\"),    \"gender_dysphoria\" = c(\"F64\"),   \"cardiovascular\" = c(\"I10\", \"I20\", \"I21\") )  # Add diagnoses to skeleton swereg::add_diagnoses(   skeleton,   diagnoses_combined,   id_name = \"lopnr\",   diags = diagnosis_patterns )  # Check results diag_vars <- names(diagnosis_patterns) for(var in diag_vars) {   count <- sum(skeleton[[var]], na.rm = TRUE)   cat(\"-\", var, \":\", count, \"positive cases\\n\") } #> - depression : 322 positive cases #> - anxiety : 314 positive cases #> - gender_dysphoria : 461 positive cases #> - cardiovascular : 208 positive cases"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"step-5-add-prescription-data","dir":"Articles","previous_headings":"","what":"Step 5: add prescription data","title":"Building the data skeleton (skeleton1_create)","text":"Medication data treatment duration ATC code patterns:","code":"# Load prescription data fake_prescriptions <- swereg::fake_prescriptions |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"edatum\")  # Define drug patterns (ATC codes, ^ prefix automatically added) drug_patterns <- list(   \"antidepressants\" = c(\"N06A\"),   \"hormones\" = c(\"G03\"),   \"cardiovascular_drugs\" = c(\"C07\", \"C08\", \"C09\") )  # Add prescriptions to skeleton swereg::add_rx(   skeleton,   fake_prescriptions,   id_name = \"p444_lopnr_personnr\",   rxs = drug_patterns )  # Check prescription usage rx_vars <- names(drug_patterns) for(var in rx_vars) {   count <- sum(skeleton[[var]], na.rm = TRUE)   cat(\"-\", var, \":\", count, \"prescription periods\\n\") } #> - antidepressants : 4066 prescription periods #> - hormones : 15124 prescription periods #> - cardiovascular_drugs : 2165 prescription periods"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"step-6-add-surgical-operation-data","dir":"Articles","previous_headings":"","what":"Step 6: add surgical operation data","title":"Building the data skeleton (skeleton1_create)","text":"Surgical procedures hospital records:","code":"# Add operations (using default gender-affirming surgery codes) swereg::add_operations(skeleton, fake_diagnoses, \"lopnr\")  # Check operation counts operation_vars <- grep(\"^op_\", names(skeleton), value = TRUE) cat(\"Operation variables added:\", length(operation_vars), \"\\n\") #> Operation variables added: 9 for(var in operation_vars[1:3]) {  # Show first 3   count <- sum(skeleton[[var]], na.rm = TRUE)   cat(\"-\", var, \":\", count, \"procedures\\n\") } #> - op_afab_mastectomy : 250 procedures #> - op_afab_breast_reconst_and_other_breast_ops : 0 procedures #> - op_afab_penis_test_prosth : 0 procedures"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"step-7-add-cause-of-death-data","dir":"Articles","previous_headings":"","what":"Step 7: add cause of death data","title":"Building the data skeleton (skeleton1_create)","text":"mortality studies:","code":"# Load cause of death data fake_cod <- swereg::fake_cod |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"dodsdat\")  # Define cause of death patterns (^ prefix automatically added) cod_patterns <- list(   \"cardiovascular_death\" = c(\"I21\", \"I22\"),   \"external_causes\" = c(\"X60\", \"X70\") )  # Add to skeleton swereg::add_cods(   skeleton,   fake_cod,   id_name = \"lopnr\",   cods = cod_patterns )  # Check mortality cod_vars <- names(cod_patterns) for(var in cod_vars) {   count <- sum(skeleton[[var]], na.rm = TRUE)   cat(\"-\", var, \":\", count, \"deaths\\n\") } #> - cardiovascular_death : 16 deaths #> - external_causes : 9 deaths"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"completed-skeleton1_create","dir":"Articles","previous_headings":"","what":"Completed skeleton1_create","title":"Building the data skeleton (skeleton1_create)","text":"completed skeleton1_create now contains raw registry data integrated time structure:","code":"cat(\"Final skeleton dimensions:\", nrow(skeleton), \"rows,\", ncol(skeleton), \"columns\\n\") #> Final skeleton dimensions: 430000 rows, 27 columns  # Example: Show data for one person person_data <- skeleton[id == fake_person_ids[1] & isoyear == 2018 & !is.na(isoyearweek)] cat(\"\\nExample data for person\", fake_person_ids[1], \"in 2018 (first 6 weeks):\\n\") #>  #> Example data for person 1 in 2018 (first 6 weeks): print(head(person_data[, .(id, isoyearweek, depression, antidepressants, cardiovascular)])) #>       id isoyearweek depression antidepressants cardiovascular #>    <int>      <char>     <lgcl>          <lgcl>         <lgcl> #> 1:     1     2018-01      FALSE           FALSE          FALSE #> 2:     1     2018-02      FALSE           FALSE          FALSE #> 3:     1     2018-03      FALSE           FALSE          FALSE #> 4:     1     2018-04      FALSE           FALSE          FALSE #> 5:     1     2018-05      FALSE           FALSE          FALSE #> 6:     1     2018-06      FALSE           FALSE          FALSE"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"key-principles-for-skeleton1_create","dir":"Articles","previous_headings":"","what":"Key principles for skeleton1_create","title":"Building the data skeleton (skeleton1_create)","text":"Always use make_lowercase_names() reading registry data Sequential integration: Add data types logical order Pattern matching: Use regex patterns medical codes (^ prefix automatically added) Time structure: Leverage ISO year-weeks precise temporal analysis Raw data focus: skeleton1_create integration, cleaning","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"understanding-the-output","dir":"Articles","previous_headings":"","what":"Understanding the output","title":"Building the data skeleton (skeleton1_create)","text":"skeleton1_create output several important characteristics: Mixed time granularity: weekly (is_isoyear == FALSE) yearly (is_isoyear == TRUE) rows Boolean variables: diagnosis, prescription, operation variables TRUE/FALSE Time alignment: Events aligned ISO year-weeks consistency","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton1-create.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Building the data skeleton (skeleton1_create)","text":"skeleton1_create provides foundation subsequent analysis. raw data now integrated time-structured framework, ready cleaning variable derivation. Next stage: See “Cleaning deriving variables (skeleton2_clean)” vignette learn clean data create analysis-ready variables. Production workflows: large-scale processing, see “Production analysis workflows (skeleton3_analyze)” vignette.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Cleaning and deriving variables (skeleton2_clean)","text":"vignette demonstrates skeleton2_clean - second stage swereg workflow raw integrated data cleaned analysis-ready variables created. Prerequisites: Complete “Building data skeleton (skeleton1_create)” vignette first, stage builds directly skeleton1_create output.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"what-is-skeleton2_clean","dir":"Articles","previous_headings":"","what":"What is skeleton2_clean?","title":"Cleaning and deriving variables (skeleton2_clean)","text":"skeleton2_clean stage focuses : Data cleaning: Using data within skeleton (external joins) Variable derivation: Creating composite indicators summary variables Quality filters: Removing invalid observations applying study criteria Analysis preparation: Creating variables ready statistical modeling stage transforms raw integrated data clean, analysis-ready variables.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"step-1-load-skeleton1_create-output","dir":"Articles","previous_headings":"","what":"Step 1: load skeleton1_create output","title":"Cleaning and deriving variables (skeleton2_clean)","text":"Note: vignette assumes completed skeleton1_create (see “Building data skeleton” vignette). demonstration, ’ll create minimal skeleton:","code":"# Quick skeleton setup for demonstration skeleton <- swereg::create_skeleton(swereg::fake_person_ids, \"2015-01-01\", \"2020-12-31\")  # Add minimal data for demonstration fake_demographics <- swereg::fake_demographics |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"fodelseman\") swereg::add_onetime(skeleton, fake_demographics, id_name = \"lopnr\")  fake_diagnoses <- swereg::fake_diagnoses |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing. swereg::add_diagnoses(skeleton, fake_diagnoses, id_name = \"lopnr\",                       diags = list(                        \"depression\" = c(\"F32\", \"F33\"),                        \"anxiety\" = c(\"F40\", \"F41\"),                         \"gender_dysphoria\" = c(\"F64\"),                        \"psychosis\" = c(\"F20\", \"F25\")                      ))  # Add prescriptions for treatment variables fake_prescriptions <- swereg::fake_prescriptions |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"edatum\") swereg::add_rx(skeleton, fake_prescriptions, id_name = \"p444_lopnr_personnr\",               rxs = list(                 \"antidepressants\" = c(\"N06A\"),                 \"antipsychotics\" = c(\"N05A\"),                 \"hormones\" = c(\"G03\")               ))  # Add cause of death data  fake_cod <- swereg::fake_cod |>   data.table::copy() |>   swereg::make_lowercase_names(date_columns = \"dodsdat\") swereg::add_cods(skeleton, fake_cod, id_name = \"lopnr\",                 cods = list(                   \"external_death\" = c(\"X60\", \"X70\"),                   \"cardiovascular_death\" = c(\"I21\", \"I22\")                 ))  cat(\"skeleton1_create completed:\", nrow(skeleton), \"rows,\", ncol(skeleton), \"columns\\n\") #> skeleton1_create completed: 430000 rows, 17 columns"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"step-2-data-cleaning-operations","dir":"Articles","previous_headings":"","what":"Step 2: data cleaning operations","title":"Cleaning and deriving variables (skeleton2_clean)","text":"Now clean derive variables using data within skeleton:","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"create-age-variable","dir":"Articles","previous_headings":"Step 2: data cleaning operations","what":"Create age variable","title":"Cleaning and deriving variables (skeleton2_clean)","text":"","code":"# Create age variable skeleton[, birth_year := as.numeric(substr(fodelseman, 1, 4))] skeleton[, age := isoyear - birth_year]  cat(\"Age variable created\\n\") #> Age variable created"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"create-mental-health-composite-variables","dir":"Articles","previous_headings":"Step 2: data cleaning operations","what":"Create mental health composite variables","title":"Cleaning and deriving variables (skeleton2_clean)","text":"","code":"# Create mental health composite variables skeleton[, any_mental_health := depression | anxiety | psychosis] skeleton[, severe_mental_illness := psychosis | gender_dysphoria]  # Check mental health prevalence cat(\"Any mental health condition:\", sum(skeleton$any_mental_health, na.rm = TRUE), \"person-periods\\n\") #> Any mental health condition: 941 person-periods cat(\"Severe mental illness:\", sum(skeleton$severe_mental_illness, na.rm = TRUE), \"person-periods\\n\") #> Severe mental illness: 779 person-periods"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"create-medication-concordance-variables","dir":"Articles","previous_headings":"Step 2: data cleaning operations","what":"Create medication concordance variables","title":"Cleaning and deriving variables (skeleton2_clean)","text":"","code":"# Create medication concordance variables skeleton[, depression_treated := depression & antidepressants] skeleton[, psychosis_treated := psychosis & antipsychotics]  # Check treatment patterns cat(\"Depression with treatment:\", sum(skeleton$depression_treated, na.rm = TRUE), \"periods\\n\") #> Depression with treatment: 1 periods cat(\"Psychosis with treatment:\", sum(skeleton$psychosis_treated, na.rm = TRUE), \"periods\\n\") #> Psychosis with treatment: 4 periods"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"create-life-stage-variables","dir":"Articles","previous_headings":"Step 2: data cleaning operations","what":"Create life stage variables","title":"Cleaning and deriving variables (skeleton2_clean)","text":"","code":"# Create life stage variables skeleton[, life_stage := fcase(   age < 18, \"child\",   age >= 18 & age < 65, \"adult\",    age >= 65, \"elderly\",   default = \"unknown\" )]  # Check life stage distribution cat(\"Life stage distribution:\\n\") #> Life stage distribution: print(table(skeleton[is_isoyear == TRUE]$life_stage, useNA = \"ifany\")) #>  #>   adult   child elderly  #>   20628   95355      17"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"create-outcome-variables","dir":"Articles","previous_headings":"Step 2: data cleaning operations","what":"Create outcome variables","title":"Cleaning and deriving variables (skeleton2_clean)","text":"","code":"# Create outcome variables skeleton[, death_any := external_death | cardiovascular_death]  cat(\"Any death:\", sum(skeleton$death_any, na.rm = TRUE), \"deaths\\n\") #> Any death: 22 deaths"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"step-3-quality-filters-and-validation","dir":"Articles","previous_headings":"","what":"Step 3: quality filters and validation","title":"Cleaning and deriving variables (skeleton2_clean)","text":"Apply study criteria quality filters:","code":"# Filter to valid ages and reasonable time periods cat(\"Before filtering:\", nrow(skeleton), \"rows\\n\") #> Before filtering: 430000 rows  skeleton <- skeleton[age >= 0 & age <= 100] skeleton <- skeleton[isoyear >= 2015]  # Remove historical rows  cat(\"After filtering:\", nrow(skeleton), \"rows\\n\") #> After filtering: 315000 rows"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"step-4-create-study-design-variables","dir":"Articles","previous_headings":"","what":"Step 4: create study design variables","title":"Cleaning and deriving variables (skeleton2_clean)","text":"Create variables case-control cohort study designs:","code":"# Create registry tag variables (simulate case-control study) skeleton[, register_tag := fcase(   gender_dysphoria == TRUE, \"case\",   id %% 3 == 0, \"control_matched\",   default = \"control_population\" )]  # Create shared case variables (for matched studies) # Find first gender dysphoria diagnosis for cases gd_first <- skeleton[gender_dysphoria == TRUE & register_tag == \"case\",                       .(first_gd_year = min(isoyear, na.rm = TRUE)),                       by = .(id)]  # Add to skeleton skeleton[gd_first, on = \"id\", first_gd_year := first_gd_year]  # For controls, assign their matched case's first GD year (simplified) skeleton[register_tag != \"case\", first_gd_year := 2016]  # Simplified for demo  cat(\"Study design variables created\\n\") #> Study design variables created print(table(skeleton[is_isoyear == TRUE]$register_tag)) #>  #>    control_matched control_population  #>                333                667"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"step-5-remove-temporary-variables","dir":"Articles","previous_headings":"","what":"Step 5: remove temporary variables","title":"Cleaning and deriving variables (skeleton2_clean)","text":"Clean intermediate variables:","code":"# Remove temporary variables skeleton[, c(\"fodelseman\", \"birth_year\") := NULL]  cat(\"skeleton2_clean completed:\", nrow(skeleton), \"rows,\", ncol(skeleton), \"columns\\n\") #> skeleton2_clean completed: 315000 rows, 25 columns"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"cleaned-dataset-summary","dir":"Articles","previous_headings":"","what":"Cleaned dataset summary","title":"Cleaning and deriving variables (skeleton2_clean)","text":"cleaned skeleton2 now contains derived variables ready analysis:","code":"# Show structure cat(\"Variables:\", paste(names(skeleton), collapse = \", \"), \"\\n\") #> Variables: id, isoyear, isoyearweek, is_isoyear, isoyearweeksun, personyears, doddatum, depression, anxiety, gender_dysphoria, psychosis, antidepressants, antipsychotics, hormones, external_death, cardiovascular_death, age, any_mental_health, severe_mental_illness, depression_treated, psychosis_treated, life_stage, death_any, register_tag, first_gd_year  # Example analysis: Depression prevalence by life stage (filter to years with data) depression_summary <- skeleton[is_isoyear == TRUE & isoyear >= 2015, .(   n_person_years = .N,   depression_prev = mean(depression, na.rm = TRUE),   treatment_rate = ifelse(sum(depression, na.rm = TRUE) > 0,                          mean(depression_treated[depression == TRUE], na.rm = TRUE),                          NA_real_) ), by = .(life_stage, register_tag)]  print(depression_summary[n_person_years > 0])  # Only show non-empty groups #>    life_stage       register_tag n_person_years depression_prev treatment_rate #>        <char>             <char>          <int>           <num>          <num> #> 1:      adult control_population            554               0             NA #> 2:      adult    control_matched            278               0             NA #> 3:      child control_population            104               0             NA #> 4:      child    control_matched             47               0             NA #> 5:    elderly control_population              9               0             NA #> 6:    elderly    control_matched              8               0             NA # Example: Mental health treatment patterns (filter to valid data) treatment_summary <- skeleton[any_mental_health == TRUE & is_isoyear == TRUE & !is.na(register_tag), .(   antidepressant_use = mean(antidepressants, na.rm = TRUE),   antipsychotic_use = mean(antipsychotics, na.rm = TRUE),   hormone_use = mean(hormones, na.rm = TRUE),   mean_age = mean(age, na.rm = TRUE),   n_observations = .N ), by = register_tag]  print(treatment_summary[n_observations > 0])  # Only show groups with data #> Empty data.table (0 rows and 6 cols): register_tag,antidepressant_use,antipsychotic_use,hormone_use,mean_age,n_observations"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"data-cleaning-strategy","dir":"Articles","previous_headings":"Key principles for skeleton2_clean","what":"Data cleaning strategy","title":"Cleaning and deriving variables (skeleton2_clean)","text":"Self-contained: skeleton2_clean uses data within skeleton Derived variables: Create analysis variables raw data Quality filters: Remove invalid observations Clinical indicators: Create meaningful composite variables","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"variable-creation-patterns","dir":"Articles","previous_headings":"Key principles for skeleton2_clean","what":"Variable creation patterns","title":"Cleaning and deriving variables (skeleton2_clean)","text":"Composite indicators: Combine multiple boolean variables (e.g., any_mental_health) Treatment concordance: Match diagnoses treatments (e.g., depression_treated) Life course variables: Create age-based categories life stages Study design variables: Create case/control indicators matched cohort variables","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"understanding-the-skeleton2_clean-output","dir":"Articles","previous_headings":"","what":"Understanding the skeleton2_clean output","title":"Cleaning and deriving variables (skeleton2_clean)","text":"skeleton2_clean output contains: Clean variables: Validated age, filtered time periods Derived indicators: Composite mental health variables, treatment patterns Study variables: Case-control tags, cohort definitions Summary measures: Person-level aggregations annual data Analysis-ready format: Variables ready statistical modeling","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton2-clean.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Cleaning and deriving variables (skeleton2_clean)","text":"skeleton2_clean provides clean, analysis-ready variables statistical modeling. data validated, derived variables created, study design implemented. large datasets: huge datasets (>100,000 individuals) limited RAM, see “Batching (skeleton3_analyze)” vignette learn memory-efficient processing techniques. Analysis ready: analyses, can proceed directly descriptive statistics, regression modeling, survival analysis using cleaned skeleton2 data.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Batching (skeleton3_analyze)","text":"vignette demonstrates skeleton3_analyze - memory-efficient batching techniques processing huge datasets limited RAM. Important note: stage required large datasets (>100,000 individuals) insufficient RAM. analyses, can use cleaned skeleton2_clean output directly statistical modeling. Prerequisites: Complete “Cleaning deriving variables (skeleton2_clean)” vignette first, stage builds skeleton2_clean output.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"what-is-skeleton3_analyze","dir":"Articles","previous_headings":"","what":"What is skeleton3_analyze?","title":"Batching (skeleton3_analyze)","text":"skeleton3_analyze stage focuses : Final data aggregation: Weekly→yearly data collapsing needed Analysis dataset creation: Optimized specific research questions Memory-efficient processing: Batching strategies large populations Production workflows: Scalable approaches hundreds thousands individuals stage creates final analysis datasets ready statistical modeling.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"when-to-use-batching-strategies","dir":"Articles","previous_headings":"","what":"When to use batching strategies","title":"Batching (skeleton3_analyze)","text":"Use batching strategies : Study population > 100,000 individuals Memory constraints: Limited RAM full dataset Processing time: Long-running operations benefit parallel processing File size management: Breaking large datasets manageable chunks","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"setup-memory-efficient-workflow","dir":"Articles","previous_headings":"","what":"Setup: memory-efficient workflow","title":"Batching (skeleton3_analyze)","text":"","code":"# Setup for batched processing BATCH_SIZE <- 50  # Small for demonstration - use 1000-5000 for real studies OUTPUT_DIR <- tempdir()  # Use temporary directory for vignette  # Setup for demonstration (see skeleton1_create vignette for detailed data integration) # For batching, we organize data into large_data_files list for memory management large_data_files <- list(   \"fake_demographics\" = swereg::fake_demographics |>     data.table::copy() |>     swereg::make_lowercase_names(date_columns = \"fodelseman\"),   \"fake_annual_family\" = swereg::fake_annual_family |>     swereg::make_lowercase_names(),   \"fake_diagnoses\" = swereg::fake_diagnoses |>     data.table::copy() |>     swereg::make_lowercase_names(date_columns = \"indatum\"),   \"fake_diagnoses\" = swereg::fake_diagnoses |>     data.table::copy() |>     swereg::make_lowercase_names(date_columns = \"indatum\"),   \"fake_prescriptions\" = swereg::fake_prescriptions |>     data.table::copy() |>     swereg::make_lowercase_names(date_columns = \"edatum\"),   \"fake_cod\" = swereg::fake_cod |>     data.table::copy() |>     swereg::make_lowercase_names(date_columns = \"dodsdat\") )  cat(\"Data loaded and preprocessed - ready for batched processing\\n\")"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"the-three-stage-batched-workflow","dir":"Articles","previous_headings":"","what":"The three-stage batched workflow","title":"Batching (skeleton3_analyze)","text":"skeleton1_create batches: Process raw data integration chunks, save skeleton1 files skeleton2_clean batches: Load skeleton1 files, clean data, save skeleton2 files skeleton3_analyze: Combine skeleton2 files final analysis dataset","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"create-batch-processing-function","dir":"Articles","previous_headings":"Phase 1: skeleton1_create (batched data integration)","what":"Create batch processing function","title":"Batching (skeleton3_analyze)","text":"","code":"skeleton1_create_batch <- function(batch_ids, batch_number, large_data_files) {   # Declare variables for data.table non-standard evaluation   lopnr <- p444_lopnr_personnr <- NULL      cat(\"Processing batch\", batch_number, \"with\", length(batch_ids), \"individuals\\n\")      # Create skeleton for this batch   skeleton <- swereg::create_skeleton(     ids = batch_ids,     date_min = \"2015-01-01\",     date_max = \"2018-12-31\"  # Shorter period for demonstration   )      # Add demographics   demographics_subset <- large_data_files[[\"fake_demographics\"]][lopnr %in% batch_ids]   if (nrow(demographics_subset) > 0) {     swereg::add_onetime(skeleton, demographics_subset, id_name = \"lopnr\")   }      # Add annual data   annual_subset <- large_data_files[[\"fake_annual_family\"]][lopnr %in% batch_ids]   if (nrow(annual_subset) > 0) {     swereg::add_annual(skeleton, annual_subset, id_name = \"lopnr\", isoyear = 2015)   }      # Add diagnoses   diagnoses_subset <- large_data_files[[\"fake_diagnoses\"]][lopnr %in% batch_ids]    if (nrow(diagnoses_subset) > 0) {     swereg::add_diagnoses(       skeleton,       diagnoses_subset,       id_name = \"lopnr\",       diags = list(         \"depression\" = c(\"F32\", \"F33\"),         \"anxiety\" = c(\"F40\", \"F41\"),         \"gender_dysphoria\" = c(\"F64\"),         \"psychosis\" = c(\"F20\", \"F25\")       )     )   }      # Add prescriptions   prescriptions_subset <- large_data_files[[\"fake_prescriptions\"]][p444_lopnr_personnr %in% batch_ids]   if (nrow(prescriptions_subset) > 0) {     swereg::add_rx(       skeleton,       prescriptions_subset,       id_name = \"p444_lopnr_personnr\",       rxs = list(         \"antidepressants\" = c(\"N06A\"),         \"antipsychotics\" = c(\"N05A\"),         \"hormones\" = c(\"G03\")       )     )   }      # Add cause of death   cod_subset <- large_data_files[[\"fake_cod\"]][lopnr %in% batch_ids]   if (nrow(cod_subset) > 0) {     swereg::add_cods(       skeleton,       cod_subset,       id_name = \"lopnr\",       cods = list(         \"external_death\" = c(\"X60\", \"X70\"),         \"cardiovascular_death\" = c(\"I21\", \"I22\")       )     )   }      # Save batch using qs (much faster than RDS)   output_file <- file.path(OUTPUT_DIR, paste0(\"skeleton1_create_\", batch_number, \".qs2\"))   qs2::qs_save(skeleton, output_file)      cat(\"Saved skeleton1_create\", batch_number, \":\", nrow(skeleton), \"rows\\n\")   return(output_file) }"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"process-skeleton1_create-in-batches","dir":"Articles","previous_headings":"Phase 1: skeleton1_create (batched data integration)","what":"Process skeleton1_create in batches","title":"Batching (skeleton3_analyze)","text":"","code":"# Process first 100 individuals in 2 batches data(\"fake_person_ids\", package = \"swereg\") ids_subset <- fake_person_ids[1:100] id_batches <- csutil::easy_split(ids_subset, BATCH_SIZE)  skeleton1_files <- vector(\"character\", length(id_batches)) for (i in seq_along(id_batches)) {   skeleton1_files[i] <- skeleton1_create_batch(id_batches[[i]], i, large_data_files) }  cat(\"skeleton1_create phase completed for\", length(id_batches), \"batches\\n\")  # CRITICAL: Remove large datasets from memory # This is the key benefit of organizing data into large_data_files -  # easy cleanup of \"the big lump of data\" after skeleton1_create is complete rm(large_data_files) gc()  # Force garbage collection  cat(\"Large datasets removed from memory\\n\")"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"create-cleaning-function","dir":"Articles","previous_headings":"Phase 2: skeleton2_clean (batched data cleaning)","what":"Create cleaning function","title":"Batching (skeleton3_analyze)","text":"","code":"skeleton2_clean_batch <- function(batch_number) {   cat(\"Cleaning batch\", batch_number, \"\\n\")      # Load skeleton1 for this batch   input_file <- file.path(OUTPUT_DIR, paste0(\"skeleton1_create_\", batch_number, \".qs2\"))   skeleton <- qs2::qs_read(input_file)      # CLEANING OPERATIONS (using only data within skeleton)      # 1. Create age variable   skeleton[, birth_year := as.numeric(substr(fodelseman, 1, 4))]   skeleton[, age := isoyear - birth_year]      # 2. Create mental health composite variables   skeleton[, any_mental_health := depression | anxiety | psychosis]   skeleton[, severe_mental_illness := psychosis | gender_dysphoria]      # 3. Create medication concordance variables   skeleton[, depression_treated := depression & antidepressants]   skeleton[, psychosis_treated := psychosis & antipsychotics]      # 4. Create life stage variables   skeleton[, life_stage := fcase(     age < 18, \"child\",     age >= 18 & age < 65, \"adult\",      age >= 65, \"elderly\",     default = \"unknown\"   )]      # 5. Create outcome variables (handle missing death columns gracefully)   if (all(c(\"external_death\", \"cardiovascular_death\") %in% names(skeleton))) {     skeleton[, death_any := external_death | cardiovascular_death]   } else {     skeleton[, death_any := FALSE]   }      # 6. Filter to valid ages and reasonable time periods   skeleton <- skeleton[age >= 0 & age <= 100]   skeleton <- skeleton[isoyear >= 2015]  # Remove historical rows      # 7. Create person-level summaries for annual data   if (skeleton[, any(is_isoyear == TRUE)]) {     skeleton[is_isoyear == TRUE, n_mental_health_year := sum(c(depression, anxiety, psychosis), na.rm = TRUE), by = .(id, isoyear)]     skeleton[is_isoyear == TRUE, treatment_adherence := mean(c(depression_treated, psychosis_treated), na.rm = TRUE), by = .(id, isoyear)]   }      # 8. Create registry tag variables (simulate case-control study)   skeleton[, register_tag := fcase(     gender_dysphoria == TRUE, \"case\",     id %% 3 == 0, \"control_matched\",     default = \"control_population\"   )]      # 9. Create shared case variables (for matched studies)   # Find first gender dysphoria diagnosis for cases   gd_first <- skeleton[gender_dysphoria == TRUE & register_tag == \"case\",                         .(first_gd_year = min(isoyear, na.rm = TRUE)),                         by = .(id)]      # Add to skeleton   skeleton[gd_first, on = \"id\", first_gd_year := first_gd_year]      # For controls, assign their matched case's first GD year (simplified)   skeleton[register_tag != \"case\", first_gd_year := 2016]  # Simplified for demo      # 10. Remove temporary variables   skeleton[, c(\"fodelseman\", \"birth_year\") := NULL]      # Save cleaned skeleton using qs   output_file <- file.path(OUTPUT_DIR, paste0(\"skeleton2_clean_\", batch_number, \".qs2\"))   qs2::qs_save(skeleton, output_file)      cat(\"Cleaned skeleton2_clean\", batch_number, \":\", nrow(skeleton), \"rows,\", ncol(skeleton), \"columns\\n\")   return(output_file) }"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"process-skeleton2_clean-in-batches","dir":"Articles","previous_headings":"Phase 2: skeleton2_clean (batched data cleaning)","what":"Process skeleton2_clean in batches","title":"Batching (skeleton3_analyze)","text":"","code":"# Process all batches for skeleton2_clean skeleton2_files <- vector(\"character\", length(id_batches)) for (i in seq_along(id_batches)) {   skeleton2_files[i] <- skeleton2_clean_batch(i) }  cat(\"skeleton2_clean phase completed\\n\")"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"create-analysis-dataset-from-all-batches","dir":"Articles","previous_headings":"Phase 3: skeleton3_analyze (final analysis dataset)","what":"Create analysis dataset from all batches","title":"Batching (skeleton3_analyze)","text":"batching becomes essential - skeleton3 reduces data ’s needed analysis, dramatically reducing memory usage. Key concept: weekly→yearly data aggregation skeleton contains weekly yearly rows. skeleton3_analyze, collapse weekly data yearly data using swereg::max_with_infinite_as_na() answer question: “anything happen year?” diagnoses: person depression point year? treatments: person receive antidepressants point year? events: relevant event occur year? aggregation creates person-year level data suitable epidemiological analysis.","code":"skeleton3_analyze <- function(skeleton2_files) {   cat(\"Creating analysis dataset from\", length(skeleton2_files), \"batches\\n\")      # Load all cleaned batches   all_batches <- vector(\"list\", length(skeleton2_files))   for (i in seq_along(skeleton2_files)) {     skeleton <- qs2::qs_read(skeleton2_files[i])          # Extract analysis variables (collapse weekly data to yearly)     # Use max_with_infinite_as_na because we're aggregating weekly data to yearly:     # \"did anything happen this year?\"     analysis_data <- skeleton[       .(         # Demographic variables         age = swereg::first_non_na(age),         life_stage = swereg::first_non_na(life_stage),                  # Outcome variables - use max to detect \"did anything happen this year?\"         any_mental_health = swereg::max_with_infinite_as_na(any_mental_health),         severe_mental_illness = swereg::max_with_infinite_as_na(severe_mental_illness),         depression = swereg::max_with_infinite_as_na(depression),         anxiety = swereg::max_with_infinite_as_na(anxiety),         psychosis = swereg::max_with_infinite_as_na(psychosis),         gender_dysphoria = swereg::max_with_infinite_as_na(gender_dysphoria),                  # Treatment variables         antidepressants = swereg::max_with_infinite_as_na(antidepressants),         antipsychotics = swereg::max_with_infinite_as_na(antipsychotics),         hormones = swereg::max_with_infinite_as_na(hormones),                  # Derived variables         depression_treated = swereg::max_with_infinite_as_na(depression_treated),         psychosis_treated = swereg::max_with_infinite_as_na(psychosis_treated),                  # Mortality         death_any = swereg::max_with_infinite_as_na(death_any),                  # Study design variables         first_gd_year = swereg::first_non_na(first_gd_year),                  # Summary variables         n_mental_health_year = swereg::first_non_na(n_mental_health_year),         treatment_adherence = swereg::first_non_na(treatment_adherence)       ),       by = .(id, study_year = isoyear, register_tag)     ]          all_batches[[i]] <- analysis_data   }      # Combine all batches   final_analysis <- rbindlist(all_batches, fill = TRUE)      # Save final analysis dataset   output_file <- file.path(OUTPUT_DIR, \"skeleton3_analyze.qs2\")   qs2::qs_save(final_analysis, output_file)      cat(\"Saved skeleton3_analyze:\", nrow(final_analysis), \"person-years\\n\")      return(final_analysis) }  # Create final analysis dataset analysis_data <- skeleton3_analyze(skeleton2_files)  cat(\"Analysis dataset created:\", nrow(analysis_data), \"person-years\\n\") cat(\"Variables:\", ncol(analysis_data), \"\\n\") cat(\"Study population breakdown:\\n\") print(table(analysis_data$register_tag))"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"analysis-dataset-summary","dir":"Articles","previous_headings":"","what":"Analysis dataset summary","title":"Batching (skeleton3_analyze)","text":"final skeleton3_analyze contains analysis-ready data:","code":"# Show structure str(analysis_data)  # Example analysis: Depression prevalence by register tag depression_summary <- analysis_data[, .(   n_person_years = .N,   depression_prev = mean(depression, na.rm = TRUE),   # Fix treatment rate calculation to avoid NaN   treatment_rate = ifelse(sum(depression, na.rm = TRUE) > 0,                           mean(depression_treated[depression == TRUE], na.rm = TRUE),                           NA_real_) ), by = .(register_tag)]  print(depression_summary) # Example: Mental health treatment patterns treatment_summary <- analysis_data[any_mental_health == TRUE, .(   antidepressant_use = mean(antidepressants, na.rm = TRUE),   antipsychotic_use = mean(antipsychotics, na.rm = TRUE),   hormone_use = mean(hormones, na.rm = TRUE),   mean_age = mean(age, na.rm = TRUE) ), by = register_tag]  print(treatment_summary)"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"batch-size-optimization","dir":"Articles","previous_headings":"Memory management best practices","what":"1. Batch size optimization","title":"Batching (skeleton3_analyze)","text":"","code":"# For production studies, batch size depends on: # - Available RAM: Larger batches use more memory but fewer file operations # - Processing time: Very large batches can hit memory limits # - File system: Too many small files can slow down I/O  # Recommended batch sizes: # - 1,000-2,000 individuals for modest hardware (8-16GB RAM) # - 5,000-10,000 individuals for high-memory systems (32-64GB RAM) # - Each batch uses ~200-500MB RAM during processing"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"file-organization","dir":"Articles","previous_headings":"Memory management best practices","what":"2. File organization","title":"Batching (skeleton3_analyze)","text":"","code":"# For production studies, organize files systematically: # OUTPUT_DIR/ #   skeleton1/ #     skeleton1_create_1.qs2, skeleton1_create_2.qs2, ... #   skeleton2/ #     skeleton2_clean_1.qs2, skeleton2_clean_2.qs2, ... #   skeleton3/ #     skeleton3_analyze.qs2  # Clean up strategy: # 1. Keep skeleton2 files for quality checks # 2. Remove skeleton1 files after skeleton2_clean succeeds # 3. Archive skeleton2 files after skeleton3_analyze succeeds"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"error-handling","dir":"Articles","previous_headings":"Memory management best practices","what":"3. Error handling","title":"Batching (skeleton3_analyze)","text":"","code":"# Production workflows should include error handling skeleton1_create_batch_safe <- function(batch_ids, batch_number, large_data_files) {   tryCatch({     return(skeleton1_create_batch(batch_ids, batch_number, large_data_files))   }, error = function(e) {     cat(\"ERROR in batch\", batch_number, \":\", e$message, \"\\n\")     return(NULL)   }) }  # Check for failed batches before proceeding # failed_batches <- which(sapply(skeleton1_files, is.null)) # This allows resuming failed batch processing"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"memory-efficiency","dir":"Articles","previous_headings":"Key batching principles","what":"Memory efficiency","title":"Batching (skeleton3_analyze)","text":"Sequential processing: Process one batch time Memory cleanup: Remove large datasets skeleton1_create Garbage collection: Use gc() batches File-based workflow: Save/load batches disk","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"data-integrity","dir":"Articles","previous_headings":"Key batching principles","what":"Data integrity","title":"Batching (skeleton3_analyze)","text":"Batch validation: Check individuals processed File verification: Ensure batch files exist skeleton3 Data consistency: Verify variables across batches","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/skeleton3-analyze.html","id":"summary-the-complete-skeleton1skeleton2skeleton3-workflow","dir":"Articles","previous_headings":"","what":"Summary: the complete skeleton1→skeleton2→skeleton3 workflow","title":"Batching (skeleton3_analyze)","text":"pipeline demonstrates production-scale processing: skeleton1_create: Built time-structured framework integrated raw registry data batches skeleton2_clean: Cleaned variables created derived clinical indicators batches skeleton3_analyze: Combined batches final analysis dataset memory-efficient aggregation Key benefits: - Scalable: Handles hundreds thousands individuals - Memory-efficient: Uses large_data_files pattern systematic cleanup - Robust: File-based workflow survives interruptions - Analysis-ready: Final dataset optimized statistical modeling skeleton3_analyze output now ready epidemiological analysis, regression modeling, survival analysis.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/articles/tte-nomenclature.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Target trial emulation nomenclature","text":"vignette defines terms used throughout swereg target trial emulation (TTE) system. serves quick reference anyone reading writing code uses TTEDesign, TTEEnrollment, TTEPlan.","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/tte-nomenclature.html","id":"loop-1-enrollment-ipw","dir":"Articles","previous_headings":"Two-loop architecture","what":"Loop 1: enrollment + IPW","title":"Target trial emulation nomenclature","text":"One iteration per enrollment_id. Run plan$generate_enrollments_and_ipw(): Produces two files per enrollment_id: file_raw — post-enrollment, pre-imputation file_imp — post-imputation + IPW (input Loop 2)","code":"skeleton files ──(parallel callr workers)──► enroll   ──► rbind ──► collapse ──► impute ──► IPW + truncate ──► save"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/tte-nomenclature.html","id":"loop-2-per-ett-outcome-weighting","dir":"Articles","previous_headings":"Two-loop architecture","what":"Loop 2: per-ETT outcome weighting","title":"Target trial emulation nomenclature","text":"One iteration per ETT. Runs sequentially main process: $prepare_for_analysis() combines outcome preparation IPCW-PP one call. prepares outcome data, calculates IPCW-PP, combines weights (ipw × ipcw_pp → analysis_weight_pp), truncates, drops intermediate IPCW columns.","code":"load file_imp ──► $prepare_for_analysis() ──► save file_analysis"},{"path":"https://papadopoulos-lab.github.io/swereg/articles/tte-nomenclature.html","id":"process_fn-callback","dir":"Articles","previous_headings":"Two-loop architecture","what":"process_fn callback","title":"Target trial emulation nomenclature","text":"User-supplied function signature function(enrollment_spec, file_path). Called per skeleton file per enrollment_id inside Loop 1. Responsible : Eligibility checks (age, calendar time, exclusion criteria) Exposure definition Enrollment via tte_enrollment(..., ratio = ) invocation runs fresh R subprocess (callr::r_bg()) avoid fork + OpenMP segfault issues data.table.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/articles/tte-nomenclature.html","id":"file-naming","dir":"Articles","previous_headings":"","what":"File naming","title":"Target trial emulation nomenclature","text":"output files live project-specific data directory.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"package proudly brought : Richard Aubrey White. Author, maintainer. See changelog contributors.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"White RA (2026). swereg: Manipulating Swedish Registry Data. R package version 26.2.27, https://github.com/papadopoulos-lab/swereg.","code":"@Manual{,   title = {swereg: Manipulating Swedish Registry Data},   author = {Richard Aubrey White},   year = {2026},   note = {R package version 26.2.27},   url = {https://github.com/papadopoulos-lab/swereg}, }"},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"swereg","dir":"","previous_headings":"","what":"Manipulating Swedish Registry Data","title":"Manipulating Swedish Registry Data","text":"swereg R package manipulating analyzing healthcare registry data epidemiological research. uses three-stage framework creating longitudinal data skeletons integrating multiple health registries.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"registry-integration","dir":"","previous_headings":"","what":"Registry integration","title":"Manipulating Swedish Registry Data","text":"swereg designed healthcare registries realistic synthetic data included: Hospital registers: Diagnosis codes (ICD-10) surgical procedures Prescription registers: Medication data ATC codes treatment duration Death registers: Underlying multiple causes proper variable names Administrative data: Demographics socioeconomic data Synthetic datasets: fake_demographics, fake_diagnoses, fake_prescriptions, fake_cod, etc.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"the-skeleton-approach","dir":"","previous_headings":"","what":"The skeleton approach","title":"Manipulating Swedish Registry Data","text":"swereg uses skeleton concept: build strong ‘bones’ (time structure) attach ‘muscles’ (data) systematically three stages: skeleton1_create - Raw data integration skeleton2_clean - Data cleaning derived variables (analysis-ready studies) skeleton3_analyze - Memory-efficient batching (needed huge datasets limited RAM)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Manipulating Swedish Registry Data","text":"Three-stage workflow: Systematic skeleton1→skeleton2→skeleton3 progression Time structure: ISO year-weeks automatic Sunday date calculation person-time calculations Flexible date parsing: Handles Swedish registry dates varying precision (4/6/8 characters) Healthcare integration: Hospital diagnosis surgical procedures automatic pattern matching Prescription analysis: Prescription data treatment duration ATC code patterns Mortality data: Death registry underlying multiple causes Synthetic data: Realistic synthetic registry data development testing Scalable processing: Memory-efficient batching large populations (needed) Reproducible workflow: Standardized methodology registry-based epidemiological research","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"data-structure","dir":"","previous_headings":"Core functions","what":"Data structure","title":"Manipulating Swedish Registry Data","text":"create_skeleton() - Create longitudinal data skeleton individual IDs, time periods, person-time calculations make_lowercase_names() - Standardize column names clean date columns across datasets parse_swedish_date() - Parse Swedish registry dates varying precision (4/6/8 characters)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"data-integration","dir":"","previous_headings":"Core functions","what":"Data integration","title":"Manipulating Swedish Registry Data","text":"add_onetime() - Merge baseline/demographic data add_annual() - Add annual data specific years add_diagnoses() - Integrate healthcare diagnosis data (ICD-10) add_operations() - Add surgical procedure data add_rx() - Include prescription drug data treatment periods add_cods() - Merge cause death information","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"specialized-functions","dir":"","previous_headings":"Core functions","what":"Specialized functions","title":"Manipulating Swedish Registry Data","text":"x2023_mht_add_lmed() - Process menopausal hormone therapy prescription data","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Manipulating Swedish Registry Data","text":"can install development version swereg GitHub:","code":"# Install devtools if not already installed install.packages(\"devtools\")  # Install swereg devtools::install_github(\"papadopoulos-lab/swereg\")"},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting started","title":"Manipulating Swedish Registry Data","text":"Follow vignettes order learn skeleton approach:","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"id_1-understand-the-concept","dir":"","previous_headings":"Getting started","what":"1. Understand the concept","title":"Manipulating Swedish Registry Data","text":"Learn foundational skeleton approach works registry data analysis.","code":"vignette(\"skeleton-concept\")"},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"id_2-build-your-skeleton-skeleton1_create","dir":"","previous_headings":"Getting started","what":"2. Build your skeleton (skeleton1_create)","title":"Manipulating Swedish Registry Data","text":"Create time structure integrate raw registry data:","code":"vignette(\"skeleton1-create\") library(data.table)  # Load synthetic registry data (included with package) data(\"fake_person_ids\", package = \"swereg\") data(\"fake_demographics\", package = \"swereg\") data(\"fake_diagnoses\", package = \"swereg\")  # Step 1: Create the skeleton (good bones) skeleton <- swereg::create_skeleton(   ids = fake_person_ids[1:100],   date_min = \"2020-01-01\",   date_max = \"2022-12-31\" )  # Step 2: Apply standardization (required for all registry data) swereg::make_lowercase_names(fake_demographics, date_column = \"fodelseman\") swereg::make_lowercase_names(fake_diagnoses, date_column = \"indatum\")  # Step 3: Attach demographic data (muscles) demographics_subset <- fake_demographics[lopnr %in% fake_person_ids[1:100]] swereg::add_onetime(skeleton, demographics_subset, id_name = \"lopnr\")  # Step 4: Add diagnosis patterns (^ prefix automatically added) diagnosis_patterns <- list(   \"diabetes\" = c(\"E10\", \"E11\"),   \"depression\" = c(\"F32\", \"F33\") ) diagnoses_subset <- fake_diagnoses[lopnr %in% fake_person_ids[1:100]] swereg::add_diagnoses(skeleton, diagnoses_subset, \"lopnr\", diags = diagnosis_patterns)  # Result: skeleton1_create ready for skeleton2_clean stage head(skeleton)"},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"id_3-clean-your-data-skeleton2_clean---analysis-ready-for-most-studies","dir":"","previous_headings":"Getting started","what":"3. Clean your data (skeleton2_clean) - Analysis ready for most studies","title":"Manipulating Swedish Registry Data","text":"Clean variables create derived clinical indicators using data within skeleton. analyses, final step - can proceed directly statistical modeling using skeleton2_clean output.","code":"vignette(\"skeleton2-clean\")"},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"id_4-batching-for-huge-datasets-skeleton3_analyze---optional","dir":"","previous_headings":"Getting started","what":"4. Batching for huge datasets (skeleton3_analyze) - Optional","title":"Manipulating Swedish Registry Data","text":"needed huge datasets (>100,000 individuals) limited RAM. Learn memory-efficient batching techniques. users can skip use skeleton2_clean output directly analysis.","code":"vignette(\"skeleton3-analyze\")"},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"when-do-you-need-each-stage","dir":"","previous_headings":"","what":"When do you need each stage?","title":"Manipulating Swedish Registry Data","text":"skeleton1_create: Required users - integrates raw data time structure skeleton2_clean: Required users - creates analysis-ready variables skeleton3_analyze: Optional - needed memory-constrained processing large datasets","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"key-principles","dir":"","previous_headings":"","what":"Key principles","title":"Manipulating Swedish Registry Data","text":"Sequential stages: stage builds previous one Time structure: ISO year-weeks provide precise temporal alignment Pattern matching: Automatic prefix handling medical codes Analysis flexibility: skeleton2_clean output works statistical models Memory efficiency: skeleton3_analyze provides batching RAM limited","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"typical-workflow","dir":"","previous_headings":"","what":"Typical workflow","title":"Manipulating Swedish Registry Data","text":"users follow pattern: Read vignette(“skeleton-concept”) understand approach Create skeleton1 data using skeleton1-create vignette Clean skeleton2 using skeleton2-clean vignette Analyze skeleton2 directly preferred statistical methods (glm, survival, etc.) large-scale studies memory constraints need skeleton3_analyze.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Manipulating Swedish Registry Data","text":"Complete documentation tutorials available : https://papadopoulos-lab.github.io/swereg/","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Manipulating Swedish Registry Data","text":"use swereg research, please cite:","code":"[Citation information to be added]"},{"path":"https://papadopoulos-lab.github.io/swereg/license.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Richard Aubrey White Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/SkeletonConfig.html","id":null,"dir":"Reference","previous_headings":"","what":"SkeletonConfig class for skeleton pipeline — SkeletonConfig","title":"SkeletonConfig class for skeleton pipeline — SkeletonConfig","text":"Holds directory paths, group names, batch sizing, configuration rawbatch/skeleton pipeline. Analogous [TTEDesign] – specifies \"schema\" without holding data.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/SkeletonConfig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SkeletonConfig class for skeleton pipeline — SkeletonConfig","text":"","code":"SkeletonConfig(   rawbatch_dir = character(0),   skeleton_dir = character(0),   group_names = character(0),   batch_sizes = integer(0),   seed = integer(0),   id_col = character(0),   ids_per_skeleton_file = integer(0) )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/SkeletonConfig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SkeletonConfig class for skeleton pipeline — SkeletonConfig","text":"rawbatch_dir Character, resolved single path rawbatch files. skeleton_dir Character, resolved single path skeleton output. group_names Character vector, names rawbatch groups (e.g., `c(\"lmed\", \"diagnoses_and_operations\", \"\")`). batch_sizes Integer vector, IDs per batch. First element used batch 1 (development batch), second element remaining batches. Default: `c(1000L, 10000L)`. seed Integer, shuffle seed reproducibility. Default: `4L`. id_col Character, name person ID column. Default: `\"lopnr\"`. ids_per_skeleton_file Integer, number IDs per skeleton sub-file. Default: `1000L`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/SkeletonConfig.html","id":"computed-properties","dir":"Reference","previous_headings":"","what":"Computed properties","title":"SkeletonConfig class for skeleton pipeline — SkeletonConfig","text":"meta_file Character (read-). Full path     `skeleton_meta.qs2` file, derived `rawbatch_dir`.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/SkeletonConfig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SkeletonConfig class for skeleton pipeline — SkeletonConfig","text":"","code":"if (FALSE) { # \\dontrun{ config <- skeleton_config(   rawbatch_dir = c(     \"/data/argos/Bronze/Embla_data/_MHT/2026/generic/\",     \"C:/Users/isbeihm/Uppsala/argos/Bronze/Embla_data/_MHT/2026/generic/\"   ),   group_names = c(\"lmed\", \"diagnoses_and_operations\", \"other\") ) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/SkeletonMeta.html","id":null,"dir":"Reference","previous_headings":"","what":"SkeletonMeta class for skeleton pipeline — SkeletonMeta","title":"SkeletonMeta class for skeleton pipeline — SkeletonMeta","text":"Holds [SkeletonConfig] plus runtime state: batched ID lists disk file tracking. Analogous [TTEEnrollment] – carries data method-chaining workflow.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/SkeletonMeta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SkeletonMeta class for skeleton pipeline — SkeletonMeta","text":"","code":"SkeletonMeta(   config = SkeletonConfig(),   n_ids = integer(0),   n_batches = integer(0),   batch_id_list = list(),   groups_saved = character(0),   skeleton_files = character(0) )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/SkeletonMeta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SkeletonMeta class for skeleton pipeline — SkeletonMeta","text":"config [SkeletonConfig] object. n_ids Integer, total number IDs across batches. n_batches Integer, number batches. batch_id_list List ID vectors, one per batch. groups_saved Character vector rawbatch group names exist disk. skeleton_files Character vector skeleton output file paths detected disk.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":null,"dir":"Reference","previous_headings":"","what":"TTEDesign class for target trial emulation — TTEDesign","title":"TTEDesign class for target trial emulation — TTEDesign","text":"TTEDesign class target trial emulation TTEDesign class target trial emulation","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"TTEDesign class for target trial emulation — TTEDesign","text":"Holds column name mappings define schema trial data. allows specifying variable names reusing across TTE workflow functions.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"TTEDesign class for target trial emulation — TTEDesign","text":"person_id_var Character NULL, person identifier column name. id_var Character, trial identifier column name. exposure_var Character, exposure/treatment column name. outcome_vars Character vector, outcome column names. confounder_vars Character vector, confounder column names. follow_up_time Integer, follow-duration. tstart_var Character, period start time column name. tstop_var Character, period end time column name. time_exposure_var Character NULL, time-varying exposure column. eligible_var Character NULL, eligibility column name. admin_censor_var Character NULL, admin censoring column. admin_censor_isoyearweek Character NULL, admin censoring date.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"TTEDesign class for target trial emulation — TTEDesign","text":"TTEDesign$new() TTEDesign$print() TTEDesign$clone()","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"TTEDesign class for target trial emulation — TTEDesign","text":"Create new TTEDesign object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEDesign class for target trial emulation — TTEDesign","text":"","code":"TTEDesign$new(   person_id_var = NULL,   id_var = \"trial_id\",   exposure_var,   outcome_vars,   confounder_vars,   follow_up_time,   tstart_var = \"tstart\",   tstop_var = \"tstop\",   time_exposure_var = NULL,   eligible_var = NULL,   admin_censor_var = NULL,   admin_censor_isoyearweek = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEDesign class for target trial emulation — TTEDesign","text":"person_id_var Character NULL, name person identifier column pre-panel (person-week) data. Used `tte_enrollment()`. (default: NULL). id_var Character, name trial identifier column. Auto-generated `tte_enrollment()` \"trial_id\" (default: \"trial_id\"). exposure_var Character, name baseline exposure/treatment column. outcome_vars Character vector, names outcome event indicator columns. confounder_vars Character vector, names confounder columns propensity/censoring models. follow_up_time Integer, expected follow-duration time units. tstart_var Character, name period start time column (default: \"tstart\"). tstop_var Character, name period end time column (default: \"tstop\"). time_exposure_var Character NULL, name time-varying exposure column per-protocol analysis (default: NULL). eligible_var Character NULL, name eligibility indicator column (default: NULL). admin_censor_var Character NULL, name administrative censoring boundary column (default: NULL). Mutually exclusive `admin_censor_isoyearweek`. admin_censor_isoyearweek Character NULL, study end date ISO year-week format (e.g., \"2023-52\"). set, administrative censoring computed internally weeks trial's entry date global study end date. Requires `isoyearweek` column data. Mutually exclusive `admin_censor_var` (default: NULL).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"TTEDesign class for target trial emulation — TTEDesign","text":"Print TTEDesign object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEDesign class for target trial emulation — TTEDesign","text":"","code":"TTEDesign$print(...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"TTEDesign class for target trial emulation — TTEDesign","text":"objects class cloneable method.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEDesign class for target trial emulation — TTEDesign","text":"","code":"TTEDesign$clone(deep = FALSE)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEDesign class for target trial emulation — TTEDesign","text":"deep Whether make deep clone.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEDesign.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"TTEDesign class for target trial emulation — TTEDesign","text":"","code":"# Design for post-panel (trial-level) data design <- tte_design(   id_var = \"trial_id\",   exposure_var = \"baseline_exposed\",   outcome_vars = c(\"death\", \"hosp\"),   confounder_vars = c(\"age\", \"education\"),   follow_up_time = 156L )  # Design for pre-panel (person-week) data with full workflow design_prepanel <- tte_design(   person_id_var = \"id\",   exposure_var = \"baseline_exposed\",   outcome_vars = c(\"death\", \"hosp\"),   confounder_vars = c(\"age\", \"education\"),   follow_up_time = 156L,   eligible_var = \"eligible\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":null,"dir":"Reference","previous_headings":"","what":"TTEEnrollment class for target trial emulation — TTEEnrollment","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"TTEEnrollment class target trial emulation TTEEnrollment class target trial emulation","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Holds enrollment data, design specification, workflow state. Methods modify -place return `invisible(self)` `$`-chaining. R6 reference semantics mean `trial$data[, := ...]` modifies data.table -place without copy--write overhead. `data_level` property controls methods available: - `\"person_week\"`: Data one row per person per time unit. Pass `ratio`   constructor enroll transition trial level. - `\"trial\"`: Data expanded trial panels. Methods `$collapse()`,   `$ipw()`, `$prepare_for_analysis()`, `$truncate()` require level. Enrollment (matching + panel expansion) transitions data \"person_week\" \"trial\" level triggered passing `ratio` constructor.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"methods","dir":"Reference","previous_headings":"","what":"Methods","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"**Mutating (return `invisible(self)` chaining):** `$collapse(period_width, ...)` Collapse time intervals coarser periods `$ipw(stabilize)` Calculate inverse probability treatment weights `$prepare_for_analysis(outcome, follow_up, ...)` Prepare outcome data calculate IPCW-PP one step `$truncate(weight_cols, lower, upper, suffix)` Truncate extreme weights `$impute_confounders(confounder_vars, seed)` Impute missing confounders **Non-mutating (return data):** `$extract()` Return data.table `$weight_summary()` Print weight distribution diagnostics `$summary(pretty)` Return summary statistics `$table1(ipw_col)` Generate baseline characteristics table `$rates(weight_col)` Calculate events, person-years, rates `$irr(weight_col)` Fit Poisson models extract IRR `$km(ipw_col, save_path, title)` Fit Kaplan-Meier curves **Active bindings:** `$enrollment_stage` Derived lifecycle stage: `\"pre_enrollment\"`, `\"enrolled\"`, `\"analysis_ready\"`","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"data data.table trial data. design TTEDesign R6 object. data_level Character, \"person_week\" \"trial\". steps_completed Character vector completed workflow steps. active_outcome Character NULL, current outcome IPCW-PP. weight_cols Character vector weight column names.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"active-bindings","dir":"Reference","previous_headings":"","what":"Active bindings","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"enrollment_stage Derived lifecycle stage (read-). Returns `\"pre_enrollment\"` `data_level == \"person_week\"`, `\"analysis_ready\"` `prepare_outcome` run, `\"enrolled\"` otherwise.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"TTEEnrollment$new() TTEEnrollment$print() TTEEnrollment$collapse() TTEEnrollment$ipw() TTEEnrollment$prepare_for_analysis() TTEEnrollment$truncate() TTEEnrollment$impute_confounders() TTEEnrollment$weight_summary() TTEEnrollment$extract() TTEEnrollment$summary() TTEEnrollment$table1() TTEEnrollment$rates() TTEEnrollment$irr() TTEEnrollment$km() TTEEnrollment$clone()","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Create new TTEEnrollment object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$new(   data,   design,   data_level = \"trial\",   steps_completed = character(),   active_outcome = NULL,   weight_cols = character(),   ratio = NULL,   seed = NULL,   extra_cols = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"data data.table containing trial data. design [TTEDesign] object specifying column mappings. data_level Character, either \"person_week\" pre-panel data \"trial\" post-panel data. Determines methods can applied. steps_completed Character vector completed workflow steps. active_outcome Character NULL, current outcome IPCW-PP analysis. weight_cols Character vector weight column names created. ratio Numeric NULL. provided, automatically enrolls participants (sampling comparison group creating trial panels). valid person_week data. seed Integer NULL. Random seed enrollment reproducibility. extra_cols Character vector NULL. Extra columns include trial panels enrollment.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Print TTEEnrollment object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$print(...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-collapse-","dir":"Reference","previous_headings":"","what":"Method collapse()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Collapse time intervals coarser periods. Wraps [tte_collapse_periods()].","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$collapse(   period_width = 4L,   time_var = NULL,   first_cols = NULL,   last_cols = NULL,   max_cols = NULL,   sum_cols = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"period_width Integer, default 4. time_var Character NULL; defaults \"trial_week\" present. first_cols Character vector additional first-aggregation columns. last_cols Character vector additional last-aggregation columns. max_cols Character vector additional max-aggregation columns. sum_cols Character vector additional sum-aggregation columns.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-ipw-","dir":"Reference","previous_headings":"","what":"Method ipw()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Calculate inverse probability treatment weights. Wraps [tte_calculate_ipw()].","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$ipw(stabilize = TRUE)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"stabilize Logical, default TRUE.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-prepare-for-analysis-","dir":"Reference","previous_headings":"","what":"Method prepare_for_analysis()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Prepare outcome data calculate IPCW-PP one step. Calls `$prepare_outcome()` followed `$ipcw_pp()`. recommended way prepare enrollment analysis.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$prepare_for_analysis(   outcome,   follow_up = NULL,   estimate_ipcw_pp_separately_by_exposure = TRUE,   estimate_ipcw_pp_with_gam = TRUE,   censoring_var = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"outcome Character scalar. Must one `design$outcome_vars`. follow_up Optional integer. Overrides `design$follow_up_time`. estimate_ipcw_pp_separately_by_exposure Logical, default TRUE. estimate_ipcw_pp_with_gam Logical, default TRUE. censoring_var Character NULL. Defaults `\"censor_this_period\"`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-truncate-","dir":"Reference","previous_headings":"","what":"Method truncate()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Truncate extreme weights. Wraps [tte_truncate_weights()].","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$truncate(   weight_cols = NULL,   lower = 0.01,   upper = 0.99,   suffix = \"_trunc\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"weight_cols Character vector NULL. lower Numeric, default 0.01. upper Numeric, default 0.99. suffix Character, default \"_trunc\".","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-impute-confounders-","dir":"Reference","previous_headings":"","what":"Method impute_confounders()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Impute missing confounders sampling observed values.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$impute_confounders(confounder_vars, seed = 4L)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"confounder_vars Character vector confounder column names impute. seed Integer seed reproducibility (default: 4L).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-weight-summary-","dir":"Reference","previous_headings":"","what":"Method weight_summary()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Print weight distribution diagnostics.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$weight_summary()"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-extract-","dir":"Reference","previous_headings":"","what":"Method extract()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Extract data.table trial object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$extract()"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"data.table processed trial data.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-summary-","dir":"Reference","previous_headings":"","what":"Method summary()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Summarize trial data statistics.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$summary(pretty = FALSE)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"pretty Logical, default FALSE. TRUE, prints formatted output.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"`pretty = FALSE`, list summary stats. TRUE, prints   formatted output invisibly returns list.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-table-","dir":"Reference","previous_headings":"","what":"Method table1()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Generate baseline characteristics table. Wraps [tableone::CreateTableOne()] [tableone::svyCreateTableOne()].","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$table1(ipw_col = NULL)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"ipw_col Character NULL. specified, creates weighted table.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"tableone object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-rates-","dir":"Reference","previous_headings":"","what":"Method rates()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Calculate events, person-years, rates exposure group.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$rates(weight_col)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"weight_col Character, required. Column name weights.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"data.table events, person-years, rates.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-irr-","dir":"Reference","previous_headings":"","what":"Method irr()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Fit Poisson models extract incidence rate ratios.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-12","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$irr(weight_col)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-9","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"weight_col Character, required. Column name weights.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"data.table IRR estimates confidence intervals.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-km-","dir":"Reference","previous_headings":"","what":"Method km()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"Fit Kaplan-Meier curves optionally plot. Uses IPW (IPCW) IPCW time-varying.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-13","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$km(ipw_col, save_path = NULL, title = NULL)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-10","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"ipw_col Character, required. Column name IPW weights. save_path Character NULL. specified, saves plot. title Character NULL. Plot title.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"svykm object (invisibly save_path specified).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"objects class cloneable method.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"usage-14","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"TTEEnrollment$clone(deep = FALSE)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"arguments-11","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"deep Whether make deep clone.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEEnrollment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"TTEEnrollment class for target trial emulation — TTEEnrollment","text":"","code":"if (FALSE) { # \\dontrun{ design <- tte_design(   person_id_var = \"id\",   exposure_var = \"exposed\",   outcome_vars = \"death\",   confounder_vars = c(\"age\", \"sex\"),   follow_up_time = 52L,   eligible_var = \"eligible\" )  # Enroll via constructor, then $-chain enrollment <- tte_enrollment(my_skeleton, design,   ratio = 2, seed = 4, extra_cols = \"isoyearweek\" ) enrollment$   collapse(period_width = 4)$   ipw()$   prepare_for_analysis(outcome = \"death\", estimate_ipcw_pp_with_gam = TRUE) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":null,"dir":"Reference","previous_headings":"","what":"TTEPlan class for trial generation planning — TTEPlan","title":"TTEPlan class for trial generation planning — TTEPlan","text":"TTEPlan class trial generation planning TTEPlan class trial generation planning","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Bundles ETT grid, skeleton file paths, design column names single object using builder pattern. Create empty plan [tte_plan()], add ETTs one time `$add_one_ett()`. Supports `plan[[]]` extract -th enrollment spec interactive testing. Design parameters (confounder_vars, person_id_var, exposure_var, etc.) stored per-ETT `ett` data.table, allowing different ETTs use different confounders design columns. Within enrollment_id (follow_up + age_group), design params must match.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"computed-properties","dir":"Reference","previous_headings":"","what":"Computed properties","title":"TTEPlan class for trial generation planning — TTEPlan","text":"max_follow_up (read-) maximum `follow_up` across ETTs.     Used `$enrollment_spec()` set `design$follow_up_time`     enrollment covers longest follow-per enrollment group.     Returns `NA` ETTs added.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"methods","dir":"Reference","previous_headings":"","what":"Methods","title":"TTEPlan class for trial generation planning — TTEPlan","text":"`$add_one_ett(...)` Add one ETT row plan. Returns `invisible(self)`. `$save(dir)` Save plan disk `.qs2`. Returns `invisible(path)`. `$enrollment_spec()` Extract -th enrollment spec list design, age_range, etc. `$generate_enrollments_and_ipw(...)` Run Loop 1: skeleton files trial panels + IPW. `$generate_analysis_files_and_ipcw_pp(...)` Run Loop 2: per-ETT IPCW-PP + analysis file generation.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"TTEPlan class for trial generation planning — TTEPlan","text":"project_prefix Character, string used file naming. ett NULL data.table per-ETT columns. skeleton_files Character vector skeleton file paths. global_max_isoyearweek Admin censoring boundary. spec Parsed study spec ([tte_read_spec()]), NULL.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"active-bindings","dir":"Reference","previous_headings":"","what":"Active bindings","title":"TTEPlan class for trial generation planning — TTEPlan","text":"max_follow_up (read-) Maximum follow_up across ETTs.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"TTEPlan class for trial generation planning — TTEPlan","text":"TTEPlan$new() TTEPlan$print() TTEPlan$add_one_ett() TTEPlan$save() TTEPlan$enrollment_spec() TTEPlan$generate_enrollments_and_ipw() TTEPlan$generate_analysis_files_and_ipcw_pp() TTEPlan$clone()","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Create new TTEPlan object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEPlan class for trial generation planning — TTEPlan","text":"","code":"TTEPlan$new(project_prefix, skeleton_files, global_max_isoyearweek, ett = NULL)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEPlan class for trial generation planning — TTEPlan","text":"project_prefix Character, string used file naming. skeleton_files Character vector skeleton file paths. global_max_isoyearweek Administrative censoring boundary (isoyearweek string). ett NULL data.table per-ETT columns including design params.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Print TTEPlan object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEPlan class for trial generation planning — TTEPlan","text":"","code":"TTEPlan$print(...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"method-add-one-ett-","dir":"Reference","previous_headings":"","what":"Method add_one_ett()","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Add one ETT plan. ETT represents one outcome x follow_up x age_group combination. ETTs `enrollment_id` share trial panels must matching design parameters.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEPlan class for trial generation planning — TTEPlan","text":"","code":"TTEPlan$add_one_ett(   enrollment_id,   outcome_var,   outcome_name,   follow_up,   confounder_vars,   time_exposure_var,   eligible_var,   argset = list() )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEPlan class for trial generation planning — TTEPlan","text":"enrollment_id Character, enrollment group identifier (e.g., \"01\"). outcome_var Character, name outcome column. outcome_name Character, human-readable outcome name. follow_up Integer, follow-duration weeks. confounder_vars Character vector confounder column names. time_exposure_var Character NULL, time-varying exposure column. eligible_var Character NULL, eligibility column. argset Named list age_group, age_min, age_max (optional person_id_var).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"method-save-","dir":"Reference","previous_headings":"","what":"Method save()","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Save plan disk. File named `project_prefix_plan.qs2` inside `dir`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEPlan class for trial generation planning — TTEPlan","text":"","code":"TTEPlan$save(dir)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEPlan class for trial generation planning — TTEPlan","text":"dir Directory save .","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Invisibly returns file path.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"method-enrollment-spec-","dir":"Reference","previous_headings":"","what":"Method enrollment_spec()","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Extract enrollment spec -th enrollment_id group. Returns list design, enrollment_id, age_range, n_threads.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEPlan class for trial generation planning — TTEPlan","text":"","code":"TTEPlan$enrollment_spec(i = 1L)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Integer index (1-based).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"method-generate-enrollments-and-ipw-","dir":"Reference","previous_headings":"","what":"Method generate_enrollments_and_ipw()","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Loop 1: Create trial panels skeleton files compute IPW. enrollment_id, processes skeleton files parallel using callr::r_bg() subprocesses. Combines, collapses, optionally imputes, computes IPW + truncation, saves raw + imp files.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEPlan class for trial generation planning — TTEPlan","text":"","code":"TTEPlan$generate_enrollments_and_ipw(   process_fn = NULL,   output_dir,   period_width = 4L,   impute_fn = tte_impute_confounders,   stabilize = TRUE,   n_workers = 3L,   swereg_dev_path = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEPlan class for trial generation planning — TTEPlan","text":"process_fn Callback signature `function(enrollment_spec, file_path)`, NULL. NULL, uses built-spec-driven callback (requires `self$spec` set, e.g., via [tte_plan_from_spec_and_skeleton_meta()]). output_dir Directory output files. period_width Integer, collapse period width (default: 4L). impute_fn Imputation callback NULL (default: [tte_impute_confounders]). stabilize Logical, stabilize IPW (default: TRUE). n_workers Integer, concurrent subprocesses (default: 3L). swereg_dev_path Path local swereg dev copy, NULL.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"method-generate-analysis-files-and-ipcw-pp-","dir":"Reference","previous_headings":"","what":"Method generate_analysis_files_and_ipcw_pp()","title":"TTEPlan class for trial generation planning — TTEPlan","text":"Loop 2: Per-ETT IPCW-PP calculation analysis file generation. ETT, loads imputed enrollment file, calls `$prepare_for_analysis()` (outcome + IPCW-PP + weight combination + truncation), saves analysis-ready file.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEPlan class for trial generation planning — TTEPlan","text":"","code":"TTEPlan$generate_analysis_files_and_ipcw_pp(   output_dir,   estimate_ipcw_pp_separately_by_exposure = TRUE,   estimate_ipcw_pp_with_gam = TRUE,   n_workers = 1L,   swereg_dev_path = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEPlan class for trial generation planning — TTEPlan","text":"output_dir Directory containing imp files analysis files saved. estimate_ipcw_pp_separately_by_exposure Logical, estimate IPCW-PP separately exposure group (default: TRUE). estimate_ipcw_pp_with_gam Logical, use GAM IPCW-PP estimation (default: TRUE). n_workers Integer, concurrent subprocesses (default: 1L). swereg_dev_path Path local swereg dev copy, NULL.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"TTEPlan class for trial generation planning — TTEPlan","text":"objects class cloneable method.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"TTEPlan class for trial generation planning — TTEPlan","text":"","code":"TTEPlan$clone(deep = FALSE)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"TTEPlan class for trial generation planning — TTEPlan","text":"deep Whether make deep clone.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/TTEPlan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"TTEPlan class for trial generation planning — TTEPlan","text":"","code":"if (FALSE) { # \\dontrun{ plan <- tte_plan(   project_prefix = \"project002\",   skeleton_files = skeleton_files,   global_max_isoyearweek = \"2023-52\" ) plan$add_one_ett(   outcome_var = \"death\",   outcome_name = \"Death\",   follow_up = 52,   confounder_vars = c(\"age\", \"education\"),   time_exposure_var = \"rd_exposed\",   eligible_var = \"eligible\",   argset = list(age_group = \"50_60\", age_min = 50, age_max = 60) )  # Extract first enrollment spec for interactive testing enrollment_spec <- plan[[1]] enrollment_spec$design enrollment_spec$age_range } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_annual.html","id":null,"dir":"Reference","previous_headings":"","what":"Add annual data to skeleton — add_annual","title":"Add annual data to skeleton — add_annual","text":"Merges annual data main skeleton data structure specific ISO year. function used adding data measured recorded annually, yearly income, employment status, annual health assessments.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_annual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add annual data to skeleton — add_annual","text":"","code":"add_annual(skeleton, data, id_name, isoyear)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_annual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add annual data to skeleton — add_annual","text":"skeleton data.table containing main skeleton structure id time variables data data.table containing annual data merged id_name Character string specifying name ID variable data isoyear Integer specifying ISO year data applies","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_annual.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add annual data to skeleton — add_annual","text":"skeleton data.table modified reference annual data merged .   Columns data already exist skeleton prefixed \".\"","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_annual.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add annual data to skeleton — add_annual","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\") data(\"fake_annual_family\", package = \"swereg\") swereg::make_lowercase_names(fake_annual_family)  # Create skeleton skeleton <- create_skeleton(fake_person_ids[1:5], \"2020-01-01\", \"2022-12-31\")  # Add annual family data for 2021 add_annual(skeleton, fake_annual_family, \"lopnr\", 2021) #>          id isoyear isoyearweek is_isoyear isoyearweeksun personyears famtyp #>       <int>   <int>      <char>     <lgcl>         <Date>       <num> <char> #>    1:     1    1900     1900-**       TRUE     1900-07-01  1.00000000   <NA> #>    2:     1    1901     1901-**       TRUE     1901-06-30  1.00000000   <NA> #>    3:     1    1902     1902-**       TRUE     1902-06-29  1.00000000   <NA> #>    4:     1    1903     1903-**       TRUE     1903-06-28  1.00000000   <NA> #>    5:     1    1904     1904-**       TRUE     1904-07-03  1.00000000   <NA> #>   ---                                                                        #> 1386:     5    2022     2022-48      FALSE     2022-12-04  0.01913876   <NA> #> 1387:     5    2022     2022-49      FALSE     2022-12-11  0.01913876   <NA> #> 1388:     5    2022     2022-50      FALSE     2022-12-18  0.01913876   <NA> #> 1389:     5    2022     2022-51      FALSE     2022-12-25  0.01913876   <NA> #> 1390:     5    2022     2022-52      FALSE     2023-01-01  0.01913876   <NA>  # Check data was added only for 2021 skeleton[isoyear == 2021 & is_isoyear == TRUE, .(id, isoyear, famtyp)] #> Empty data.table (0 rows and 3 cols): id,isoyear,famtyp"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_cods.html","id":null,"dir":"Reference","previous_headings":"","what":"Add cause of death data to skeleton — add_cods","title":"Add cause of death data to skeleton — add_cods","text":"Searches specific ICD-10 cause death codes Swedish death registry data adds corresponding boolean variables skeleton. Can search underlying cause death, multiple causes, .","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_cods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add cause of death data to skeleton — add_cods","text":"","code":"add_cods(   skeleton,   dataset,   id_name,   cod_type = \"both\",   cods = list(icd10_F64_0 = c(\"F640\"), icd10_F64_89 = c(\"F6489\"), icd10_F64_089 =     c(\"F640\", \"F648\", \"F649\")) )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_cods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add cause of death data to skeleton — add_cods","text":"skeleton data.table containing main skeleton structure created create_skeleton dataset data.table containing death registry data cause death codes. Must columns person ID, death date (dodsdat), cause codes (ulorsak, morsak variables) id_name Character string specifying name ID variable dataset cod_type Character string specifying cause types search: \"\" (default) - Search underlying (ulorsak) multiple (morsak) causes \"underlying\" - Search underlying cause death (ulorsak) \"multiple\" - Search multiple/contributing causes (morsak variables) cods Named list ICD-10 code patterns search . Names become variable names skeleton. Patterns include \"^\" prefix (automatically added). Use exclusions \"!\" prefix. Example: list(\"cardiovascular_death\" = c(\"I21\", \"I22\"), \"external_causes\" = c(\"X60\", \"X70\"))","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_cods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add cause of death data to skeleton — add_cods","text":"skeleton data.table modified reference cause death variables added.   New boolean variables created cause pattern, TRUE cause present.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_cods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add cause of death data to skeleton — add_cods","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\") data(\"fake_cod\", package = \"swereg\") swereg::make_lowercase_names(fake_cod, date_columns = \"dodsdat\")  # Create skeleton skeleton <- create_skeleton(fake_person_ids[1:10], \"2020-01-01\", \"2020-12-31\")  # Add cause of death data cod_patterns <- list(   \"cardiovascular_death\" = c(\"I21\", \"I22\"),   \"external_causes\" = c(\"X60\", \"X70\") ) add_cods(skeleton, fake_cod, \"lopnr\", \"both\", cod_patterns)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_diagnoses.html","id":null,"dir":"Reference","previous_headings":"","what":"Add diagnosis data to skeleton — add_diagnoses","title":"Add diagnosis data to skeleton — add_diagnoses","text":"Searches specific ICD diagnosis codes Swedish hospital registry data adds corresponding boolean variables skeleton. Can search main diagnoses main secondary diagnoses.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_diagnoses.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add diagnosis data to skeleton — add_diagnoses","text":"","code":"add_diagnoses(   skeleton,   dataset,   id_name,   diag_type = \"both\",   diags = list(icd10_F64_0 = c(\"F640\"), icd10_F64_89 = c(\"F6489\"), icd10_F64_089 =     c(\"F640\", \"F648\", \"F649\")) )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_diagnoses.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add diagnosis data to skeleton — add_diagnoses","text":"skeleton data.table containing main skeleton structure created create_skeleton dataset data.table containing hospital registry data diagnosis codes. Must columns person ID, admission date (indatum), least one diagnosis code column. Expected diagnosis columns make_lowercase_names(): hdia (main), dia1/dia2/etc (secondary), ekod1/ekod2/etc (external causes), icd7*, icd9* id_name Character string specifying name ID variable dataset diag_type Character string specifying diagnosis types search: \"\" (default) - Search main (hdia), secondary (dia*),     external cause (ekod*), historical ICD version columns (icd7*, icd9*) \"main\" - Search main diagnosis column (hdia) diags Named list ICD code patterns search . Names become variable names skeleton. Patterns include \"^\" prefix (automatically added). Use exclusions \"!\" prefix. Example: list(\"depression\" = c(\"F32\", \"F33\"), \"anxiety\" = c(\"F40\", \"F41\"))","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_diagnoses.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add diagnosis data to skeleton — add_diagnoses","text":"skeleton data.table modified reference diagnosis variables added.   New boolean variables created diagnosis pattern, TRUE diagnosis present.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_diagnoses.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add diagnosis data to skeleton — add_diagnoses","text":"function searches across different diagnosis code column types based diag_type parameter: diag_type = \"\": Searches hdia (main diagnosis),     dia1, dia2, ... (secondary diagnoses), ekod1, ekod2, ...     (external cause codes), icd7* (ICD-7 codes), icd9* (ICD-9 codes) diag_type = \"main\": Searches hdia (main diagnosis) ## Filtering source (inpatient/outpatient/cancer) diagnosis dataset must contain source column valid values (\"inpatient\", \"outpatient\", \"cancer\"). track diagnoses separately source, filter dataset calling function:","code":"# Inpatient diagnoses only inpatient_data <- diagnoses[source == \"inpatient\"] add_diagnoses(skeleton, inpatient_data, \"lopnr\", diags = list(   \"depression_inpatient\" = c(\"F32\", \"F33\") ))  # Outpatient diagnoses only outpatient_data <- diagnoses[source == \"outpatient\"] add_diagnoses(skeleton, outpatient_data, \"lopnr\", diags = list(   \"depression_outpatient\" = c(\"F32\", \"F33\") ))  # Combined (any source) - default behavior add_diagnoses(skeleton, diagnoses, \"lopnr\", diags = list(   \"depression_any\" = c(\"F32\", \"F33\") ))"},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_diagnoses.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add diagnosis data to skeleton — add_diagnoses","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\") data(\"fake_diagnoses\", package = \"swereg\") swereg::make_lowercase_names(fake_diagnoses, date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing.  # Create skeleton skeleton <- create_skeleton(fake_person_ids[1:10], \"2020-01-01\", \"2020-12-31\")  # Add diagnoses diag_patterns <- list(   \"depression\" = c(\"F32\", \"F33\"),   \"anxiety\" = c(\"F40\", \"F41\") ) add_diagnoses(skeleton, fake_diagnoses, \"lopnr\", \"both\", diag_patterns)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_icdo3s.html","id":null,"dir":"Reference","previous_headings":"","what":"Add ICD-O-3 oncology codes to skeleton — add_icdo3s","title":"Add ICD-O-3 oncology codes to skeleton — add_icdo3s","text":"Searches specific ICD-O-3 (International Classification Diseases Oncology, 3rd edition) codes Swedish cancer registry data adds corresponding boolean variables skeleton. ICD-O-3 used classify malignant neoplasms (cancers) histological type (morphology) anatomical site (topography).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_icdo3s.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add ICD-O-3 oncology codes to skeleton — add_icdo3s","text":"","code":"add_icdo3s(skeleton, dataset, id_name, icdo3s = list())"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_icdo3s.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add ICD-O-3 oncology codes to skeleton — add_icdo3s","text":"skeleton data.table containing main skeleton structure created create_skeleton dataset data.table containing cancer registry data ICD-O-3 codes. Must columns person ID, date variables, ICD-O-3 code column (icdo3) id_name Character string specifying name ID variable dataset icdo3s Named list ICD-O-3 code patterns search . Names become variable names skeleton. ICD-O-3 codes combine morphology (4 digits + behavior code) topography (C codes). Examples pattern matching: \"^8140\" - Adenocarcinoma, NOS (morphology code) \"^C50\" - Breast cancer (topography code) \"8500/3\" - Infiltrating duct carcinoma (morphology behavior)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_icdo3s.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add ICD-O-3 oncology codes to skeleton — add_icdo3s","text":"skeleton data.table modified reference ICD-O-3 variables added.   New boolean variables created ICD-O-3 pattern, TRUE code present.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_icdo3s.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add ICD-O-3 oncology codes to skeleton — add_icdo3s","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\") data(\"fake_diagnoses\", package = \"swereg\") swereg::make_lowercase_names(fake_diagnoses, date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing.  # Create skeleton skeleton <- create_skeleton(fake_person_ids[1:10], \"2020-01-01\", \"2020-12-31\")  # Add ICD-O-3 codes for specific cancer types cancer_codes <- list(   \"adenocarcinoma\" = c(\"^8140\"),   \"breast_cancer\" = c(\"^C50\") ) add_icdo3s(skeleton, fake_diagnoses, \"lopnr\", cancer_codes)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_onetime.html","id":null,"dir":"Reference","previous_headings":"","what":"Add one-time data to skeleton — add_onetime","title":"Add one-time data to skeleton — add_onetime","text":"Merges one-time data (non-longitudinal) main skeleton data structure. function used adding data change time, demographic information baseline characteristics.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_onetime.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add one-time data to skeleton — add_onetime","text":"","code":"add_onetime(skeleton, data, id_name)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_onetime.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add one-time data to skeleton — add_onetime","text":"skeleton data.table containing main skeleton structure id time variables data data.table containing one-time data merged id_name Character string specifying name ID variable data","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_onetime.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add one-time data to skeleton — add_onetime","text":"skeleton data.table modified reference one-time data merged .   Columns data already exist skeleton prefixed \".\"","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_onetime.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add one-time data to skeleton — add_onetime","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\") data(\"fake_demographics\", package = \"swereg\") swereg::make_lowercase_names(fake_demographics) #> Found potential date columns: fodelseman. Consider adding them to date_columns parameter for automatic date parsing.  # Create skeleton skeleton <- create_skeleton(fake_person_ids[1:5], \"2020-01-01\", \"2020-12-31\")  # Add demographic data add_onetime(skeleton, fake_demographics, \"lopnr\") #>         id isoyear isoyearweek is_isoyear isoyearweeksun personyears fodelseman #>      <int>   <int>      <char>     <lgcl>         <Date>       <num>     <char> #>   1:     1    1900     1900-**       TRUE     1900-07-01  1.00000000       1959 #>   2:     1    1901     1901-**       TRUE     1901-06-30  1.00000000       1959 #>   3:     1    1902     1902-**       TRUE     1902-06-29  1.00000000       1959 #>   4:     1    1903     1903-**       TRUE     1903-06-28  1.00000000       1959 #>   5:     1    1904     1904-**       TRUE     1904-07-03  1.00000000       1959 #>  ---                                                                            #> 866:     5    2020     2020-49      FALSE     2020-12-06  0.01913876       1954 #> 867:     5    2020     2020-50      FALSE     2020-12-13  0.01913876       1954 #> 868:     5    2020     2020-51      FALSE     2020-12-20  0.01913876       1954 #> 869:     5    2020     2020-52      FALSE     2020-12-27  0.01913876       1954 #> 870:     5    2020     2020-53      FALSE     2021-01-03  0.01913876       1954 #>      doddatum #>        <char> #>   1:          #>   2:          #>   3:          #>   4:          #>   5:          #>  ---          #> 866:          #> 867:          #> 868:          #> 869:          #> 870:           # Check added variables names(skeleton) #> [1] \"id\"             \"isoyear\"        \"isoyearweek\"    \"is_isoyear\"     #> [5] \"isoyearweeksun\" \"personyears\"    \"fodelseman\"     \"doddatum\""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_operations.html","id":null,"dir":"Reference","previous_headings":"","what":"Add surgical operation data to skeleton — add_operations","title":"Add surgical operation data to skeleton — add_operations","text":"Searches specific surgical operation codes Swedish hospital registry data adds corresponding boolean variables skeleton. Includes predefined operation codes relevant gender-affirming procedures.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_operations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add surgical operation data to skeleton — add_operations","text":"","code":"add_operations(   skeleton,   dataset,   id_name,   ops = list(op_afab_mastectomy = c(\"HAC10\", \"HAC20\", \"HAC99\", \"HAC15\"),     op_afab_breast_reconst_and_other_breast_ops = c(\"HAD20\", \"HAD30\", \"HAD35\", \"HAD99\",     \"HAE99\"), op_afab_penis_test_prosth = c(\"KFH50\", \"KGV30\", \"KGW96\", \"KGH96\"),     op_afab_internal_genital = c(\"LCD00\", \"LCD01\", \"LCD04\", \"LCD10\", \"LCD11\", \"LCD96\",     \"LCD97\"), op_afab_colpectomy = c(\"LED00\"),     op_amab_breast_reconst_and_other_breast_ops = c(\"HAD00\", \"HAD10\", \"HAD99\", \"HAE00\",     \"HAE20\", \"HAE99\"), op_amab_reconst_vag = c(\"LEE10\", \"LEE40\", \"LEE96\",       \"LFE10\",     \"LFE96\"), op_amab_penis_amp = c(\"KGC10\"), op_amab_larynx = c(\"DQD40\")) )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_operations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add surgical operation data to skeleton — add_operations","text":"skeleton data.table containing main skeleton structure created create_skeleton dataset data.table containing hospital registry data operation codes. Must columns person ID, date variables, operation codes (op1, op2, etc.) id_name Character string specifying name ID variable dataset ops Named list operation code patterns search . Names become variable names skeleton. Default includes comprehensive gender-affirming surgery codes: Mastectomy procedures (HAC10, HAC20, etc.) Breast reconstruction (HAD20, HAD30, etc.) Genital operations (various KFH, KGV, LCD, LED, LEE codes) Larynx operations (DQD40)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_operations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add surgical operation data to skeleton — add_operations","text":"skeleton data.table modified reference operation variables added.   New boolean variables created operation pattern, TRUE operation present.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_operations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add surgical operation data to skeleton — add_operations","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\") data(\"fake_diagnoses\", package = \"swereg\") swereg::make_lowercase_names(fake_diagnoses, date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing.  # Create skeleton skeleton <- create_skeleton(fake_person_ids[1:10], \"2020-01-01\", \"2020-12-31\")  # Add operations (using default gender-affirming surgery codes) add_operations(skeleton, fake_diagnoses, \"lopnr\")  # Or specify custom operation codes custom_ops <- list(\"mastectomy\" = c(\"HAC10\", \"HAC20\")) add_operations(skeleton, fake_diagnoses, \"lopnr\", custom_ops)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_rx.html","id":null,"dir":"Reference","previous_headings":"","what":"Add prescription drug data to skeleton — add_rx","title":"Add prescription drug data to skeleton — add_rx","text":"Searches specific drug codes (ATC product names) Swedish prescription registry data adds corresponding boolean variables skeleton based prescription periods duration treatment.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_rx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add prescription drug data to skeleton — add_rx","text":"","code":"add_rx(   skeleton,   lmed,   id_name = \"lopnr\",   rxs = list(rx_hormones_pubblock = c(\"L02AE\", \"H01CA\")),   source = \"atc\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_rx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add prescription drug data to skeleton — add_rx","text":"skeleton data.table containing main skeleton structure created create_skeleton lmed data.table containing prescription registry data (LMED). Must columns person ID, prescription date (edatum), treatment duration (fddd), drug codes (atc) product names (produkt) id_name Character string specifying name ID variable (default: \"lopnr\") rxs Named list drug code patterns search . Names become variable names skeleton. Default includes hormone therapy codes puberty blockers (L02AE, H01CA). Common patterns include: Antidepressants: \"N06A\" Hormone therapy: \"G03\", \"L02AE\", \"H01CA\" Cardiovascular drugs: \"C07\", \"C08\", \"C09\" source Character string specifying search field matching strategy: \"atc\" (default) - Prefix matching ATC codes (e.g., \"N06A\" matches \"N06AB06\").     Uses startsWith() fast C-level matching. \"produkt\" - Exact matching product names (e.g., \"Delestrogen\" matches     \"Delestrogen\", \"Delestrogen Extra\"). Uses %chin% fast lookup.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_rx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add prescription drug data to skeleton — add_rx","text":"skeleton data.table modified reference prescription variables added.   Variables TRUE periods prescription active based start/stop dates   calculated prescription date + treatment duration","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_rx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add prescription drug data to skeleton — add_rx","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\") data(\"fake_prescriptions\", package = \"swereg\") swereg::make_lowercase_names(fake_prescriptions, date_columns = \"edatum\")  # Create skeleton skeleton <- create_skeleton(fake_person_ids[1:10], \"2020-01-01\", \"2020-12-31\")  # Add prescription data rx_patterns <- list(   \"antidepressants\" = c(\"N06A\"),   \"hormones\" = c(\"G03\", \"L02AE\") ) add_rx(skeleton, fake_prescriptions, \"p444_lopnr_personnr\", rx_patterns, \"atc\")"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomed3s.html","id":null,"dir":"Reference","previous_headings":"","what":"Add SNOMED-CT version 3 codes to skeleton — add_snomed3s","title":"Add SNOMED-CT version 3 codes to skeleton — add_snomed3s","text":"Searches specific SNOMED-CT (Systematized Nomenclature Medicine - Clinical Terms) version 3 codes Swedish hospital registry data adds corresponding boolean variables skeleton. SNOMED-CT v3 provides standardized clinical terminology procedures, findings, diagnoses used Swedish healthcare records.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomed3s.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add SNOMED-CT version 3 codes to skeleton — add_snomed3s","text":"","code":"add_snomed3s(skeleton, dataset, id_name, snomed3s = list())"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomed3s.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add SNOMED-CT version 3 codes to skeleton — add_snomed3s","text":"skeleton data.table containing main skeleton structure created create_skeleton dataset data.table containing hospital registry data SNOMED-CT v3 codes. Must columns person ID, date variables, SNOMED-CT v3 code column (snomed3) id_name Character string specifying name ID variable dataset snomed3s Named list SNOMED-CT v3 code patterns search . Names become variable names skeleton. SNOMED-CT codes hierarchical can matched using pattern matching. Examples pattern matching: \"^80146002\" - Appendectomy procedure \"^44054006\" - Diabetes mellitus type 2 Use regex patterns match code families hierarchies","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomed3s.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add SNOMED-CT version 3 codes to skeleton — add_snomed3s","text":"skeleton data.table modified reference SNOMED-CT v3 variables added.   New boolean variables created SNOMED-CT pattern, TRUE code present.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomed3s.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add SNOMED-CT version 3 codes to skeleton — add_snomed3s","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\") data(\"fake_diagnoses\", package = \"swereg\") swereg::make_lowercase_names(fake_diagnoses, date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing.  # Create skeleton skeleton <- create_skeleton(fake_person_ids[1:10], \"2020-01-01\", \"2020-12-31\")  # Add SNOMED-CT v3 codes for specific clinical concepts snomed_codes <- list(   \"appendectomy\" = c(\"^80146002\"),   \"diabetes_t2\" = c(\"^44054006\") ) add_snomed3s(skeleton, fake_diagnoses, \"lopnr\", snomed_codes)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomedo10s.html","id":null,"dir":"Reference","previous_headings":"","what":"Add SNOMED-CT version 10 codes to skeleton — add_snomedo10s","title":"Add SNOMED-CT version 10 codes to skeleton — add_snomedo10s","text":"Searches specific SNOMED-CT (Systematized Nomenclature Medicine - Clinical Terms) version 10 codes Swedish hospital registry data adds corresponding boolean variables skeleton. SNOMED-CT v10 provides standardized clinical terminology procedures, findings, diagnoses used Swedish healthcare records.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomedo10s.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add SNOMED-CT version 10 codes to skeleton — add_snomedo10s","text":"","code":"add_snomedo10s(skeleton, dataset, id_name, snomedo10s = list())"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomedo10s.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add SNOMED-CT version 10 codes to skeleton — add_snomedo10s","text":"skeleton data.table containing main skeleton structure created create_skeleton dataset data.table containing hospital registry data SNOMED-CT v10 codes. Must columns person ID, date variables, SNOMED-CT v10 code column (snomedo10) id_name Character string specifying name ID variable dataset snomedo10s Named list SNOMED-CT v10 code patterns search . Names become variable names skeleton. SNOMED-CT codes hierarchical can matched using pattern matching. Examples pattern matching: \"^80146002\" - Appendectomy procedure \"^44054006\" - Diabetes mellitus type 2 Use regex patterns match code families hierarchies","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomedo10s.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add SNOMED-CT version 10 codes to skeleton — add_snomedo10s","text":"skeleton data.table modified reference SNOMED-CT v10 variables added.   New boolean variables created SNOMED-CT pattern, TRUE code present.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/add_snomedo10s.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add SNOMED-CT version 10 codes to skeleton — add_snomedo10s","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\") data(\"fake_diagnoses\", package = \"swereg\") swereg::make_lowercase_names(fake_diagnoses, date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing.  # Create skeleton skeleton <- create_skeleton(fake_person_ids[1:10], \"2020-01-01\", \"2020-12-31\")  # Add SNOMED-CT v10 codes for specific clinical concepts snomed_codes <- list(   \"appendectomy\" = c(\"^80146002\"),   \"diabetes_t2\" = c(\"^44054006\") ) add_snomedo10s(skeleton, fake_diagnoses, \"lopnr\", snomed_codes)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/any_events_prior_to.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for any TRUE values in a prior window — any_events_prior_to","title":"Check for any TRUE values in a prior window — any_events_prior_to","text":"Checks TRUE values exist preceding window, excluding current row. Useful determining event occurred prior time period.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/any_events_prior_to.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for any TRUE values in a prior window — any_events_prior_to","text":"","code":"any_events_prior_to(x, window_excluding_wk0 = 104L)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/any_events_prior_to.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for any TRUE values in a prior window — any_events_prior_to","text":"x Logical vector window_excluding_wk0 Number prior weeks check, excluding current week (default 104, ~2 years). Use large number (e.g., 99999) lifetime history.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/any_events_prior_to.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for any TRUE values in a prior window — any_events_prior_to","text":"Logical vector indicating TRUE prior window","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/any_events_prior_to.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check for any TRUE values in a prior window — any_events_prior_to","text":"infinite/large windows (>= 99999), uses O(n) cumsum approach. finite windows, uses O(n) data.table::frollsum. exclude current row (week 0).","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/as_logical_max_with_infinite_as_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert maximum to logical while treating infinite values as NA — as_logical_max_with_infinite_as_na","title":"Convert maximum to logical while treating infinite values as NA — as_logical_max_with_infinite_as_na","text":"Computes maximum value converts logical, treating infinite values NA. Useful aggregating boolean data.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/as_logical_max_with_infinite_as_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert maximum to logical while treating infinite values as NA — as_logical_max_with_infinite_as_na","text":"","code":"as_logical_max_with_infinite_as_na(x, na.rm = T)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/as_logical_max_with_infinite_as_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert maximum to logical while treating infinite values as NA — as_logical_max_with_infinite_as_na","text":"x Numeric vector na.rm Logical, whether remove NA values calculation (default: TRUE)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/as_logical_max_with_infinite_as_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert maximum to logical while treating infinite values as NA — as_logical_max_with_infinite_as_na","text":"Logical value (maximum converted logical) infinite values NA","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/as_logical_min_with_infinite_as_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert minimum to logical while treating infinite values as NA — as_logical_min_with_infinite_as_na","title":"Convert minimum to logical while treating infinite values as NA — as_logical_min_with_infinite_as_na","text":"Computes minimum value converts logical, treating infinite values NA. Useful aggregating boolean data.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/as_logical_min_with_infinite_as_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert minimum to logical while treating infinite values as NA — as_logical_min_with_infinite_as_na","text":"","code":"as_logical_min_with_infinite_as_na(x, na.rm = T)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/as_logical_min_with_infinite_as_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert minimum to logical while treating infinite values as NA — as_logical_min_with_infinite_as_na","text":"x Numeric vector na.rm Logical, whether remove NA values calculation (default: TRUE)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/as_logical_min_with_infinite_as_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert minimum to logical while treating infinite values as NA — as_logical_min_with_infinite_as_na","text":"Logical value (minimum converted logical) infinite values NA","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/create_skeleton.html","id":null,"dir":"Reference","previous_headings":"","what":"Create longitudinal data skeleton — create_skeleton","title":"Create longitudinal data skeleton — create_skeleton","text":"Creates longitudinal data skeleton individual IDs time periods (ISO years ISO year-weeks) Swedish registry data analysis. skeleton provides framework merging various registry datasets consistent time structure.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/create_skeleton.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create longitudinal data skeleton — create_skeleton","text":"","code":"create_skeleton(ids, date_min, date_max)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/create_skeleton.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create longitudinal data skeleton — create_skeleton","text":"ids Vector individual IDs include skeleton date_min Date object specifying start date analysis period date_max Date object specifying end date analysis period","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/create_skeleton.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create longitudinal data skeleton — create_skeleton","text":"data.table skeleton columns: id: Individual identifier isoyear: ISO year (integer) isoyearweek: ISO year-week (character, format \"YYYY-WW\" \"YYYY-**\" annual rows) is_isoyear: Logical indicating row represents annual (TRUE) weekly (FALSE) data isoyearweeksun: Date representing Sunday (last day) ISO week/year personyears: Person-time contribution (1 annual rows, 1/52.25 weekly rows)","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/create_skeleton.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create longitudinal data skeleton — create_skeleton","text":"","code":"# Load fake data data(\"fake_person_ids\", package = \"swereg\")  # Create skeleton for 2020-2022 period skeleton <- create_skeleton(   ids = fake_person_ids[1:10],   date_min = as.Date(\"2020-01-01\"),   date_max = as.Date(\"2022-12-31\") ) utils::head(skeleton) #>       id isoyear isoyearweek is_isoyear isoyearweeksun personyears #>    <int>   <int>      <char>     <lgcl>         <Date>       <num> #> 1:     1    1900     1900-**       TRUE     1900-07-01           1 #> 2:     1    1901     1901-**       TRUE     1901-06-30           1 #> 3:     1    1902     1902-**       TRUE     1902-06-29           1 #> 4:     1    1903     1903-**       TRUE     1903-06-28           1 #> 5:     1    1904     1904-**       TRUE     1904-07-03           1 #> 6:     1    1905     1905-**       TRUE     1905-07-02           1  # Check structure utils::str(skeleton) #> Classes ‘data.table’ and 'data.frame':\t2780 obs. of  6 variables: #>  $ id            : int  1 1 1 1 1 1 1 1 1 1 ... #>  $ isoyear       : int  1900 1901 1902 1903 1904 1905 1906 1907 1908 1909 ... #>  $ isoyearweek   : chr  \"1900-**\" \"1901-**\" \"1902-**\" \"1903-**\" ... #>  $ is_isoyear    : logi  TRUE TRUE TRUE TRUE TRUE TRUE ... #>  $ isoyearweeksun: Date, format: \"1900-07-01\" \"1901-06-30\" ... #>  $ personyears   : num  1 1 1 1 1 1 1 1 1 1 ... #>  - attr(*, \".internal.selfref\")=<externalptr>"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Fake Swedish Registry Datasets — fake_data","title":"Fake Swedish Registry Datasets — fake_data","text":"datasets contain synthetic Swedish healthcare registry data development, testing, vignettes. mimic structure format real Swedish healthcare registries contain completely fabricated data.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fake Swedish Registry Datasets — fake_data","text":"","code":"fake_person_ids  fake_demographics  fake_annual_family  fake_diagnoses  fake_prescriptions  fake_cod"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Fake Swedish Registry Datasets — fake_data","text":"Various data structures matching real Swedish registries: object class integer length 1000. object class data.table (inherits data.frame) 1000 rows 3 columns. object class data.table (inherits data.frame) 1000 rows 2 columns. object class data.table (inherits data.frame) 5000 rows 49 columns. object class data.table (inherits data.frame) 8000 rows 37 columns. object class data.table (inherits data.frame) 50 rows 5 columns.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Fake Swedish Registry Datasets — fake_data","text":"Generated synthetic data based real Swedish healthcare registry structures","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fake Swedish Registry Datasets — fake_data","text":"datasets created dev/generate_fake_data.R contain: Key features: Personal identifiers numeric (e.g., 623334, 753064) Prescription data uses column name \"p444_lopnr_personnr\" ICD-10 codes include gender dysphoria (F64*), mental health (F20*, F32*, F40*), physical health codes ATC codes include hormone therapy (G03*), mental health medications (N05*, N06*) Date ranges span 1978-2021 depending registry Realistic missing data patterns SOURCE column fake_diagnoses tracks data origin Usage requirements: Always apply swereg::make_lowercase_names() loading data Use appropriate identifier column names (lopnr vs p444_lopnr_personnr) Follow Swedish registry conventions date formats Filter SOURCE column needed (e.g., SOURCE == \"cancer\" ICD-O-3)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"fake-person-ids","dir":"Reference","previous_headings":"","what":"fake_person_ids","title":"Fake Swedish Registry Datasets — fake_data","text":"numeric vector 1000 fake personal identifiers (lopnr). Used reference IDs across datasets.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"fake-demographics","dir":"Reference","previous_headings":"","what":"fake_demographics","title":"Fake Swedish Registry Datasets — fake_data","text":"Demographics data (SCB format) 1000 records: lopnr Personal identifier matching fake_person_ids fodelseman Birth year-month (YYYYMM format) DodDatum Death date (YYYYMMDD format) empty string","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"fake-annual-family","dir":"Reference","previous_headings":"","what":"fake_annual_family","title":"Fake Swedish Registry Datasets — fake_data","text":"Annual family status data (SCB format) 1000 records: LopNr Personal identifier (mixed case real data) FamTyp Family type code (2-digit character)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"fake-diagnoses","dir":"Reference","previous_headings":"","what":"fake_diagnoses","title":"Fake Swedish Registry Datasets — fake_data","text":"Combined diagnosis data ~5000 records three sources: SOURCE Data source: \"inpatient\", \"outpatient\", \"cancer\" LopNr Personal identifier AR Year care INDATUMA Admission date (YYYYMMDD character) INDATUM Admission date (Date class) UTDATUMA Discharge date (YYYYMMDD character, inpatient ) UTDATUM Discharge date (Date class, inpatient ) HDIA Main diagnosis (ICD-10 code) DIA1-DIA30 Additional diagnoses EKOD1-EKOD7 External cause codes OP Operation codes ICDO3 ICD-O-3 morphology codes (populated cancer source) SNOMED3 SNOMED-CT version 3 codes SNOMEDO10 SNOMED-CT version 10 codes SOURCE column identifies registry origin: \"inpatient\": NPR inpatient data (~2000 records) \"outpatient\": NPR outpatient data (~2000 records) \"cancer\": Cancer registry data (~1000 records, always ICDO3)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"fake-prescriptions","dir":"Reference","previous_headings":"","what":"fake_prescriptions","title":"Fake Swedish Registry Datasets — fake_data","text":"Prescription drug dispensing data (LMED format) ~8000 records: p444_lopnr_personnr Personal identifier p444 prefix Fall Case indicator Kontroll Control indicator VARUNR Product number ATC ATC classification code ALDER Age prescription LK Healthcare county code EDATUM End date FDATUM Start date OTYP Origin type ... Additional 27 columns matching real LMED structure","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"fake-cod","dir":"Reference","previous_headings":"","what":"fake_cod","title":"Fake Swedish Registry Datasets — fake_data","text":"Cause death data ~50 records (Swedish registry format): lopnr Personal identifier dodsdat Date death ulorsak Underlying cause death (ICD-10) - Swedish variable name morsak1 First multiple/contributory cause death morsak2 Second multiple/contributory cause death","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fake_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fake Swedish Registry Datasets — fake_data","text":"","code":"if (FALSE) { # \\dontrun{ # Load fake data data(\"fake_person_ids\") data(\"fake_demographics\") data(\"fake_diagnoses\")  # CRITICAL: Apply lowercase names swereg::make_lowercase_names(fake_demographics) swereg::make_lowercase_names(fake_diagnoses, date_columns = \"indatum\")  # Check source distribution table(fake_diagnoses$source)  # Filter by source inpatient_only <- fake_diagnoses[source == \"inpatient\"] cancer_only <- fake_diagnoses[source == \"cancer\"]  # Create skeleton with fake data skeleton <- create_skeleton(   ids = fake_person_ids[1:100],   date_min = \"2015-01-01\",   date_max = \"2020-12-31\" ) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/first_non_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Get first non-NA value from vector — first_non_na","title":"Get first non-NA value from vector — first_non_na","text":"Returns first non-missing value vector, useful data cleaning summarization tasks.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/first_non_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get first non-NA value from vector — first_non_na","text":"","code":"first_non_na(x)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/first_non_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get first non-NA value from vector — first_non_na","text":"x Vector type","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/first_non_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get first non-NA value from vector — first_non_na","text":"First non-NA value vector","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/first_non_na.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get first non-NA value from vector — first_non_na","text":"","code":"x <- c(NA, NA, 3, 4, 5) first_non_na(x)  # Returns 3 #> [1] 3 #> attr(,\"na.action\") #> [1] 1 2 #> attr(,\"class\") #> [1] \"omit\""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fread_raw.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a raw registry file with fread, then lowercase names — fread_raw","title":"Read a raw registry file with fread, then lowercase names — fread_raw","text":"Convenience wrapper around data.table::fread() followed make_lowercase_names().","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fread_raw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a raw registry file with fread, then lowercase names — fread_raw","text":"","code":"fread_raw(file, ..., date_columns = NULL, verbose = FALSE)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fread_raw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a raw registry file with fread, then lowercase names — fread_raw","text":"file Path file (passed data.table::fread()). ... Extra arguments forwarded data.table::fread() (e.g. encoding, select). date_columns Passed make_lowercase_names(). verbose TRUE, prints timestamped message file path.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/fread_raw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a raw registry file with fread, then lowercase names — fread_raw","text":"data.table lowercase column names.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/last_non_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Get last non-NA value from vector — last_non_na","title":"Get last non-NA value from vector — last_non_na","text":"Returns last non-missing value vector, useful data cleaning summarization tasks.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/last_non_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get last non-NA value from vector — last_non_na","text":"","code":"last_non_na(x)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/last_non_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get last non-NA value from vector — last_non_na","text":"x Vector type","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/last_non_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get last non-NA value from vector — last_non_na","text":"Last non-NA value vector","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/last_non_na.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get last non-NA value from vector — last_non_na","text":"","code":"x <- c(1, 2, 3, NA, NA) last_non_na(x)  # Returns 3 #> [1] 3 #> attr(,\"na.action\") #> [1] 4 5 #> attr(,\"class\") #> [1] \"omit\""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_lowercase_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert column names to lowercase and optionally clean date columns — make_lowercase_names","title":"Convert column names to lowercase and optionally clean date columns — make_lowercase_names","text":"Generic function convert column names object lowercase. Optionally parses cleans specified date columns using Swedish registry date format handling. Methods provided data.table default objects.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_lowercase_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert column names to lowercase and optionally clean date columns — make_lowercase_names","text":"","code":"make_lowercase_names(x, date_columns = NULL, ...)  # Default S3 method make_lowercase_names(x, date_columns = NULL, ...)  # S3 method for class 'data.table' make_lowercase_names(x, date_columns = NULL, ...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_lowercase_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert column names to lowercase and optionally clean date columns — make_lowercase_names","text":"x object named columns (data.frame, data.table, etc.) date_columns Character vector specifying names date columns clean. use lowercase names since column names converted lowercase first. uppercase names provided, warning issued lowercase versions used. provided, columns parsed using Swedish date format handling converted Date class place (keeping original column names). NULL, function suggest commonly found Swedish registry date columns. ... Additional arguments date parsing (default_month_day, default_day, na_strings)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_lowercase_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert column names to lowercase and optionally clean date columns — make_lowercase_names","text":"object column names converted lowercase, optionally   cleaned date columns date_columns specified (converted Date class place)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_lowercase_names.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert column names to lowercase and optionally clean date columns — make_lowercase_names","text":"function automatically detects common Swedish registry date columns (indatum, utdatum, edatum, dodsdat, fodelseman) provides helpful messages suggesting inclusion date_columns parameter.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_lowercase_names.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert column names to lowercase and optionally clean date columns — make_lowercase_names","text":"","code":"# Load fake data data(\"fake_demographics\", package = \"swereg\")  # Basic usage - convert column names to lowercase # This will show a message suggesting to include 'fodelseman' in date_columns swereg::make_lowercase_names(fake_demographics) #> Found potential date columns: fodelseman. Consider adding them to date_columns parameter for automatic date parsing.  # With date cleaning - clean birth dates (use lowercase column names) swereg::make_lowercase_names(fake_demographics, date_columns = \"fodelseman\")  # Check that fodelseman column was converted to Date class head(fake_demographics$fodelseman) #> [1] \"1959-07-01\" \"1988-07-01\" \"1989-07-01\" \"1988-07-01\" \"1954-07-01\" #> [6] \"1958-07-01\"  # For diagnosis data with multiple date columns (use lowercase column names) data(\"fake_diagnoses\", package = \"swereg\") swereg::make_lowercase_names(fake_diagnoses, date_columns = c(\"indatum\", \"utdatum\"))  # The function suggests missing date columns swereg::make_lowercase_names(fake_diagnoses, date_columns = \"indatum\") #> Found additional date columns not in date_columns: utdatum. Consider adding them for automatic date parsing. # Message: \"Found additional date columns not in date_columns: utdatum\""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_rowind_first_occurrence.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform rowdep variable to rowind variable using first occurrence — make_rowind_first_occurrence","title":"Transform rowdep variable to rowind variable using first occurrence — make_rowind_first_occurrence","text":"Creates row-independent (rowind) variable finding first occurrence condition TRUE extracting corresponding value. common pattern longitudinal registry data analysis creating stable person-level characteristics.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_rowind_first_occurrence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform rowdep variable to rowind variable using first occurrence — make_rowind_first_occurrence","text":"","code":"make_rowind_first_occurrence(dt, condition, value_var, new_var)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_rowind_first_occurrence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform rowdep variable to rowind variable using first occurrence — make_rowind_first_occurrence","text":"dt data.table longitudinal data condition Character string representing logical condition evaluate value_var Character string naming column extract values new_var Character string naming new rowind variable create","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_rowind_first_occurrence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform rowdep variable to rowind variable using first occurrence — make_rowind_first_occurrence","text":"data.table modified reference (invisibly returned)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_rowind_first_occurrence.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Transform rowdep variable to rowind variable using first occurrence — make_rowind_first_occurrence","text":"function implements common pattern transforming time-varying (rowdep) variables time-invariant (rowind) variables capturing value first occurrence condition. transformation follows steps: 1. Create temporary variable condition TRUE 2. Use first_non_na() find first occurrence person 3. Clean temporary variables automatically equivalent manual pattern: dt[condition, temp := value_var] dt[, new_var := first_non_na(temp), = .(id)] dt[, temp := NULL]","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/make_rowind_first_occurrence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform rowdep variable to rowind variable using first occurrence — make_rowind_first_occurrence","text":"","code":"if (FALSE) { # \\dontrun{ # Create example skeleton with diagnosis data skeleton <- create_skeleton(c(1,2,3), \"2020-01-01\", \"2020-12-31\")  # Add some example diagnosis data add_diagnoses(skeleton, diagnosis_data, \"lopnr\",               diags = list(\"example_diag\" = \"^F64\"))  # Transform: Age at first example diagnosis make_rowind_first_occurrence(skeleton,                              condition = \"diag_example_diag == TRUE\",                              value_var = \"age\",                              new_var = \"rowind_age_first_example_diag\") } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/max_with_infinite_as_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate maximum while treating infinite values as NA — max_with_infinite_as_na","title":"Calculate maximum while treating infinite values as NA — max_with_infinite_as_na","text":"Computes maximum value numeric vector, converting infinite values NA. Useful robust statistical calculations.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/max_with_infinite_as_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate maximum while treating infinite values as NA — max_with_infinite_as_na","text":"","code":"max_with_infinite_as_na(x, na.rm = T)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/max_with_infinite_as_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate maximum while treating infinite values as NA — max_with_infinite_as_na","text":"x Numeric vector na.rm Logical, whether remove NA values calculation (default: TRUE)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/max_with_infinite_as_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate maximum while treating infinite values as NA — max_with_infinite_as_na","text":"Maximum value infinite values converted NA","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/max_with_infinite_as_na.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate maximum while treating infinite values as NA — max_with_infinite_as_na","text":"","code":"x <- c(1, 2, 4) max_with_infinite_as_na(x)  # Returns 4 #> [1] 4  y <- c(1, 2, Inf, 4, -Inf) max_with_infinite_as_na(y)  # Returns NA (because of infinite values) #> [1] NA"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/min_with_infinite_as_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate minimum while treating infinite values as NA — min_with_infinite_as_na","title":"Calculate minimum while treating infinite values as NA — min_with_infinite_as_na","text":"Computes minimum value numeric vector, converting infinite values NA. Useful robust statistical calculations.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/min_with_infinite_as_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate minimum while treating infinite values as NA — min_with_infinite_as_na","text":"","code":"min_with_infinite_as_na(x, na.rm = T)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/min_with_infinite_as_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate minimum while treating infinite values as NA — min_with_infinite_as_na","text":"x Numeric vector na.rm Logical, whether remove NA values calculation (default: TRUE)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/min_with_infinite_as_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate minimum while treating infinite values as NA — min_with_infinite_as_na","text":"Minimum value infinite values converted NA","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/min_with_infinite_as_na.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate minimum while treating infinite values as NA — min_with_infinite_as_na","text":"","code":"x <- c(1, 2, 4) min_with_infinite_as_na(x)  # Returns 1 #> [1] 1  y <- c(1, 2, Inf, 4, -Inf) min_with_infinite_as_na(y)  # Returns NA (because of infinite values) #> [1] NA"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/parse_swedish_date.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse Swedish registry dates — parse_swedish_date","title":"Parse Swedish registry dates — parse_swedish_date","text":"Parses Swedish registry dates may varying precision (year , year-month, full date) converts proper Date objects. Handles common Swedish registry date formats missing date patterns.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/parse_swedish_date.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse Swedish registry dates — parse_swedish_date","text":"","code":"parse_swedish_date(   date_string,   default_month_day = \"0701\",   default_day = \"15\",   na_strings = c(\"\", \"NA\", \"9999\", \"99999999\") )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/parse_swedish_date.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse Swedish registry dates — parse_swedish_date","text":"date_string Character vector dates Swedish registry format default_month_day Character string default month-day year provided (default: \"0701\" July 1st) default_day Character string default day year-month provided (default: \"15\" 15th) na_strings Character vector strings treat NA (default: c(\"\", \"NA\", \"9999\", \"99999999\"))","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/parse_swedish_date.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse Swedish registry dates — parse_swedish_date","text":"Date vector parsed dates","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/parse_swedish_date.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parse Swedish registry dates — parse_swedish_date","text":"Swedish registry dates often come different formats: 4 characters (YYYY): year known - adds default_month_day 6 characters (YYYYMM): Year month known - adds default_day 8 characters (YYYYMMDD): Full date known - uses -Special handling: \"0000\" endings replaced default_month_day \"00\" endings replaced default_day Invalid dates return NA warnings","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/parse_swedish_date.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parse Swedish registry dates — parse_swedish_date","text":"","code":"# Different date formats dates <- c(\"2020\", \"202003\", \"20200315\", \"19990000\", \"199900\", \"19990600\", \"1989-01-01\", \"\") parse_swedish_date(dates) #> [1] \"2020-07-01\" \"2020-03-15\" \"2020-03-15\" \"1999-07-01\" \"1999-07-01\" #> [6] \"1999-06-15\" \"1989-01-01\" NA            # Custom defaults parse_swedish_date(dates, default_month_day = \"0101\", default_day = \"01\") #> [1] \"2020-01-01\" \"2020-03-01\" \"2020-03-15\" \"1999-01-01\" \"1999-01-01\" #> [6] \"1999-06-01\" \"1989-01-01\" NA"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/print.SkeletonConfig.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for SkeletonConfig — print.SkeletonConfig","title":"Print method for SkeletonConfig — print.SkeletonConfig","text":"Print method SkeletonConfig","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/print.SkeletonConfig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for SkeletonConfig — print.SkeletonConfig","text":"x [SkeletonConfig] object. ... Additional arguments (ignored).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/print.SkeletonConfig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for SkeletonConfig — print.SkeletonConfig","text":"Invisibly returns object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/print.SkeletonMeta.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for SkeletonMeta — print.SkeletonMeta","title":"Print method for SkeletonMeta — print.SkeletonMeta","text":"Print method SkeletonMeta","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/print.SkeletonMeta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for SkeletonMeta — print.SkeletonMeta","text":"x [SkeletonMeta] object. ... Additional arguments (ignored).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/print.SkeletonMeta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for SkeletonMeta — print.SkeletonMeta","text":"Invisibly returns object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/qs2_read.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a qs2 file (auto-detecting format) — qs2_read","title":"Read a qs2 file (auto-detecting format) — qs2_read","text":"Reads files saved either `qs2::qd_save` (qdata format) `qs2::qs_save` (standard format). Tries qdata first, falls back standard.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/qs2_read.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a qs2 file (auto-detecting format) — qs2_read","text":"","code":"qs2_read(file, nthreads = 1L)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/qs2_read.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a qs2 file (auto-detecting format) — qs2_read","text":"file Path .qs2 file. nthreads Number threads decompression.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/qs2_read.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a qs2 file (auto-detecting format) — qs2_read","text":"deserialized R object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_checkpoint.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a profiling checkpoint closure — skeleton_checkpoint","title":"Create a profiling checkpoint closure — skeleton_checkpoint","text":"Factory function returns closure recording time memory usage step skeleton processing. Call closure label step boundary. Call `done = TRUE` finalize return data.table checkpoints.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_checkpoint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a profiling checkpoint closure — skeleton_checkpoint","text":"","code":"skeleton_checkpoint()"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_checkpoint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a profiling checkpoint closure — skeleton_checkpoint","text":"function signature `function(label = NULL, done = FALSE)`:   - Call label string record checkpoint   - Call `done = TRUE` return data.table columns     `label`, `time`, `mem_mb`","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_checkpoint.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a profiling checkpoint closure — skeleton_checkpoint","text":"","code":"if (FALSE) { # \\dontrun{ cp <- skeleton_checkpoint() cp(\"start\") # ... do work ... cp(\"STEP 1: Select IDs\") # ... more work ... cp(\"STEP 2: Create skeleton\") prof_dt <- cp(done = TRUE) # prof_dt is a data.table with columns: label, time, mem_mb } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_config.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a skeleton pipeline configuration — skeleton_config","title":"Create a skeleton pipeline configuration — skeleton_config","text":"Constructor function [SkeletonConfig] objects. Accepts multiple candidate paths (like [org::initialize_project()]) resolves first existing directory runtime.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_config.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a skeleton pipeline configuration — skeleton_config","text":"","code":"skeleton_config(   rawbatch_dir,   group_names,   skeleton_dir = rawbatch_dir,   batch_sizes = c(1000L, 10000L),   seed = 4L,   id_col = \"lopnr\",   ids_per_skeleton_file = 1000L )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_config.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a skeleton pipeline configuration — skeleton_config","text":"rawbatch_dir Character vector candidate paths rawbatch files. first existing directory used. one path given exist, accepted -(created). group_names Character vector, names rawbatch groups. skeleton_dir Character vector candidate paths skeleton output. Defaults resolved value `rawbatch_dir`. batch_sizes Integer vector. First element = IDs batch 1 (dev), second = IDs remaining batches. Default: `c(1000L, 10000L)`. seed Integer, shuffle seed. Default: `4L`. id_col Character, person ID column name. Default: `\"lopnr\"`. ids_per_skeleton_file Integer, IDs per skeleton sub-file. Default: `1000L`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_config.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a skeleton pipeline configuration — skeleton_config","text":"[SkeletonConfig] object.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_config.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a skeleton pipeline configuration — skeleton_config","text":"","code":"if (FALSE) { # \\dontrun{ config <- skeleton_config(   rawbatch_dir = c(     \"//argos.rudbeck.uu.se/MyGroups$/Bronze/Embla_data/_MHT/2026/generic/\",     \"/data/argos/Bronze/Embla_data/_MHT/2026/generic/\",     \"C:/Users/isbeihm/Uppsala/argos/Bronze/Embla_data/_MHT/2026/generic/\"   ),   group_names = c(\"lmed\", \"diagnoses_and_operations\", \"other\") ) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_delete_rawbatches.html","id":null,"dir":"Reference","previous_headings":"","what":"Delete all rawbatch files from disk — skeleton_delete_rawbatches","title":"Delete all rawbatch files from disk — skeleton_delete_rawbatches","text":"Removes `BBB_rawbatch_group.qs2` files rawbatch directory.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_delete_rawbatches.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Delete all rawbatch files from disk — skeleton_delete_rawbatches","text":"","code":"skeleton_delete_rawbatches(skeleton_meta, ...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_delete_rawbatches.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Delete all rawbatch files from disk — skeleton_delete_rawbatches","text":"skeleton_meta [SkeletonMeta] object. ... used.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_delete_rawbatches.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Delete all rawbatch files from disk — skeleton_delete_rawbatches","text":"[SkeletonMeta] empty `groups_saved`.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_delete_skeletons.html","id":null,"dir":"Reference","previous_headings":"","what":"Delete all skeleton output files from disk — skeleton_delete_skeletons","title":"Delete all skeleton output files from disk — skeleton_delete_skeletons","text":"Removes `skeleton_BBB_SS.qs2` files skeleton directory.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_delete_skeletons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Delete all skeleton output files from disk — skeleton_delete_skeletons","text":"","code":"skeleton_delete_skeletons(skeleton_meta, ...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_delete_skeletons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Delete all skeleton output files from disk — skeleton_delete_skeletons","text":"skeleton_meta [SkeletonMeta] object. ... used.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_delete_skeletons.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Delete all skeleton output files from disk — skeleton_delete_skeletons","text":"[SkeletonMeta] empty `skeleton_files`.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_load_rawbatch.html","id":null,"dir":"Reference","previous_headings":"","what":"Load rawbatch files for a single batch — skeleton_load_rawbatch","title":"Load rawbatch files for a single batch — skeleton_load_rawbatch","text":"Reads group files one batch returns named list. Group files named lists (e.g., \"\") flattened result. project-specific exclusions applied – user can filter loading.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_load_rawbatch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load rawbatch files for a single batch — skeleton_load_rawbatch","text":"","code":"skeleton_load_rawbatch(skeleton_meta, ...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_load_rawbatch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load rawbatch files for a single batch — skeleton_load_rawbatch","text":"skeleton_meta [SkeletonMeta] object. ... Method dispatch. Pass `batch_number` (integer, 1-indexed).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_load_rawbatch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load rawbatch files for a single batch — skeleton_load_rawbatch","text":"Named list data.tables (one entry per group, list-type   groups flattened).","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_load_rawbatch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load rawbatch files for a single batch — skeleton_load_rawbatch","text":"","code":"if (FALSE) { # \\dontrun{ batch_data <- skeleton_load_rawbatch(skel_meta, batch_number = 1) # Apply project-specific exclusions batch_data[[\"lmed\"]] <- batch_data[[\"lmed\"]][!produkt %in% excluded] } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_meta.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a skeleton set from config and IDs — skeleton_meta","title":"Create a skeleton set from config and IDs — skeleton_meta","text":"Constructor function [SkeletonMeta] objects. Shuffles IDs using config seed, splits batches per `config@batch_sizes`, scans disk existing rawbatch skeleton files.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_meta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a skeleton set from config and IDs — skeleton_meta","text":"","code":"skeleton_meta(config, ids)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_meta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a skeleton set from config and IDs — skeleton_meta","text":"config [SkeletonConfig] object. ids Vector person IDs split batches.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_meta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a skeleton set from config and IDs — skeleton_meta","text":"[SkeletonMeta] object.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_meta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a skeleton set from config and IDs — skeleton_meta","text":"","code":"if (FALSE) { # \\dontrun{ config <- skeleton_config(   rawbatch_dir = \"/data/processed/\",   group_names = c(\"lmed\", \"diagnoses_and_operations\", \"other\") ) ids <- unique(grunduppgifter$lopnr) skel_meta <- skeleton_meta(config, ids) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_process.html","id":null,"dir":"Reference","previous_headings":"","what":"Process batches through a user-defined function — skeleton_process","title":"Process batches through a user-defined function — skeleton_process","text":"batch: loads rawbatch data via [skeleton_load_rawbatch()], calls `process_fn`, runs `gc()`. Wraps [progressr::with_progress()] progress bar.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_process.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process batches through a user-defined function — skeleton_process","text":"","code":"skeleton_process(skeleton_meta, ...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_process.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process batches through a user-defined function — skeleton_process","text":"skeleton_meta [SkeletonMeta] object. ... Method dispatch. Pass `process_fn` (function signature `function(batch_data, batch_number, config)` `batch_data` named list [skeleton_load_rawbatch()], `batch_number` integer batch index, `config` [SkeletonConfig] object), optionally `batches` (integer vector batch indices `NULL` ), optionally `n_workers` (integer, default `1L` sequential processing; > 1, runs pool [callr::r_bg()] subprocesses dynamically replace finished workers, keeping slots busy; threads auto-distributed `floor(detectCores() / n_workers)` per worker).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_process.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process batches through a user-defined function — skeleton_process","text":"list :   - `skeleton_meta`: updated [SkeletonMeta] `skeleton_files` re-scanned   - `results`: list `process_fn` return values (one per batch,     unprocessed slots `NULL`)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_process.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Process batches through a user-defined function — skeleton_process","text":"## Interactive development pattern Process functions typically defined R file `plnr::is_run_directly()` top enable line--line development: “`r skeleton_create_mht <- function(batch_data, batch_number, config)   (plnr::is_run_directly())     skel_meta <- qs2::qs_read(config@meta_file)     batch_number <- 1     batch_data <- skeleton_load_rawbatch(skel_meta, batch_number)     config <- skel_meta@config  # ... processing code ...  “`","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_process.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Process batches through a user-defined function — skeleton_process","text":"","code":"if (FALSE) { # \\dontrun{ # Process all batches result <- skeleton_process(skel_meta, function(batch_data, batch_number, config) {   batch_data[[\"lmed\"]] <- batch_data[[\"lmed\"]][!produkt %in% excluded]   skeleton_create_mht(batch_data, batch_number, config) }) qs2::qs_save(result$skeleton_meta, config@meta_file)  # Test run: process only the first 2 batches result <- skeleton_process(skel_meta, my_process_fn, batches = 1:2)  # Parallel: 3 workers via callr worker pool (each batch in a fresh subprocess) result <- skeleton_process(skel_meta, my_process_fn, n_workers = 3L) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_reset.html","id":null,"dir":"Reference","previous_headings":"","what":"Reset the skeleton pipeline by deleting all generated files — skeleton_reset","title":"Reset the skeleton pipeline by deleting all generated files — skeleton_reset","text":"Deletes rawbatch files, skeleton output files, `skeleton_meta.qs2` metadata file. calling , re-run full pipeline regenerate everything raw registry data.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_reset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reset the skeleton pipeline by deleting all generated files — skeleton_reset","text":"","code":"skeleton_reset(x, ...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_reset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reset the skeleton pipeline by deleting all generated files — skeleton_reset","text":"x [SkeletonMeta] [SkeletonConfig] object. ... used.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_reset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reset the skeleton pipeline by deleting all generated files — skeleton_reset","text":"Invisibly returns `NULL`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_reset.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Reset the skeleton pipeline by deleting all generated files — skeleton_reset","text":"Can operate [SkeletonMeta] object [SkeletonConfig] (useful `skeleton_meta.qs2` exist corrupt).","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_reset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reset the skeleton pipeline by deleting all generated files — skeleton_reset","text":"","code":"if (FALSE) { # \\dontrun{ # Reset from a loaded skeleton_meta skeleton_reset(skel_meta)  # Reset from just a config (no skeleton_meta.qs2 needed) skeleton_reset(config) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save.html","id":null,"dir":"Reference","previous_headings":"","what":"Save skeleton output as sub-files split by ID count — skeleton_save","title":"Save skeleton output as sub-files split by ID count — skeleton_save","text":"Splits skeleton data.table sub-files `ids_per_file` unique IDs saves `skeleton_BBB_SS.qs2` files. keeps individual files small enough fast loading downstream.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save skeleton output as sub-files split by ID count — skeleton_save","text":"","code":"skeleton_save(   dt,   batch_number,   output_dir,   ids_per_file = 1000L,   id_col = \"id\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save skeleton output as sub-files split by ID count — skeleton_save","text":"dt data.table skeleton data save. batch_number Integer batch number (used file naming). output_dir Character, directory output files. ids_per_file Integer, number unique IDs per sub-file. Default: `1000L`. id_col Character, name ID column `dt`. Default: `\"id\"`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save skeleton output as sub-files split by ID count — skeleton_save","text":"Character vector file paths created.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save skeleton output as sub-files split by ID count — skeleton_save","text":"","code":"if (FALSE) { # \\dontrun{ files <- skeleton_save(   skeleton,   batch_number = 1,   output_dir = config@skeleton_dir,   ids_per_file = config@ids_per_skeleton_file,   id_col = \"id\" ) # → skeleton_001_01.qs2, skeleton_001_02.qs2, ... } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save_rawbatch.html","id":null,"dir":"Reference","previous_headings":"","what":"Save rawbatch files for one group — skeleton_save_rawbatch","title":"Save rawbatch files for one group — skeleton_save_rawbatch","text":"Splits `data` batch IDs [SkeletonMeta] saves `BBB_rawbatch_group.qs2` files. Skips files group already exist disk.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save_rawbatch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save rawbatch files for one group — skeleton_save_rawbatch","text":"","code":"skeleton_save_rawbatch(skeleton_meta, ...)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save_rawbatch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save rawbatch files for one group — skeleton_save_rawbatch","text":"skeleton_meta [SkeletonMeta] object. ... Method dispatch. Pass `group` (character, group name) `data` (data.table named list data.tables).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save_rawbatch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save rawbatch files for one group — skeleton_save_rawbatch","text":"[SkeletonMeta] updated `groups_saved`.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/skeleton_save_rawbatch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save rawbatch files for one group — skeleton_save_rawbatch","text":"","code":"if (FALSE) { # \\dontrun{ lmed <- data.table::fread(\"lmed.csv\") skel_meta <- skeleton_save_rawbatch(skel_meta, \"lmed\", lmed) rm(lmed); gc() } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/steps_to_first.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate steps until first TRUE in a forward window — steps_to_first","title":"Calculate steps until first TRUE in a forward window — steps_to_first","text":"Slides forward logical vector find number steps first TRUE value. Useful time--event calculations longitudinal registry data.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/steps_to_first.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate steps until first TRUE in a forward window — steps_to_first","text":"","code":"steps_to_first(x, window_including_wk0 = 104L)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/steps_to_first.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate steps until first TRUE in a forward window — steps_to_first","text":"x Logical vector window_including_wk0 Total window size including current week (default 104, ~2 years)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/steps_to_first.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate steps until first TRUE in a forward window — steps_to_first","text":"Integer vector steps first TRUE, NA none window","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_apply_derived_confounders.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute derived confounder columns from a study spec — tte_apply_derived_confounders","title":"Compute derived confounder columns from a study spec — tte_apply_derived_confounders","text":"confounders `implementation$computed: true`, computes rolling window indicators using [tte_eligible_no_events_in_window_excluding_wk0()]. Requires `implementation$source_variable` `implementation$window` set.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_apply_derived_confounders.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute derived confounder columns from a study spec — tte_apply_derived_confounders","text":"","code":"tte_apply_derived_confounders(skeleton, spec)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_apply_derived_confounders.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute derived confounder columns from a study spec — tte_apply_derived_confounders","text":"skeleton data.table skeleton (person-week panel). spec Parsed study specification [tte_read_spec()].","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_apply_derived_confounders.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute derived confounder columns from a study spec — tte_apply_derived_confounders","text":"skeleton (modified reference), derived confounder   columns added.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_apply_exclusions.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply exclusion criteria from a study spec to a skeleton — tte_apply_exclusions","title":"Apply exclusion criteria from a study spec to a skeleton — tte_apply_exclusions","text":"Applies calendar year eligibility, enrollment-specific additional inclusion (e.g., age range), global exclusion criteria, enrollment-specific additional exclusion criteria parsed study specification. Calls [tte_eligible_combine()] end criteria single `eligible` column.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_apply_exclusions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply exclusion criteria from a study spec to a skeleton — tte_apply_exclusions","text":"","code":"tte_apply_exclusions(skeleton, spec, enrollment_spec)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_apply_exclusions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply exclusion criteria from a study spec to a skeleton — tte_apply_exclusions","text":"skeleton data.table skeleton (person-week panel). spec Parsed study specification [tte_read_spec()]. enrollment_spec Enrollment spec plan (must contain `enrollment_id`), returned `plan[[]]` passed `process_fn` callback.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_apply_exclusions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply exclusion criteria from a study spec to a skeleton — tte_apply_exclusions","text":"skeleton (modified reference), eligibility columns   added combined `eligible` column.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipcw.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate inverse probability of censoring weights (IPCW-PP) — tte_calculate_ipcw","title":"Calculate inverse probability of censoring weights (IPCW-PP) — tte_calculate_ipcw","text":"Calculates time-varying stabilized inverse probability censoring weights per-protocol analysis target trial emulation. IPCW-PP adjusts informative censoring due protocol deviation loss follow-.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipcw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate inverse probability of censoring weights (IPCW-PP) — tte_calculate_ipcw","text":"","code":"tte_calculate_ipcw(   data,   exposure_var,   censoring_var,   confounder_vars,   id_var = \"trial_id\",   tstart_var = \"tstart\",   tstop_var = \"tstop\",   separate_by_exposure = TRUE,   use_gam = TRUE )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipcw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate inverse probability of censoring weights (IPCW-PP) — tte_calculate_ipcw","text":"data data.table counting-process format (one row per person per time period). contain censoring indicator column. exposure_var Character, name baseline exposure column. censoring_var Character, name binary censoring indicator column (1 = censored end period, 0 = censored). confounder_vars Character vector confounder variable names censoring model. id_var Character, name trial identifier column (default: \"trial_id\"). tstart_var Character, name period start time column (default: \"tstart\"). tstop_var Character, name period end time column (default: \"tstop\"). separate_by_exposure Logical, whether fit separate censoring models exposure stratum (default: TRUE). Recommended censoring hazards often differ treatment. use_gam Logical, whether use GAM smooth time term instead plain GLM (default: TRUE). Uses [mgcv::bam()] `discrete = TRUE` memory-efficient fitting large datasets.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipcw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate inverse probability of censoring weights (IPCW-PP) — tte_calculate_ipcw","text":"input data.table added columns: p_censor Predicted probability censoring period p_uncensored 1 - p_censor cum_p_uncensored Cumulative product p_uncensored time marginal_p Marginal probability remaining uncensored       time point (within exposure stratum `separate_by_exposure = TRUE`) cum_marginal Cumulative product marginal_p time ipcw_pp Stabilized IPCW-PP per-protocol analysis = cum_marginal / cum_p_uncensored","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipcw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate inverse probability of censoring weights (IPCW-PP) — tte_calculate_ipcw","text":"IPCW-PP addresses informative censoring per-protocol analysis. people deviate assigned treatment lost follow-, censoring may related prognosis (sicker people may likely change treatment die). IPCW-PP upweights people likely censored , creating pseudo-population censoring independent measured confounders. **Algorithm:** Fit model P(censored | confounders, time) Calculate conditional probability remaining: p_uncensored = 1 - p_censor Cumulative conditional: cum_p_uncensored = cumulative product time Marginal probability: average p_uncensored time (within exposure) Cumulative marginal: cumulative product marginal probabilities Stabilized IPCW-PP = cum_marginal / cum_p_uncensored Separate models exposure recommended hazard censoring often differs treatment (e.g., treated patients may discontinue due side effects untreated may start treatment symptoms worsen). GAM smooth time term recommended censoring hazard may vary non-linearly time.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipcw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate inverse probability of censoring weights (IPCW-PP) — tte_calculate_ipcw","text":"","code":"if (FALSE) { # \\dontrun{ library(data.table) # Assuming data is prepared with censoring indicators result <- tte_calculate_ipcw(   data = counting_process_data,   exposure_var = \"baseline_exposed\",   censoring_var = \"censor_this_period\",   confounder_vars = c(\"age_cat\", \"education\"),   use_gam = TRUE ) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipw.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate inverse probability of treatment weights (IPW) — tte_calculate_ipw","title":"Calculate inverse probability of treatment weights (IPW) — tte_calculate_ipw","text":"Calculates stabilized inverse probability treatment weights adjust baseline confounding target trial emulation. IPW reweights sample confounders balanced across treatment groups, creating pseudo-population treatment independent measured confounders.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate inverse probability of treatment weights (IPW) — tte_calculate_ipw","text":"","code":"tte_calculate_ipw(   data,   exposure_var,   confounder_vars,   id_var = \"trial_id\",   stabilize = TRUE )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate inverse probability of treatment weights (IPW) — tte_calculate_ipw","text":"data data.table one row per trial baseline (typically `tstart == 0`). exposure_var Character, name binary exposure/treatment column. confounder_vars Character vector confounder variable names propensity score model. id_var Character, name trial identifier column (default: \"trial_id\"). stabilize Logical, whether use stabilized weights (recommended, default: TRUE). Stabilized weights marginal probability numerator, reducing variance maintaining valid inference.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate inverse probability of treatment weights (IPW) — tte_calculate_ipw","text":"input data.table added columns: ps Propensity score: P(exposure | confounders) ipw Inverse probability weight (stabilized `stabilize = TRUE`)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate inverse probability of treatment weights (IPW) — tte_calculate_ipw","text":"IPW addresses confounding creating pseudo-population treatment assignment independent confounders. propensity score P(|L) estimated using logistic regression, treatment L represents confounders. **Stabilized weights (recommended):** $$IPW = \\frac{P()}{P(|L)}$$ exposed, $$IPW = \\frac{1-P()}{1-P(|L)}$$ unexposed. **Unstabilized weights:** $$IPW = \\frac{1}{P(|L)}$$ exposed, $$IPW = \\frac{1}{1-P(|L)}$$ unexposed. Stabilized weights generally preferred lower variance pseudo-population expected size original sample.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_calculate_ipw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate inverse probability of treatment weights (IPW) — tte_calculate_ipw","text":"","code":"library(data.table) # Create example baseline data set.seed(42) baseline <- data.table(   trial_id = 1:1000,   exposed = rbinom(1000, 1, 0.3),   age_cat = sample(1:4, 1000, replace = TRUE),   education = sample(1:3, 1000, replace = TRUE) ) # Calculate IPW result <- tte_calculate_ipw(   data = baseline,   exposure_var = \"exposed\",   confounder_vars = c(\"age_cat\", \"education\"),   id_var = \"trial_id\" ) summary(result$ipw) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #>  0.9127  0.9733  0.9946  1.0000  1.0211  1.1045"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_callr_pool.html","id":null,"dir":"Reference","previous_headings":"","what":"Run a function on each work item via a pool of callr::r_bg() workers — tte_callr_pool","title":"Run a function on each work item via a pool of callr::r_bg() workers — tte_callr_pool","text":"Launches `n_workers` concurrent subprocesses. subprocess loads data.table + swereg fresh R session (clean OpenMP state), calls `.call(worker_fn, items[[]])`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_callr_pool.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run a function on each work item via a pool of callr::r_bg() workers — tte_callr_pool","text":"","code":"tte_callr_pool(   items,   worker_fn,   n_workers,   swereg_dev_path = NULL,   p = NULL,   item_labels = NULL,   collect = TRUE )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_callr_pool.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run a function on each work item via a pool of callr::r_bg() workers — tte_callr_pool","text":"items List argument lists, one per work item. element passed `worker_fn` via [.call()]. worker_fn Function call subprocess. signature must match names element `items`. n_workers Integer number concurrent subprocesses. swereg_dev_path Path local swereg dev copy (`devtools::load_all()`), `NULL` use installed swereg. p Progressor function [progressr::progressor()], `NULL`. item_labels Character vector labels error messages (length `items`). Defaults `\"1\"`, `\"2\"`, etc. collect `TRUE` (default), collect return worker results. `FALSE`, discard results (useful workers save output directly).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_callr_pool.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run a function on each work item via a pool of callr::r_bg() workers — tte_callr_pool","text":"`collect = TRUE`, list results (failures excluded   warning). `collect = FALSE`, `invisible(NULL)`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_collapse_periods.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse time intervals to coarser periods — tte_collapse_periods","title":"Collapse time intervals to coarser periods — tte_collapse_periods","text":"Aggregates fine-grained longitudinal data (e.g., weekly) coarser time periods (e.g., 4-week periods) target trial emulation. reduces data size can improve model stability.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_collapse_periods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse time intervals to coarser periods — tte_collapse_periods","text":"","code":"tte_collapse_periods(   data,   id_var,   time_var,   period_width = 4L,   first_cols = NULL,   last_cols = NULL,   max_cols = NULL,   sum_cols = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_collapse_periods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse time intervals to coarser periods — tte_collapse_periods","text":"data data.table counting-process format one row per fine-grained time unit (e.g., week). id_var Character, name trial/person identifier column. time_var Character, name time index column (e.g., week number within trial, starting 0). period_width Integer, number time units per period (default: 4). first_cols Character vector, columns aggregate using first value (e.g., baseline characteristics, confounders). last_cols Character vector, columns aggregate using last value (e.g., time-varying exposure status). max_cols Character vector, columns aggregate using max (e.g., event indicators - event period = 1). sum_cols Character vector, columns aggregate using sum (e.g., counts, default: NULL).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_collapse_periods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse time intervals to coarser periods — tte_collapse_periods","text":"data.table one row per period per trial, containing: tstart Period start time (period * period_width) tstop Period end time (period * period_width + period_width) Aggregated columns specified first_cols, last_cols, max_cols, sum_cols","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_collapse_periods.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Collapse time intervals to coarser periods — tte_collapse_periods","text":"function implements common preprocessing step target trial emulation weekly registry data collapsed 4-week (monthly) periods. : Reduces dataset size ~4x (4-week periods) Improves computational efficiency Can improve model stability sparse events aggregation rules : first_cols: Take first value period (time-invariant     baseline values) last_cols: Take last value period (time-varying     status period end) max_cols: Take maximum (event indicators: event     period counts event) sum_cols: Take sum (counts)","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_collapse_periods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collapse time intervals to coarser periods — tte_collapse_periods","text":"","code":"library(data.table) # Weekly data for 2 trials, 8 weeks each dt <- data.table(   trial_id = rep(1:2, each = 8),   week = rep(0:7, 2),   exposed = c(rep(TRUE, 8), rep(FALSE, 8)),   age = rep(c(55, 60), each = 8),   event = c(0,0,0,1,0,0,0,0, 0,0,0,0,0,0,1,0) ) # Collapse to 4-week periods result <- tte_collapse_periods(   dt,   id_var = \"trial_id\",   time_var = \"week\",   period_width = 4,   first_cols = c(\"age\"),   last_cols = c(\"exposed\"),   max_cols = c(\"event\") )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_combine_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine IPW and IPCW-PP weights for per-protocol analysis — tte_combine_weights","title":"Combine IPW and IPCW-PP weights for per-protocol analysis — tte_combine_weights","text":"Creates combined inverse probability weights multiplying IPW (baseline confounding adjustment) IPCW-PP (censoring adjustment per-protocol). combined weight used per-protocol effect estimation target trial emulation.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_combine_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine IPW and IPCW-PP weights for per-protocol analysis — tte_combine_weights","text":"","code":"tte_combine_weights(   data,   ipw_col = \"ipw\",   ipcw_col = \"ipcw_pp\",   output_col = \"analysis_weight_pp\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_combine_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine IPW and IPCW-PP weights for per-protocol analysis — tte_combine_weights","text":"data data.table containing IPW IPCW-PP columns. ipw_col Character, name IPW column (default: \"ipw\"). ipcw_col Character, name IPCW-PP column (default: \"ipcw_pp\"). output_col Character, name combined weight column (default: \"analysis_weight_pp\").","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_combine_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine IPW and IPCW-PP weights for per-protocol analysis — tte_combine_weights","text":"input data.table added column combined weights.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_combine_weights.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combine IPW and IPCW-PP weights for per-protocol analysis — tte_combine_weights","text":"per-protocol weight combines two adjustments: **IPW**: Adjusts baseline confounding (gets treated) **IPCW-PP**: Adjusts time-varying censoring (deviates/drops ) combined weight simply: analysis_weight_pp = IPW x IPCW-PP creates pseudo-population treatment assignment censoring independent measured confounders, enabling unbiased estimation per-protocol effect.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_combine_weights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine IPW and IPCW-PP weights for per-protocol analysis — tte_combine_weights","text":"","code":"library(data.table) dt <- data.table(   id = 1:100,   ipw = runif(100, 0.8, 1.2),   ipcw_pp = runif(100, 0.9, 1.1) ) result <- tte_combine_weights(dt) # Creates analysis_weight_pp = ipw * ipcw_pp"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a TTE design specification — tte_design","title":"Create a TTE design specification — tte_design","text":"Constructor function [TTEDesign] objects. Defines column name mappings target trial emulation analysis.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a TTE design specification — tte_design","text":"","code":"tte_design(   exposure_var,   outcome_vars,   confounder_vars,   follow_up_time,   person_id_var = NULL,   id_var = \"trial_id\",   tstart_var = \"tstart\",   tstop_var = \"tstop\",   time_exposure_var = NULL,   eligible_var = NULL,   admin_censor_var = NULL,   admin_censor_isoyearweek = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a TTE design specification — tte_design","text":"exposure_var Character, name baseline exposure/treatment column. outcome_vars Character vector, names outcome event indicator columns. confounder_vars Character vector, names confounder columns. follow_up_time Integer, expected follow-duration time units. person_id_var Character NULL, name person identifier column pre-panel (person-week) data. Used `tte_enrollment()`. (default: NULL). id_var Character, name trial identifier column. Auto-generated `tte_enrollment()` \"trial_id\" (default: \"trial_id\"). tstart_var Character, period start time column (default: \"tstart\"). tstop_var Character, period end time column (default: \"tstop\"). time_exposure_var Character NULL, time-varying exposure column per-protocol analysis (default: NULL). eligible_var Character NULL, eligibility indicator column (default: NULL). admin_censor_var Character NULL, administrative censoring boundary column (default: NULL). Mutually exclusive `admin_censor_isoyearweek`. admin_censor_isoyearweek Character NULL, study end date ISO year-week format (e.g., \"2023-52\"). set, administrative censoring computed internally `$prepare_for_analysis()`. Mutually exclusive `admin_censor_var` (default: NULL).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a TTE design specification — tte_design","text":"[TTEDesign] object.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_design.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a TTE design specification — tte_design","text":"","code":"# Design for post-panel (trial-level) data design <- tte_design(   exposure_var = \"baseline_exposed\",   time_exposure_var = \"current_exposed\",   outcome_vars = c(\"death\", \"hospitalization\"),   confounder_vars = c(\"age\", \"sex\", \"education\"),   follow_up_time = 156L )  # Design for pre-panel (person-week) data design_prepanel <- tte_design(   person_id_var = \"id\",   exposure_var = \"baseline_exposed\",   outcome_vars = c(\"death\", \"hospitalization\"),   confounder_vars = c(\"age\", \"sex\"),   follow_up_time = 156L,   eligible_var = \"eligible\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_age_range.html","id":null,"dir":"Reference","previous_headings":"","what":"Check eligibility based on age range — tte_eligible_age_range","title":"Check eligibility based on age range — tte_eligible_age_range","text":"Adds logical column indicating whether row's age falls within specified range (inclusive ends).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_age_range.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check eligibility based on age range — tte_eligible_age_range","text":"","code":"tte_eligible_age_range(   dt,   age_var,   min_age,   max_age,   col_name = \"eligible_age\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_age_range.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check eligibility based on age range — tte_eligible_age_range","text":"dt data.table specified age variable. age_var Character. Name column containing continuous age. min_age Numeric. Minimum eligible age (inclusive). max_age Numeric. Maximum eligible age (inclusive). col_name Character. Name eligibility column create. Default: \"eligible_age\".","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_age_range.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check eligibility based on age range — tte_eligible_age_range","text":"input data.table (invisibly), modified reference new   eligibility column.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_age_range.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check eligibility based on age range — tte_eligible_age_range","text":"","code":"if (FALSE) { # \\dontrun{ temp |>   tte_eligible_age_range(\"rd_age_continuous\", min_age = 50, max_age = 60) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_combine.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine multiple eligibility criteria — tte_eligible_combine","title":"Combine multiple eligibility criteria — tte_eligible_combine","text":"Combines multiple eligibility columns single logical column using logic (criteria must TRUE overall eligibility).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_combine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine multiple eligibility criteria — tte_eligible_combine","text":"","code":"tte_eligible_combine(dt, eligible_cols, col_name = \"eligible\")"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_combine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine multiple eligibility criteria — tte_eligible_combine","text":"dt data.table specified eligibility columns. eligible_cols Character vector. Names eligibility columns combine. col_name Character. Name combined eligibility column create. Default: \"eligible\".","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_combine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine multiple eligibility criteria — tte_eligible_combine","text":"input data.table (invisibly), modified reference new   combined eligibility column.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_combine.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine multiple eligibility criteria — tte_eligible_combine","text":"","code":"if (FALSE) { # \\dontrun{ # First define individual criteria temp |>   tte_eligible_isoyears(2007:2020) |>   tte_eligible_age_range(\"rd_age_continuous\", min_age = 50, max_age = 60) |>   tte_eligible_no_events_in_window_excluding_wk0(\"icd10_f20_f29\", window = Inf) |>   tte_eligible_no_observation_in_window_excluding_wk0(     \"rd_approach1_single\", \"systemic_mht\", window = Inf   ) |>   tte_eligible_no_events_in_window_excluding_wk0(\"rx_n05a\", window = 52) |>   tte_eligible_no_events_in_window_excluding_wk0(\"rx_g03aa\", window = 52) |>   tte_eligible_combine(c(     \"eligible_isoyears\",     \"eligible_age\",     \"eligible_no_icd10_f20_f29_ever\",     \"eligible_no_rd_approach1_single_ever\",     \"eligible_no_rx_n05a_52wk\",     \"eligible_no_rx_g03aa_52wk\"   )) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_isoyears.html","id":null,"dir":"Reference","previous_headings":"","what":"Check eligibility based on ISO years — tte_eligible_isoyears","title":"Check eligibility based on ISO years — tte_eligible_isoyears","text":"Adds logical column indicating whether row falls within specified ISO years. Typically used restrict analysis calendar period.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_isoyears.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check eligibility based on ISO years — tte_eligible_isoyears","text":"","code":"tte_eligible_isoyears(dt, isoyears, col_name = \"eligible_isoyears\")"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_isoyears.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check eligibility based on ISO years — tte_eligible_isoyears","text":"dt data.table `isoyear` column. isoyears Integer vector eligible ISO years (e.g., 2007:2020). col_name Character. Name eligibility column create. Default: \"eligible_isoyears\".","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_isoyears.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check eligibility based on ISO years — tte_eligible_isoyears","text":"input data.table (invisibly), modified reference new   eligibility column.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_isoyears.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check eligibility based on ISO years — tte_eligible_isoyears","text":"","code":"if (FALSE) { # \\dontrun{ temp |>   tte_eligible_isoyears(2007:2020) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_in_window_excluding_wk0.html","id":null,"dir":"Reference","previous_headings":"","what":"Check eligibility based on no events in prior window (excluding baseline week) — tte_eligible_no_events_in_window_excluding_wk0","title":"Check eligibility based on no events in prior window (excluding baseline week) — tte_eligible_no_events_in_window_excluding_wk0","text":"Adds logical column indicating whether TRUE values specified event variable within prior window, EXCLUDING current (baseline) week. correct semantic trial eligibility: want know someone event potentially enter trial.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_in_window_excluding_wk0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check eligibility based on no events in prior window (excluding baseline week) — tte_eligible_no_events_in_window_excluding_wk0","text":"","code":"tte_eligible_no_events_in_window_excluding_wk0(   dt,   event_var,   window = 52,   col_name = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_in_window_excluding_wk0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check eligibility based on no events in prior window (excluding baseline week) — tte_eligible_no_events_in_window_excluding_wk0","text":"dt data.table specified event variable. Must grouped person ID proper calculation. event_var Character. Name logical column indicating event occurrence. window Integer Inf. Number prior weeks check (excluding current week). Use `Inf` check entire lifetime history. Default: 52 (one year). col_name Character NULL. Name eligibility column create. NULL, auto-generates \"eligible_no_<event_var>_<window>wk\" \"eligible_no_<event_var>_ever\" Inf window.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_in_window_excluding_wk0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check eligibility based on no events in prior window (excluding baseline week) — tte_eligible_no_events_in_window_excluding_wk0","text":"input data.table (invisibly), modified reference new   eligibility column.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_in_window_excluding_wk0.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check eligibility based on no events in prior window (excluding baseline week) — tte_eligible_no_events_in_window_excluding_wk0","text":"Uses [any_events_prior_to()] internally `.= -1L`, always excludes current row. **exclude baseline week?** target trial emulation, eligibility assessed moment potential trial entry. event occurring baseline week used determine eligibility happens simultaneously () eligibility assessment. semantic : \"person event week?\" Using `cumsum(x) == 0` INCORRECT INCLUDES current week. function correctly excludes current week.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_in_window_excluding_wk0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check eligibility based on no events in prior window (excluding baseline week) — tte_eligible_no_events_in_window_excluding_wk0","text":"","code":"if (FALSE) { # \\dontrun{ # No psychosis diagnosis ever (excluding baseline week) temp |>   tte_eligible_no_events_in_window_excluding_wk0(\"icd10_f20_f29\", window = Inf)  # No antipsychotic prescriptions in prior year (excluding baseline week) temp |>   tte_eligible_no_events_in_window_excluding_wk0(\"rx_n05a\", window = 52) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_lifetime_before_and_after_baseline.html","id":null,"dir":"Reference","previous_headings":"","what":"Check eligibility based on no events ever (person-level, before and after baseline) — tte_eligible_no_events_lifetime_before_and_after_baseline","title":"Check eligibility based on no events ever (person-level, before and after baseline) — tte_eligible_no_events_lifetime_before_and_after_baseline","text":"Adds logical column indicating whether person TRUE values specified event variable time point. Unlike [tte_eligible_no_events_in_window_excluding_wk0()] checks rolling window relative week, person-level flag: event TRUE row person, rows person marked ineligible.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_lifetime_before_and_after_baseline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check eligibility based on no events ever (person-level, before and after baseline) — tte_eligible_no_events_lifetime_before_and_after_baseline","text":"","code":"tte_eligible_no_events_lifetime_before_and_after_baseline(   dt,   event_var,   col_name = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_lifetime_before_and_after_baseline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check eligibility based on no events ever (person-level, before and after baseline) — tte_eligible_no_events_lifetime_before_and_after_baseline","text":"dt data.table `id` column specified event variable. event_var Character. Name logical column indicating event occurrence. col_name Character NULL. Name eligibility column create. NULL, auto-generates \"eligible_no_<event_var>_lifetime_before_and_after_baseline\".","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_lifetime_before_and_after_baseline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check eligibility based on no events ever (person-level, before and after baseline) — tte_eligible_no_events_lifetime_before_and_after_baseline","text":"input data.table (invisibly), modified reference new   eligibility column.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_lifetime_before_and_after_baseline.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check eligibility based on no events ever (person-level, before and after baseline) — tte_eligible_no_events_lifetime_before_and_after_baseline","text":"Use case: excluding people condition diagnosed time (e.g., gender dysphoria F64) future diagnoses also indicate person never eligible.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_events_lifetime_before_and_after_baseline.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check eligibility based on no events ever (person-level, before and after baseline) — tte_eligible_no_events_lifetime_before_and_after_baseline","text":"","code":"if (FALSE) { # \\dontrun{ # Exclude anyone who EVER has gender dysphoria diagnosis temp |>   tte_eligible_no_events_lifetime_before_and_after_baseline(\"icd10_f64\") } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_observation_in_window_excluding_wk0.html","id":null,"dir":"Reference","previous_headings":"","what":"Check eligibility based on no observation of a specific value (excluding baseline week) — tte_eligible_no_observation_in_window_excluding_wk0","title":"Check eligibility based on no observation of a specific value (excluding baseline week) — tte_eligible_no_observation_in_window_excluding_wk0","text":"Adds logical column indicating whether specific value observed specified variable within prior window, EXCLUDING current (baseline) week. Useful categorical variables want exclude people specific value (e.g., \"systemic_mht\") history.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_observation_in_window_excluding_wk0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check eligibility based on no observation of a specific value (excluding baseline week) — tte_eligible_no_observation_in_window_excluding_wk0","text":"","code":"tte_eligible_no_observation_in_window_excluding_wk0(   dt,   var,   value,   window = Inf,   col_name = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_observation_in_window_excluding_wk0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check eligibility based on no observation of a specific value (excluding baseline week) — tte_eligible_no_observation_in_window_excluding_wk0","text":"dt data.table specified variable. Must grouped person ID proper calculation. var Character. Name column check. value specific value look (compared `==`). window Integer Inf. Number prior weeks check (excluding current week). Use `Inf` check entire lifetime history. Default: Inf. col_name Character NULL. Name eligibility column create. NULL, auto-generates \"eligible_no_<var>_<window>wk\" \"eligible_no_<var>_ever\" Inf window.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_observation_in_window_excluding_wk0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check eligibility based on no observation of a specific value (excluding baseline week) — tte_eligible_no_observation_in_window_excluding_wk0","text":"input data.table (invisibly), modified reference new   eligibility column.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_observation_in_window_excluding_wk0.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check eligibility based on no observation of a specific value (excluding baseline week) — tte_eligible_no_observation_in_window_excluding_wk0","text":"convenience wrapper around [tte_eligible_no_events_in_window_excluding_wk0()] first creates temporary logical column whether value observed.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_eligible_no_observation_in_window_excluding_wk0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check eligibility based on no observation of a specific value (excluding baseline week) — tte_eligible_no_observation_in_window_excluding_wk0","text":"","code":"if (FALSE) { # \\dontrun{ # No prior systemic MHT use (excluding baseline week) temp |>   tte_eligible_no_observation_in_window_excluding_wk0(     \"rd_approach1_single\", \"systemic_mht\", window = Inf   ) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_enrollment.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a TTE enrollment object — tte_enrollment","title":"Create a TTE enrollment object — tte_enrollment","text":"Constructor function [TTEEnrollment] objects. Wraps enrollment data design specification enable fluent `$`-chaining.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_enrollment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a TTE enrollment object — tte_enrollment","text":"","code":"tte_enrollment(   data,   design,   data_level = NULL,   ratio = NULL,   seed = NULL,   extra_cols = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_enrollment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a TTE enrollment object — tte_enrollment","text":"data data.table containing trial data. design [TTEDesign] object specifying column mappings. data_level Character NULL. NULL (default), auto-detects based identifier column exists data. \"person_week\" pre-panel data (requires person_id_var), \"trial\" post-panel data (requires id_var). ratio Numeric NULL. provided, automatically enrolls participants (sampling comparison group creating trial panels). valid person_week data. seed Integer NULL. Random seed enrollment reproducibility. extra_cols Character vector NULL. Extra columns include trial panels enrollment.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_enrollment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a TTE enrollment object — tte_enrollment","text":"[TTEEnrollment] object.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_enrollment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a TTE enrollment object — tte_enrollment","text":"","code":"if (FALSE) { # \\dontrun{ # Trial-level data (auto-detected) design <- tte_design(   exposure_var = \"exposed\",   outcome_vars = \"death\",   confounder_vars = c(\"age\", \"sex\"),   follow_up_time = 52L ) trial <- tte_enrollment(my_trial_data, design) trial$   collapse(period_width = 4)$   ipw()  # Person-week data with auto-enroll enrollment <- tte_enrollment(skeleton, design,   ratio = 2, seed = 4, extra_cols = \"isoyearweek\" ) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_identify_censoring.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify protocol deviation and loss to follow-up for per-protocol analysis — tte_identify_censoring","title":"Identify protocol deviation and loss to follow-up for per-protocol analysis — tte_identify_censoring","text":"Detects informative censoring events longitudinal data target trial emulation. Protocol deviation occurs treatment status changes baseline assignment. Loss follow-occurs follow-ends earlier expected (e.g., death, emigration) without administrative censoring.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_identify_censoring.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify protocol deviation and loss to follow-up for per-protocol analysis — tte_identify_censoring","text":"","code":"tte_identify_censoring(   data,   exposure_var,   baseline_exposure_var,   id_var = \"trial_id\",   tstart_var = \"tstart\",   tstop_var = \"tstop\",   follow_up_var = NULL,   admin_censor_var = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_identify_censoring.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify protocol deviation and loss to follow-up for per-protocol analysis — tte_identify_censoring","text":"data data.table counting-process format (one row per person per time period). exposure_var Character, name time-varying exposure column (current treatment status period). baseline_exposure_var Character, name baseline treatment assignment column. id_var Character, name trial identifier column (default: \"trial_id\"). tstart_var Character, name period start time column (default: \"tstart\"). tstop_var Character, name period end time column (default: \"tstop\"). follow_up_var Character, name expected follow-duration column. NULL, loss follow-calculated (default: NULL). admin_censor_var Character, name column indicating administrative censoring boundary (e.g., study end date). NULL, administrative censoring distinguished loss follow-(default: NULL).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_identify_censoring.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify protocol deviation and loss to follow-up for per-protocol analysis — tte_identify_censoring","text":"input data.table added columns: protocol_deviated Logical, TRUE current exposure differs       baseline assignment missing (NA) weeks_to_protocol_deviation Integer, tstop first period       protocol deviation (NA never deviated) weeks_to_loss Integer, max tstop loss follow-occurred       (NA otherwise). calculated `follow_up_var` provided. censored Logical, TRUE protocol_deviated lost follow-","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_identify_censoring.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identify protocol deviation and loss to follow-up for per-protocol analysis — tte_identify_censoring","text":"per-protocol analysis, participants censored deviate assigned treatment. function identifies: **Protocol deviation:** Exposed baseline stop/switch treatment Unexposed baseline start treatment Missing exposure data (confirm adherence) **Loss follow-:** Follow-ended expected duration protocol deviation occurred due administrative censoring (study end) censoring events typically informative (related prognosis) require IPCW-PP adjustment valid per-protocol effect estimation.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_identify_censoring.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify protocol deviation and loss to follow-up for per-protocol analysis — tte_identify_censoring","text":"","code":"library(data.table) # Create example counting-process data dt <- data.table(   trial_id = rep(1:3, each = 4),   tstart = rep(0:3, 3),   tstop = rep(1:4, 3),   baseline_exposed = rep(c(TRUE, TRUE, FALSE), each = 4),   current_exposed = c(TRUE, TRUE, FALSE, FALSE,  # Person 1 deviates at week 3                       TRUE, TRUE, TRUE, TRUE,    # Person 2 adheres                       FALSE, FALSE, TRUE, TRUE)  # Person 3 deviates at week 3 ) result <- tte_identify_censoring(   data = dt,   exposure_var = \"current_exposed\",   baseline_exposure_var = \"baseline_exposed\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_impute_confounders.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing confounders by sampling from observed values — tte_impute_confounders","title":"Impute missing confounders by sampling from observed values — tte_impute_confounders","text":"Thin standalone wrapper delegates `trial$impute_confounders()`. Exists standalone function can used default `impute_fn` callback `$generate_enrollments_and_ipw()`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_impute_confounders.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing confounders by sampling from observed values — tte_impute_confounders","text":"","code":"tte_impute_confounders(trial, confounder_vars, seed = 4L)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_impute_confounders.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing confounders by sampling from observed values — tte_impute_confounders","text":"trial [TTEEnrollment] object. confounder_vars Character vector confounder column names impute. seed Integer seed reproducibility (default: 4L).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_impute_confounders.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing confounders by sampling from observed values — tte_impute_confounders","text":"modified [TTEEnrollment] object (invisibly).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_irr_combine.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine and format multiple irr outputs into a publication-ready table — tte_irr_combine","title":"Combine and format multiple irr outputs into a publication-ready table — tte_irr_combine","text":"Combine format multiple irr outputs publication-ready table","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_irr_combine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine and format multiple irr outputs into a publication-ready table — tte_irr_combine","text":"","code":"tte_irr_combine(results, slot, descriptions = NULL)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_irr_combine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine and format multiple irr outputs into a publication-ready table — tte_irr_combine","text":"results Named list per-ETT result lists. slot Character scalar: name slot `$irr()` output. descriptions Optional named character vector mapping ett_id descriptions.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_irr_combine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine and format multiple irr outputs into a publication-ready table — tte_irr_combine","text":"data.table formatted IRR estimates.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_match_ratio.html","id":null,"dir":"Reference","previous_headings":"","what":"Match unexposed to exposed at a specified ratio — tte_match_ratio","title":"Match unexposed to exposed at a specified ratio — tte_match_ratio","text":"Samples unexposed individuals achieve target ratio relative exposed individuals. commonly used target trial emulation increase statistical efficiency maintaining reasonable sample sizes.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_match_ratio.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Match unexposed to exposed at a specified ratio — tte_match_ratio","text":"","code":"tte_match_ratio(   data,   exposure_var,   eligible_var = NULL,   ratio = 2,   id_var = NULL,   seed = NULL,   mark_unsampled = \"na\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_match_ratio.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Match unexposed to exposed at a specified ratio — tte_match_ratio","text":"data data.table containing study population. exposure_var Character, name binary exposure column. eligible_var Character, name eligibility indicator column (default: NULL, meaning rows eligible). ratio Numeric, target ratio unexposed exposed (default: 2, meaning 2 unexposed every 1 exposed). id_var Character, name ID column reporting (default: NULL). seed Integer, random seed reproducibility (default: NULL). mark_unsampled Character, mark unsampled unexposed individuals: \"na\" sets exposure NA, \"drop\" removes rows, \"flag\" adds column (default: \"na\").","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_match_ratio.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Match unexposed to exposed at a specified ratio — tte_match_ratio","text":"input data.table, modified: `mark_unsampled = \"na\"`: unsampled unexposed exposure set NA `mark_unsampled = \"drop\"`: unsampled unexposed rows removed `mark_unsampled = \"flag\"`: adds `sampled` column (TRUE/FALSE)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_match_ratio.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Match unexposed to exposed at a specified ratio — tte_match_ratio","text":"observational studies, often many unexposed exposed individuals. Including unexposed can computationally expensive adds little statistical power beyond certain ratio. Common choices 1:1, 2:1, 4:1 matching. function: Counts exposed individuals among eligible rows Randomly samples `ratio * n_exposed` eligible unexposed Marks removes unsampled unexposed individuals fewer unexposed `ratio * n_exposed`, unexposed kept.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_match_ratio.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Match unexposed to exposed at a specified ratio — tte_match_ratio","text":"","code":"library(data.table) set.seed(42) dt <- data.table(   id = 1:1000,   eligible = TRUE,   exposed = c(rep(TRUE, 100), rep(FALSE, 900)) ) # 2:1 matching: keep 200 unexposed for 100 exposed result <- tte_match_ratio(dt, \"exposed\", \"eligible\", ratio = 2, seed = 123) table(result$exposed, useNA = \"always\") #>  #> FALSE  TRUE  <NA>  #>   200   100   700"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an empty TTE plan — tte_plan","title":"Create an empty TTE plan — tte_plan","text":"Constructor [TTEPlan] objects. Creates empty plan just infrastructure parameters. Use `$add_one_ett()` add ETTs.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an empty TTE plan — tte_plan","text":"","code":"tte_plan(project_prefix, skeleton_files, global_max_isoyearweek)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an empty TTE plan — tte_plan","text":"project_prefix string used file naming (e.g., \"project002_ozel_psychosis\"). skeleton_files Character vector skeleton file paths. global_max_isoyearweek Administrative censoring boundary (isoyearweek string).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an empty TTE plan — tte_plan","text":"[TTEPlan] object ETTs.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create an empty TTE plan — tte_plan","text":"","code":"if (FALSE) { # \\dontrun{ plan <- tte_plan(   project_prefix = \"project002\",   skeleton_files = skeleton_files,   global_max_isoyearweek = \"2023-52\" ) plan$add_one_ett(   outcome_var = \"death\",   outcome_name = \"Death\",   follow_up = 52,   confounder_vars = c(\"age\", \"sex\", \"education\"),   time_exposure_var = \"rd_exposed\",   eligible_var = \"eligible\",   argset = list(age_group = \"50_60\", age_min = 50, age_max = 60) ) } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan_from_spec_and_skeleton_meta.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a TTEPlan from a study specification — tte_plan_from_spec_and_skeleton_meta","title":"Create a TTEPlan from a study specification — tte_plan_from_spec_and_skeleton_meta","text":"Builds [TTEPlan] full ETT grid (enrollments x outcomes x follow-) parsed study specification. Also stores enrollment's exposure implementation details ETT data.table available via `plan[[]]$exposure_impl`.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan_from_spec_and_skeleton_meta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a TTEPlan from a study specification — tte_plan_from_spec_and_skeleton_meta","text":"","code":"tte_plan_from_spec_and_skeleton_meta(   spec,   skeleton_files = NULL,   skeleton_meta_path = NULL,   n_skeleton_files = NULL,   global_max_isoyearweek = NULL )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan_from_spec_and_skeleton_meta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a TTEPlan from a study specification — tte_plan_from_spec_and_skeleton_meta","text":"spec Character path YAML spec file, parsed spec list [tte_read_spec()]. path given, version extracted filename (`_vNNN.yaml`) validated `spec$study$implementation$version`. skeleton_files Character vector skeleton file paths. Either `skeleton_meta_path` must provided. skeleton_meta_path Path `skeleton_meta.qs2` file. `@skeleton_files` slot extracted [SkeletonMeta] object. n_skeleton_files Optional integer: NULL, first `n_skeleton_files` files used (faster dev iterations). global_max_isoyearweek Administrative censoring boundary (isoyearweek string, e.g., \"2023-52\"). `NULL` (default), auto-detected `max(isoyearweek)` first skeleton file. Also runs [tte_validate_spec()] skeleton.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan_from_spec_and_skeleton_meta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a TTEPlan from a study specification — tte_plan_from_spec_and_skeleton_meta","text":"[TTEPlan] object full ETT grid.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan_load.html","id":null,"dir":"Reference","previous_headings":"","what":"Load a TTE plan from disk — tte_plan_load","title":"Load a TTE plan from disk — tte_plan_load","text":"Reads `.qs2` file saved `$save()` reconstructs [TTEPlan] object.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan_load.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load a TTE plan from disk — tte_plan_load","text":"","code":"tte_plan_load(path)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan_load.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load a TTE plan from disk — tte_plan_load","text":"path File path `.qs2` plan file.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_plan_load.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load a TTE plan from disk — tte_plan_load","text":"[TTEPlan] object.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rates_combine.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine and format multiple rates outputs into a publication-ready table — tte_rates_combine","title":"Combine and format multiple rates outputs into a publication-ready table — tte_rates_combine","text":"Combine format multiple rates outputs publication-ready table","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rates_combine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine and format multiple rates outputs into a publication-ready table — tte_rates_combine","text":"","code":"tte_rates_combine(results, slot, descriptions = NULL)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rates_combine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine and format multiple rates outputs into a publication-ready table — tte_rates_combine","text":"results Named list per-ETT result lists. slot Character scalar: name slot `$rates()` output. descriptions Optional named character vector mapping ett_id descriptions.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rates_combine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine and format multiple rates outputs into a publication-ready table — tte_rates_combine","text":"data.table wide format.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rbind.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine multiple enrollment objects — tte_rbind","title":"Combine multiple enrollment objects — tte_rbind","text":"Combines multiple [TTEEnrollment] objects row-binding data. Used batched processing data large fit memory .","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rbind.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine multiple enrollment objects — tte_rbind","text":"","code":"tte_rbind(trials)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rbind.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine multiple enrollment objects — tte_rbind","text":"trials list [TTEEnrollment] objects combine.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rbind.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine multiple enrollment objects — tte_rbind","text":"new [TTEEnrollment] object combined data.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rbind.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combine multiple enrollment objects — tte_rbind","text":"trials must design data_level. combined trial inherits: - design data_level first trial - intersection steps_completed trials - union weight_cols trials","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_rbind.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine multiple enrollment objects — tte_rbind","text":"","code":"if (FALSE) { # \\dontrun{ trials <- lapply(files, function(f) {   tte_enrollment(load_data(f), design, ratio = 2) }) combined <- tte_rbind(trials) combined$collapse(period_width = 4)$ipw() } # }"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_read_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Read and validate a YAML study specification — tte_read_spec","title":"Read and validate a YAML study specification — tte_read_spec","text":"Parses YAML study specification file, converts human-readable windows (e.g., \"lifetime_before_baseline\", \"3 years\") weeks, validates required fields present.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_read_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read and validate a YAML study specification — tte_read_spec","text":"","code":"tte_read_spec(spec_path)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_read_spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read and validate a YAML study specification — tte_read_spec","text":"spec_path Path YAML specification file.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_read_spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read and validate a YAML study specification — tte_read_spec","text":"nested list representing parsed specification,   `window_weeks` fields added exclusion criteria confounders.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_read_spec.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read and validate a YAML study specification — tte_read_spec","text":"Window conversion rules: `\"lifetime_before_baseline\"` -> `Inf` `\"N year\"` `\"N years\"` -> `N * 52` Validation checks: Required sections: study, enrollments, outcomes, follow_up `study$implementation$project_prefix` must exist exclusion criterion must `implementation$source_variable` outcome must `implementation$variable` enrollment must `id` `exposure$implementation$variable` Computed confounders must `implementation$source_variable` Warns open questions `status: \"open\"`.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_time_to_event.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate time to first event for each trial — tte_time_to_event","title":"Calculate time to first event for each trial — tte_time_to_event","text":"Computes time (tstop) first period event occurs trial. common preprocessing step survival analysis target trial emulation.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_time_to_event.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate time to first event for each trial — tte_time_to_event","text":"","code":"tte_time_to_event(   data,   id_var,   event_cols,   tstop_var = \"tstop\",   prefix = \"weeks_to_\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_time_to_event.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate time to first event for each trial — tte_time_to_event","text":"data data.table counting-process format. id_var Character, name trial identifier column. event_cols Character vector, names event indicator columns (binary: 1 = event occurred, 0 = event). tstop_var Character, name period end time column (default: \"tstop\"). prefix Character, prefix output columns (default: \"weeks_to_\").","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_time_to_event.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate time to first event for each trial — tte_time_to_event","text":"input data.table added columns prefix + event_col   event column. contains tstop first period   event, NA event occurred.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_time_to_event.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate time to first event for each trial — tte_time_to_event","text":"trial event type, function finds first period event indicator equals 1, returns tstop (end time) period. represents \"time event\" discrete-time survival analysis. result trial-level (constant within trial) typically used : Determining censoring times Creating survival outcomes Defining analysis endpoints","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_time_to_event.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate time to first event for each trial — tte_time_to_event","text":"","code":"library(data.table) dt <- data.table(   trial_id = rep(1:3, each = 4),   tstart = rep(c(0, 4, 8, 12), 3),   tstop = rep(c(4, 8, 12, 16), 3),   death = c(0,0,1,0, 0,0,0,0, 0,1,0,0),   hosp = c(0,1,0,0, 0,0,0,1, 0,0,0,0) ) result <- tte_time_to_event(dt, \"trial_id\", c(\"death\", \"hosp\")) # Trial 1: weeks_to_death = 12, weeks_to_hosp = 8 # Trial 2: weeks_to_death = NA, weeks_to_hosp = 16 # Trial 3: weeks_to_death = 8, weeks_to_hosp = NA"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_truncate_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Truncate extreme inverse probability weights — tte_truncate_weights","title":"Truncate extreme inverse probability weights — tte_truncate_weights","text":"Truncates weights specified quantiles reduce variance inflation extreme values. common practice causal inference balance bias-variance tradeoff using inverse probability weights.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_truncate_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Truncate extreme inverse probability weights — tte_truncate_weights","text":"","code":"tte_truncate_weights(   data,   weight_cols,   lower = 0.01,   upper = 0.99,   suffix = \"_trunc\" )"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_truncate_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Truncate extreme inverse probability weights — tte_truncate_weights","text":"data data.table containing weight columns truncate. weight_cols Character vector column names containing weights truncate. lower Numeric, lower quantile cutoff (default: 0.01 1st percentile). upper Numeric, upper quantile cutoff (default: 0.99 99th percentile). suffix Character, suffix append column names truncated weights (default: \"_trunc\").","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_truncate_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Truncate extreme inverse probability weights — tte_truncate_weights","text":"input data.table added columns truncated weights. Column   names follow pattern original_col + suffix.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_truncate_weights.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Truncate extreme inverse probability weights — tte_truncate_weights","text":"Weight truncation addresses variance inflation can occur inverse probability weights. Extreme weights (large small) can dramatically increase variance effect estimates. Truncating 1st 99th percentiles common choice typically introduces minimal bias substantially reducing variance. function calculates quantiles across non-NA values column, clips values outside bounds boundary values.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_truncate_weights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Truncate extreme inverse probability weights — tte_truncate_weights","text":"","code":"library(data.table) dt <- data.table(   id = 1:100,   ipw = c(0.1, rep(1, 98), 10),  # Extreme values at ends   analysis_weight_pp = runif(100, 0.5, 2) ) result <- tte_truncate_weights(dt, weight_cols = c(\"ipw\", \"analysis_weight_pp\")) # Creates ipw_trunc and analysis_weight_pp_trunc columns"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_validate_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate spec variables against skeleton data — tte_validate_spec","title":"Validate spec variables against skeleton data — tte_validate_spec","text":"Checks `implementation$variable` references spec actually exist columns skeleton data.table. categorical confounders, also checks declared categories match data. Collects issues reporting.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_validate_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate spec variables against skeleton data — tte_validate_spec","text":"","code":"tte_validate_spec(spec, skeleton)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_validate_spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate spec variables against skeleton data — tte_validate_spec","text":"spec Parsed study specification [tte_read_spec()]. skeleton data.table skeleton (person-week panel) validate .","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/tte_validate_spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate spec variables against skeleton data — tte_validate_spec","text":"`invisible(TRUE)` success; emits warning numbered   issue list checks fail.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_data_structure.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate data structure for add_* functions — validate_data_structure","title":"Validate data structure for add_* functions — validate_data_structure","text":"Validate data structure add_* functions","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_data_structure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate data structure for add_* functions — validate_data_structure","text":"","code":"validate_data_structure(data, required_cols = NULL, data_type = \"data\")"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_data_structure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate data structure for add_* functions — validate_data_structure","text":"data data.table containing data required_cols Character vector required column names data_type Character string describing data type (error messages)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_data_structure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate data structure for add_* functions — validate_data_structure","text":"Nothing valid, stops error invalid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_date_column.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate date column exists and is proper format — validate_date_column","title":"Validate date column exists and is proper format — validate_date_column","text":"Validate date column exists proper format","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_date_column.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate date column exists and is proper format — validate_date_column","text":"","code":"validate_date_column(data, date_col, data_type = \"data\")"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_date_column.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate date column exists and is proper format — validate_date_column","text":"data data.table containing data date_col Character string date column name data_type Character string describing data type (error messages)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_date_column.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate date column exists and is proper format — validate_date_column","text":"Nothing valid, stops error invalid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_date_columns.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate date columns exist and are proper format — validate_date_columns","title":"Validate date columns exist and are proper format — validate_date_columns","text":"Validate date columns exist proper format","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_date_columns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate date columns exist and are proper format — validate_date_columns","text":"","code":"validate_date_columns(data, expected_date_cols, data_type = \"data\")"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_date_columns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate date columns exist and are proper format — validate_date_columns","text":"data data.table containing data expected_date_cols Character vector expected date column names data_type Character string describing data type (error messages)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_date_columns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate date columns exist and are proper format — validate_date_columns","text":"Nothing valid, stops error invalid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_death_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate death registry data columns — validate_death_data","title":"Validate death registry data columns — validate_death_data","text":"Validate death registry data columns","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_death_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate death registry data columns — validate_death_data","text":"","code":"validate_death_data(data)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_death_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate death registry data columns — validate_death_data","text":"data data.table containing death registry data","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_death_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate death registry data columns — validate_death_data","text":"Nothing valid, stops error invalid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_id_column.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate ID column exists in dataset — validate_id_column","title":"Validate ID column exists in dataset — validate_id_column","text":"Validate ID column exists dataset","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_id_column.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate ID column exists in dataset — validate_id_column","text":"","code":"validate_id_column(data, id_name)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_id_column.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate ID column exists in dataset — validate_id_column","text":"data data.table containing data id_name Character string ID column name","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_id_column.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate ID column exists in dataset — validate_id_column","text":"Nothing valid, stops error invalid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_isoyear.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate isoyear parameter — validate_isoyear","title":"Validate isoyear parameter — validate_isoyear","text":"Validate isoyear parameter","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_isoyear.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate isoyear parameter — validate_isoyear","text":"","code":"validate_isoyear(isoyear)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_isoyear.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate isoyear parameter — validate_isoyear","text":"isoyear Integer year value","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_isoyear.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate isoyear parameter — validate_isoyear","text":"Nothing valid, stops error invalid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_pattern_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate pattern list for diagnoses/operations/prescriptions/cods — validate_pattern_list","title":"Validate pattern list for diagnoses/operations/prescriptions/cods — validate_pattern_list","text":"Validate pattern list diagnoses/operations/prescriptions/cods","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_pattern_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate pattern list for diagnoses/operations/prescriptions/cods — validate_pattern_list","text":"","code":"validate_pattern_list(pattern_list, pattern_type = \"patterns\")"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_pattern_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate pattern list for diagnoses/operations/prescriptions/cods — validate_pattern_list","text":"pattern_list Named list patterns pattern_type Character string describing pattern type (error messages)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_pattern_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate pattern list for diagnoses/operations/prescriptions/cods — validate_pattern_list","text":"Nothing valid, stops error invalid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_prescription_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate prescription-specific columns — validate_prescription_data","title":"Validate prescription-specific columns — validate_prescription_data","text":"Validate prescription-specific columns","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_prescription_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate prescription-specific columns — validate_prescription_data","text":"","code":"validate_prescription_data(data)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_prescription_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate prescription-specific columns — validate_prescription_data","text":"data data.table containing prescription data","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_prescription_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate prescription-specific columns — validate_prescription_data","text":"Nothing valid, stops error invalid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_skeleton_structure.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate skeleton structure — validate_skeleton_structure","title":"Validate skeleton structure — validate_skeleton_structure","text":"Validate skeleton structure","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_skeleton_structure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate skeleton structure — validate_skeleton_structure","text":"","code":"validate_skeleton_structure(skeleton)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_skeleton_structure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate skeleton structure — validate_skeleton_structure","text":"skeleton data.table valid skeleton","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/validate_skeleton_structure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate skeleton structure — validate_skeleton_structure","text":"Nothing valid, stops error invalid","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2023_mht_add_lmed.html","id":null,"dir":"Reference","previous_headings":"","what":"Add 2023 MHT-specific prescription data to skeleton — x2023_mht_add_lmed","title":"Add 2023 MHT-specific prescription data to skeleton — x2023_mht_add_lmed","text":"Processes Swedish prescription registry data (LMED) specifically 2023 Menopausal Hormone Therapy (MHT) study. Categorizes medications predefined groups, applies duration fixes, creates treatment approach variables.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2023_mht_add_lmed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add 2023 MHT-specific prescription data to skeleton — x2023_mht_add_lmed","text":"","code":"x2023_mht_add_lmed(skeleton, lmed)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2023_mht_add_lmed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add 2023 MHT-specific prescription data to skeleton — x2023_mht_add_lmed","text":"skeleton data.table containing main skeleton structure lmed data.table containing prescription registry data columns: p1163_lopnr_personnr (ID), produkt (product name), edatum (dispensing date), fddd (duration days), atc (ATC code)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2023_mht_add_lmed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add 2023 MHT-specific prescription data to skeleton — x2023_mht_add_lmed","text":"skeleton data.table modified reference MHT treatment   variables approach categorizations added. Returns modified skeleton invisibly.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2023_mht_add_lmed.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add 2023 MHT-specific prescription data to skeleton — x2023_mht_add_lmed","text":"function performs several steps: Restricts LMED data individuals skeleton Categorizes products MHT groups (A1-I2) based product names Applies duration fixes specific products (IUDs, minimum doses) Creates treatment approach variables based predefined logic Handles treatment gaps overlapping prescriptions","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2023_mht_add_lmed.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Add 2023 MHT-specific prescription data to skeleton — x2023_mht_add_lmed","text":"function specific 2023 MHT study uses study-specific   categorizations approaches defined package data dictionary.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2026_mht_add_lmed.html","id":null,"dir":"Reference","previous_headings":"","what":"Add 2023 MHT-specific prescription data to skeleton — x2026_mht_add_lmed","title":"Add 2023 MHT-specific prescription data to skeleton — x2026_mht_add_lmed","text":"Processes Swedish prescription registry data (LMED) specifically 2023 Menopausal Hormone Therapy (MHT) study. Categorizes medications predefined groups, applies duration fixes, creates treatment approach variables.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2026_mht_add_lmed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add 2023 MHT-specific prescription data to skeleton — x2026_mht_add_lmed","text":"","code":"x2026_mht_add_lmed(skeleton, lmed, verbose = TRUE)"},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2026_mht_add_lmed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add 2023 MHT-specific prescription data to skeleton — x2026_mht_add_lmed","text":"skeleton data.table containing main skeleton structure lmed data.table containing prescription registry data columns: lopnr (ID), produkt (product name), edatum (dispensing date), fddd (duration days), atc (ATC code) verbose Logical. TRUE (default), print progress messages stderr.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2026_mht_add_lmed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add 2023 MHT-specific prescription data to skeleton — x2026_mht_add_lmed","text":"skeleton data.table modified reference MHT treatment   variables approach categorizations added. Returns modified skeleton invisibly.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2026_mht_add_lmed.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add 2023 MHT-specific prescription data to skeleton — x2026_mht_add_lmed","text":"function performs several steps: Restricts LMED data individuals skeleton Categorizes products MHT groups (A1-I2) based product names Applies duration fixes specific products (IUDs, minimum doses) Creates treatment approach variables based predefined logic Handles treatment gaps overlapping prescriptions","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/reference/x2026_mht_add_lmed.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Add 2023 MHT-specific prescription data to skeleton — x2026_mht_add_lmed","text":"function specific 2023 MHT study uses study-specific   categorizations approaches defined package data dictionary.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"improvements-26-2-27","dir":"Changelog","previous_headings":"","what":"Improvements","title":"swereg 26.2.27","text":"VALIDATION: tte_validate_spec() now emits warning() instead stop() spec variables values missing skeleton. makes validation informational rather blocking, useful working small data subsets rare categories may absent.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-26-2-22","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 26.2.22","text":"EXPORTED: tte_callr_pool() — generic callr::r_bg() worker pool, generalized internal .tte_callr_pool(). New API accepts items (list arg-lists), worker_fn, item_labels, collect (FALSE discard results workers save directly). Eliminates boilerplate scripts need parallel loops (e.g., Loop 2 IPCW-PP). NEW: TTEPlan$generate_analysis_files_and_ipcw_pp() — Loop 2 method runs per-ETT IPCW-PP calculation saves analysis-ready files. Mirrors $generate_enrollments_and_ipw() (Loop 1). Parameters: output_dir, estimate_ipcw_pp_separately_by_exposure, estimate_ipcw_pp_with_gam, n_workers, swereg_dev_path.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"improvements-26-2-22","dir":"Changelog","previous_headings":"","what":"Improvements","title":"swereg 26.2.22","text":"MEMORY: tte_calculate_ipcw() now uses mgcv::bam(discrete = TRUE) instead mgcv::gam() use_gam = TRUE. bam() discretizes covariates avoid forming full model matrix, dramatically reducing peak memory large datasets. Model objects also explicitly freed (rm() + gc()) exposed/unexposed fits. MEMORY: $irr() $km() now subset columns needed creating survey::svydesign(). Previously full data.table (columns) copied survey object. Model objects intermediate data freed fits.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-2-21","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.2.21","text":"RENAMED: $prepare_for_analysis() parameters estimate_ipcw_separately_by_exposure → estimate_ipcw_pp_separately_by_exposure estimate_ipcw_with_gam → estimate_ipcw_pp_with_gam consistency IPCW-PP method control. PRIVATE: $enroll(), $prepare_outcome(), $ipcw_pp(), $combine_weights() now private methods TTEEnrollment. Enrollment: use tte_enrollment(data, design, ratio = 2, seed = 4) instead tte_enrollment(data, design)$enroll(ratio = 2, seed = 4). Outcome prep + IPCW: use $prepare_for_analysis() (unchanged). Weight combination: handled automatically $ipcw_pp() (unchanged). Tests can access private methods via enrollment$.__enclos_env__$private$method_name().","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-2-20","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.2.20","text":"RENAMED: $prepare_analysis() → $prepare_for_analysis() TTEEnrollment. new name better communicates method prepares enrollment analysis (analysis ).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"bug-fixes-26-2-20","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"swereg 26.2.20","text":"FIXED: 3 remaining broken test calls (tte_extract(), tte_summary(), tte_weights()) migrated R6 method syntax ($extract(), print(), $combine_weights()). Column assertion updated: \"weight_pp\" → \"analysis_weight_pp\". FIXED: $impute_confounders() now appends \"impute\" steps_completed, consistent mutating methods. FIXED: $ipcw_pp() IPW column guard moved IPCW computation (fail-fast).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"documentation-26-2-20","dir":"Changelog","previous_headings":"","what":"Documentation","title":"swereg 26.2.20","text":"FIXED: Vignette truncation bounds corrected “0.5th 99.5th percentiles” “1st 99th percentiles” (matching code defaults lower = 0.01, upper = 0.99). FIXED: TTEDesign roxygen references removed tte_match() / tte_expand() replaced $enroll(). FIXED: $weight_summary() moved “Mutating” “Non-mutating” section TTEEnrollment roxygen (prints, never modifies data).","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-26-2-13","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 26.2.13","text":"NEW: $prepare_for_analysis() method TTEEnrollment merges $prepare_outcome() + $ipcw_pp() one step. Parameters: outcome, follow_up, separate_by_exposure, use_gam, censoring_var. NEW: $enrollment_stage active binding TTEEnrollment. Derives lifecycle stage existing state: \"pre_enrollment\" → \"enrolled\" → \"analysis_ready\". Zero maintenance — reads data_level steps_completed.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"bug-fixes-26-2-13","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"swereg 26.2.13","text":"FIXED: 24 broken test cases calling removed standalone functions (tte_enroll(), tte_collapse(), tte_ipw(), tte_truncate(), tte_prepare_outcome()) migrated R6 method syntax. Error message patterns updated match method names (e.g., enroll() tte_enroll()).","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-2-12","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.2.12","text":"RENAMED: TTETrial class → TTEEnrollment, tte_trial() → tte_enrollment(), summary.TTETrial → summary.TTEEnrollment. class represents enrollment (matching + panel expansion), individual emulated target trial (ETT). Aligns naming ETT grid concept TTEPlan.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-2-11","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.2.11","text":"REMOVED: 19 standalone TTE functions moved R6 methods TTETrial (15 methods) TTEPlan (4 methods). Pipe chaining (trial |> tte_ipw()) replaced $-chaining (trial$ipw()). TTETrial methods: $enroll(), $collapse(), $ipw(), $ipcw_pp(), $combine_weights(), $truncate(), $prepare_outcome(), $impute_confounders(), $weight_summary(), $extract(), $summary(), $table1(), $rates(), $irr(), $km(). TTEPlan methods: $add_one_ett(), $save(), $enrollment_spec(), $generate_enrollments_and_ipw(). RENAMED: TTEPlan$task() → TTEPlan$enrollment_spec(). method returns enrollment metadata (design, enrollment_id, age_range, n_threads), generic task. process_fn callback parameter convention changes function(task, file_path) function(enrollment_spec, file_path). Removed exports: tte_enroll, tte_collapse, tte_ipw, tte_ipcw_pp, tte_weights, tte_truncate, tte_prepare_outcome, tte_extract, tte_summary, tte_weight_summary, tte_table1, tte_rates, tte_irr, tte_km, tte_plan_add_one_ett, tte_plan_save, tte_plan_task, tte_generate_enrollments_and_ipw. Kept standalone: tte_rbind(), tte_rates_combine(), tte_irr_combine(), tte_impute_confounders() (thin wrapper callback default). CHANGED: TTE classes (TTEDesign, TTETrial, TTEPlan) migrated S7 R6. Property access changes @ $ (e.g., trial@data → trial$data, design@id_var → design$id_var). R6 reference semantics eliminate copy--write overhead trial$data[, := ...], reducing peak RAM ~3X ~2X weight-calculation chain (Loop 2). FIXED: Three S7 @ accessor bugs silently produced -ops: $ipcw_pp(): dropping intermediate IPCW columns (p_censor, etc.) $collapse(): creating person_weeks column $impute_confounders(): deleting old confounder columns merge fixed automatically R6 (-place modification works). CHANGED: $ipcw_pp() now inlines weight combination truncation (calling tte_combine_weights() tte_truncate_weights() via function parameters created extra refcount). Keeps data.table refcount=1 throughout.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"file-reorganization-26-2-11","dir":"Changelog","previous_headings":"","what":"File reorganization","title":"swereg 26.2.11","text":"Split tte_classes.R tte_methods.R per-class files methods inline: tte_design.R, tte_trial.R, tte_plan.R. tte_generate.R reduced thin tte_impute_confounders() wrapper + .tte_callr_pool() helper. Added S3method(summary, TTETrial) → delegates $summary().","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"dependencies-26-2-11","dir":"Changelog","previous_headings":"","what":"Dependencies","title":"swereg 26.2.11","text":"ADDED: R6 package Imports (S7 retained skeleton classes).","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"bug-fixes-26-2-10","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"swereg 26.2.10","text":"FIXED: tte_ipw(), tte_ipcw_pp(): -place joins via S7 @ accessor now use extract/modify/reassign pattern (dt <- trial@data; dt[...]; trial@data <- dt). previous trial@data[, := ...] silently modified copy, leaving S7 object’s data unchanged.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"performance-26-2-10","dir":"Changelog","previous_headings":"","what":"Performance","title":"swereg 26.2.10","text":"IMPROVED: tte_ipw(), tte_ipcw_pp(), tte_calculate_ipcw(): replace merge() -place keyed joins (data[, := ...]), reducing peak RAM ~3x ~2x panel size weight-calculation chain.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-2-10","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.2.10","text":"CHANGED: tte_ipcw_pp() now also combines weights (ipw * ipcw_pp → analysis_weight_pp), truncates analysis_weight_pp, drops intermediate IPCW columns (p_censor, p_uncensored, cum_p_uncensored, marginal_p, cum_marginal). Callers longer need tte_weights() + tte_truncate() tte_ipcw_pp(). RENAMED: tte_generate_enrollments() → tte_generate_enrollments_and_ipw(). Now computes IPW + truncation full combined enrollment (imputation), per-ETT Loop 2 longer needs call tte_ipw(). New stabilize parameter (default TRUE) controls IPW stabilization.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-26-2-10","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 26.2.10","text":"NEW: tte_plan_load() reads .qs2 plan file reconstructs TTEPlan S7 object. Companion tte_plan_save(). CHANGED: tte_plan_save() now persists project_prefix skeleton_files alongside ett global_max_isoyearweek, tte_plan_load() can fully reconstruct object. NEW: skeleton_process() gains n_workers parameter parallel batch processing. > 1, uses callr::r() + parallel::mclapply() process batches concurrently avoiding fork() + data.table OpenMP segfaults.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"improvements-26-2-9","dir":"Changelog","previous_headings":"","what":"Improvements","title":"swereg 26.2.9","text":"CHANGED: Migrate serialization qs (archived) qs2. .qs_save/.qs_read wrappers now call qs2::qs_save/qs2::qs_read (standard format, preserves S7 objects). file extensions changed .qs .qs2. preset parameter longer used. IMPROVED: tte_rates() now sets swereg_type exposure_var attributes output; tte_irr() sets swereg_type. RENAMED: tte_rates_table() → tte_rates_combine(), tte_irr_table() → tte_irr_combine(). New API accepts (results, slot, descriptions) — extracts rates/irr slot internally, removing need lapply(results, [[, \"table2\") call sites. Exposure column now read exposure_var attribute instead guessing via setdiff().","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-2-9","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.2.9","text":"CHANGED: tte_plan_add_one_ett() now requires explicit enrollment_id parameter. Auto-assignment based follow_up + age_group removed. Validation design params match within enrollment_id preserved. IMPROVED: print(plan) now shows enrollment grid full ETT grid. CHANGED: tte_plan_add_one_ett() bundles age_group, age_min, age_max, person_id_var argset named list parameter. time_exposure_var eligible_var longer defaults (must explicit). exposure_var removed interface (hardcoded \"baseline_exposed\"). RENAMED: file_id column ett data.table → enrollment_id. makes explicit ETTs sharing follow_up + age_group processed together one “enrollment” (shared eligibility, matching, collapse, imputation). RENAMED: tte_generate_trials() → tte_generate_enrollments(). function generates enrollments (one per follow_up × age_group), individual trials. RENAMED: tte_plan_task() return list key file_id → enrollment_id. UPDATED: print(plan) now shows “Enrollments: N x M skeleton files” instead “Tasks: N file_id(s) x M skeleton files”.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-2-8","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.2.8","text":"CHANGED: tte_plan() now infrastructure-— takes project_prefix, skeleton_files, global_max_isoyearweek. Use tte_plan_add_one_ett() add ETTs per-ETT design parameters. REMOVED: TTEPlan plan-level properties confounder_vars, person_id_var, exposure_var, time_exposure_var, eligible_var. now per-ETT columns ett data.table. REMOVED: Internal .tte_grid() function. ETT grid now built incrementally via tte_plan_add_one_ett(). ADDED: TTEPlan@project_prefix property (needed file naming tte_plan_add_one_ett()).","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-26-2-8","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 26.2.8","text":"NEW: tte_plan_add_one_ett() — builder function adds one ETT row plan. Stores design params (confounder_vars, person_id_var, exposure_var, time_exposure_var, eligible_var) per-ETT, allowing different ETTs use different confounders. Validates design params match within enrollment_id (follow_up + age_group). RENAMED: TTEPlan@files property → TTEPlan@skeleton_files clarity.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-2-7","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.2.7","text":"REFACTORED: tte_generate_enrollments() (formerly tte_generate_trials()) now takes TTEPlan object instead separate parameters (ett, files, confounder_vars, global_max_isoyearweek). process_fn callback signature changes function(file_path, design, file_id, age_range, n_threads) function(task, file_path) task list design, enrollment_id, age_range, n_threads.","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-26-2-7","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 26.2.7","text":"tte_plan(): Constructor function tte_plan_task(plan, ): Extract -th enrollment task list design, enrollment_id, age_range, n_threads plan[[]]: Shorthand tte_plan_task(plan, ) length(plan): Number unique enrollment_id groups Supports interactive testing: task <- plan[[1]]; process_fn(task, plan@skeleton_files[1])","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"documentation-26-2-6","dir":"Changelog","previous_headings":"","what":"Documentation","title":"swereg 26.2.6","text":"FIXED: Add missing topics pkgdown reference index (TTEDesign, TTETrial, x2026_mht_add_lmed)","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"bug-fixes-26-2-5","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"swereg 26.2.5","text":"FIXED: Set eval = FALSE skeleton3-analyze vignette prevent build errors optional qs package dependency","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"bug-fixes-26-2-4","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"swereg 26.2.4","text":"FIXED: Remove qs Suggests fix GitHub Actions CI (package available CRAN)","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-2-3","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.2.3","text":"Old workflow: tte_trial(data, design) |> tte_match(ratio = 2, seed = 4) |> tte_expand(extra_cols = \"isoyearweek\") New workflow: tte_trial(data, design) |> tte_enroll(ratio = 2, seed = 4, extra_cols = \"isoyearweek\") two operations tightly coupled always used together tte_enroll() combines sampling (matching) panel expansion one step Records “enroll” steps_completed (previously recorded “match” “expand”)","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-26-2-3","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 26.2.3","text":"tte_eligible_isoyears(): Check eligibility based calendar years tte_eligible_age_range(): Check eligibility based age range tte_eligible_no_events_in_window_excluding_wk0(): Check events prior window (correctly excludes baseline week) tte_eligible_no_observation_in_window_excluding_wk0(): Check specific value prior window (categorical variables) tte_eligible_combine(): Combine multiple eligibility columns using logic functions modify data.tables reference return invisibly method chaining","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"documentation-26-2-3","dir":"Changelog","previous_headings":"","what":"Documentation","title":"swereg 26.2.3","text":"IMPROVED: Clarified eligibility checks EXCLUDE baseline week. Using cumsum(x) == 0 incorrect includes current week. new eligibility functions use any_events_prior_to() correctly excludes current row.","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-26-1-31","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 26.1.31","text":"TTEDesign class: Define column name mappings reuse across TTE functions TTETrial class: Fluent method chaining workflow state tracking tte_design() / tte_trial(): Constructor functions S7 classes tte_match(), tte_expand(), tte_collapse(), tte_ipw(): S7 methods data preparation tte_prepare_outcome(), tte_ipcw(): Outcome-specific per-protocol analysis tte_weights(), tte_truncate(): Weight combination truncation tte_rbind(): Combine batched trial objects tte_extract(), tte_summary(): Access data diagnostics tte_table1(), tte_rates(), tte_irr(), tte_km(): Analysis visualization","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"breaking-changes-26-1-31","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"swereg 26.1.31","text":"tte_tte(): Use tte_prepare_outcome() computes weeks_to_event internally tte_set_outcome(): Use tte_prepare_outcome(outcome = \"...\") instead tte_censoring(): Use tte_prepare_outcome() handles censoring internally","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"dependencies-26-1-31","dir":"Changelog","previous_headings":"","what":"Dependencies","title":"swereg 26.1.31","text":"ADDED: S7 package Imports object-oriented class system","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-26-1-30","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 26.1.30","text":"tte_calculate_ipw(): Calculate stabilized inverse probability treatment weights (IPW) baseline confounding adjustment using propensity scores tte_calculate_ipcw(): Calculate time-varying inverse probability censoring weights (IPCW) per-protocol analysis using GAM GLM tte_identify_censoring(): Identify protocol deviation loss follow-per-protocol analysis tte_combine_weights(): Combine IPW IPCW weights per-protocol effect estimation tte_truncate_weights(): Truncate extreme weights specified quantiles reduce variance tte_match_ratio(): Sample comparison group specified ratio (e.g., 2:1 unexposed exposed) tte_collapse_periods(): Collapse fine-grained time intervals (e.g., weekly) coarser periods (e.g., 4-week) tte_time_to_event(): Calculate time first event trial/person","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"dependencies-26-1-30","dir":"Changelog","previous_headings":"","what":"Dependencies","title":"swereg 26.1.30","text":"ADDED: mgcv package Imports flexible GAM-based censoring models tte_calculate_ipcw()","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"api-changes-25-12-24","dir":"Changelog","previous_headings":"","what":"API changes","title":"swereg 25.12.24","text":"source column longer required diagnosis data track diagnoses source (inpatient/outpatient/cancer), filter dataset externally calling add_diagnoses() See ?add_diagnoses recommended pattern","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-25-12-24","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 25.12.24","text":"Checks TRUE values exist preceding time window (excludes current row) Useful determining event occurred prior time period Default window 104 weeks (~2 years) customizable size Complements steps_to_first() comprehensive time--event analysis Renamed parameter window window_including_wk0 clarity Default window now 104 (inclusive current week) Added @family survival_analysis tag cross-reference any_events_prior_to()","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"bug-fixes-25-12-24","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"swereg 25.12.24","text":"FIXED: Added slider package Imports DESCRIPTION fix R CMD check warning undeclared import","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"data-25-12-24","dir":"Changelog","previous_headings":"","what":"Data","title":"swereg 25.12.24","text":"New SOURCE column identifies data origin: “inpatient”, “outpatient”, “cancer” ~2000 inpatient records, ~2000 outpatient records, ~1000 cancer records Cancer records always populated ICDO3 codes Enables testing source-based filtering validation ICDO3: ICD-O-3 morphology codes (always populated cancer source) SNOMED3: SNOMED-CT version 3 codes SNOMEDO10: SNOMED-CT version 10 codes","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"validation-25-12-24","dir":"Changelog","previous_headings":"","what":"Validation","title":"swereg 25.12.24","text":"ENHANCED: SOURCE column validation now optional - filter externally needed (see API changes )","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"documentation-25-12-24","dir":"Changelog","previous_headings":"","what":"Documentation","title":"swereg 25.12.24","text":"IMPROVED: Examples add_icdo3s(), add_snomed3s(), add_snomedo10s() now runnable using package fake data (previously wrapped \\dontrun{})","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-25-12-6","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 25.12.6","text":"Calculates number steps (e.g., weeks) first TRUE value forward-looking window Useful time--event calculations longitudinal registry data Default window 103 weeks (~2 years) customizable size Returns NA event occurs within window","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"bug-fixes-25-12-6","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"swereg 25.12.6","text":"functions now correctly call add_diagnoses_or_operations_or_cods_or_icdo3_or_snomed() functions caused runtime errors fix ICD-O editions 1, 2, 3 (10) ICD-O-3 codes handled via dedicated add_icdo3s() function Historical ICD-7 ICD-9 columns now properly searched diag_type = \"\" Validation helper function now consistent Messages now correctly reference appropriate data types instead “operation data”","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"documentation-25-12-6","dir":"Changelog","previous_headings":"","what":"Documentation","title":"swereg 25.12.6","text":"diag_type = \"\": hdia, dia*, ekod*, icd7*, icd9* diag_type = \"main\": hdia ","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"cran-submission-preparation-25-8-19","dir":"Changelog","previous_headings":"","what":"CRAN Submission Preparation","title":"swereg 25.8.19","text":"Fixed DESCRIPTION file author field duplication issue Updated .Rbuildignore exclude development files (docs/, .git/, .Rhistory, etc.) Removed non-portable files (@eaDir directories, .DS_Store files) Added missing global variable declarations prevent R CMD check warnings Verified URL consistency DESCRIPTION package startup messages Reduced total vignette content 31% (626 lines removed) Condensed cookbook-survival-analysis.Rmd (removed verbose descriptive statistics redundant sections) Simplified skeleton2-clean.Rmd (removed duplicated skeleton1_create workflow) Streamlined skeleton3-analyze.Rmd (removed redundant data loading best practices sections) Fixed vignette build errors ensuring consistent data variable availability vignettes now compile successfully use package synthetic data consistently VALIDATED: examples runnable using package fake data - \\dontrun sections without justification","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"code-quality-improvements-25-8-19","dir":"Changelog","previous_headings":"","what":"Code Quality Improvements","title":"swereg 25.8.19","text":"Updated vignettes use lowercase date_columns parameters (e.g., “indatum” instead “INDATUM”) Added warning make_lowercase_names() function uppercase date_columns provided Enhanced documentation clarify date_columns use lowercase names Improved user experience clear guidance automatic handling uppercase inputs Replaced verbose data() loading patterns elegant pipe syntax Updated data loading use swereg::fake_* |> copy() |> make_lowercase_names() pattern Eliminated clumsy multi-step data preparation code throughout vignettes Improved code flow professional appearance package examples VERIFIED: Package builds successfully R CMD build passes CRAN compliance checks CONFIRMED: inst/ directory contains files referenced package functions","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-25-7-30","dir":"Changelog","previous_headings":"","what":"New Features","title":"swereg 25.7.30","text":"Simplifies common pattern creating row-independent variables first occurrence conditions Automatically handles temp variable creation cleanup Uses first_non_na() robust aggregation across variable types Includes comprehensive input validation clear error messages Explains fundamental distinction row-dependent row-independent variables Demonstrates common transformation patterns practical examples Shows integration swereg workflow (skeleton1_create → skeleton2_clean → skeleton3_analyze) Includes best practices longitudinal registry data analysis","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"documentation-25-7-30","dir":"Changelog","previous_headings":"","what":"Documentation","title":"swereg 25.7.30","text":"ENHANCED: Helper functions now include @family data_integration tags better organization IMPROVED: Function examples use existing fake datasets consistency","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-swedish-date-parsing-and-enhanced-data-cleaning-25-7-16","dir":"Changelog","previous_headings":"","what":"New Swedish Date Parsing and Enhanced Data Cleaning","title":"swereg 25.7.16","text":"Handles 4-character (YYYY), 6-character (YYYYMM), 8-character (YYYYMMDD) formats Automatically replaces “0000” “0701” “00” “15” missing date components Supports custom defaults missing date parts Includes comprehensive error handling vectorized processing New date_column parameter specify column contains dates Automatically creates cleaned ‘date’ column using parse_swedish_date() Works default data.table methods Maintains backward compatibility existing code add_diagnoses(), add_operations(), add_rx(), add_cods() expect ‘date’ column Clear error messages guide users use make_lowercase_names(data, date_column = \"...\") Improved validation ensures data preprocessing consistency Annual rows (is_isoyear==TRUE) personyears = 1 Weekly rows (is_isoyear==FALSE) personyears = 1/52.25 Facilitates person-time calculations survival analysis Uses weekly data instead yearly data precise analyses Age calculation based isoyearweeksun instead isoyear Includes person-time descriptive statistics Demonstrates proper use new date cleaning workflow","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"enhanced-error-handling-and-validation-25-7-16","dir":"Changelog","previous_headings":"","what":"Enhanced error handling and validation","title":"swereg 25.7.16","text":"add_onetime(): Validates skeleton structure, ID column exists, checks ID matches add_annual(): Validates isoyear parameter, checks skeleton year coverage add_diagnoses(): Validates diagnosis patterns, checks diagnosis code columns add_operations(): Validates operation patterns, checks operation code columns add_rx(): Validates prescription data structure, checks source columns add_cods(): Validates death data structure, checks cause death columns Clear indication make_lowercase_names() forgotten Helpful suggestions column naming issues Informative ID mismatch diagnostics sample values NEW: Internal validation helper functions consistent error handling ADDED: Input validation pattern lists, data structures, parameter ranges","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-cookbook-documentation-25-7-16","dir":"Changelog","previous_headings":"","what":"New cookbook documentation","title":"swereg 25.7.16","text":"Complete workflow raw data Cox proportional hazards model Time-varying covariates (annual income) heart attack outcome Handles common challenges: missing data, multiple events, competing risks Performance tips large datasets Practical solutions real-world registry analysis ENHANCED: Updated _pkgdown.yml new “Cookbooks” section ADDED: survival package Suggests dependencies","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"bug-fixes-25-7-16","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"swereg 25.7.16","text":"FIXED: Improved ID matching warnings error messages across functions CORRECTED: Better handling missing data time-varying covariate analysis ENHANCED: robust parameter validation prevents common user errors","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"major-documentation-restructuring-25-7-16","dir":"Changelog","previous_headings":"","what":"Major documentation restructuring","title":"swereg 25.7.16","text":"NEW “Skeleton concept” vignette: Conceptual foundation explaining skeleton approach without technical implementation “Building data skeleton (skeleton1_create)”: Pure data integration focus - raw data time-structured skeleton “Cleaning deriving variables (skeleton2_clean)”: Pure data cleaning variable derivation focus “Production analysis workflows (skeleton3_analyze)”: Memory-efficient processing final analysis datasets IMPROVED: Clear separation concerns focused, single-purpose tutorials ENHANCED: Systematic learning progression concept implementation production UPDATED: _pkgdown.yml structure logical vignette grouping PRESERVED: existing technical content improving organization","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"content-improvements-25-7-16","dir":"Changelog","previous_headings":"","what":"Content improvements","title":"swereg 25.7.16","text":"NEW: Comprehensive conceptual introduction based presentation content IMPROVED: vignette builds systematically previous one ENHANCED: Better explanation three types data integration (one-time, annual, event-based) CLARIFIED: Production workflow patterns memory-efficient batching strategies STANDARDIZED: Consistent academic tone sentence case throughout","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"documentation-and-presentation-improvements-25-7-15","dir":"Changelog","previous_headings":"","what":"Documentation and presentation improvements","title":"swereg 25.7.15","text":"Vignette titles: “Basic Workflow” → “Basic workflow”, “Complete Workflow” → “Complete workflow”, etc. README.md section headings: “Core Functions” → “Core functions”, “Data Integration” → “Data integration”, etc. NEWS.md section headings: “Vignette Restructuring” → “Vignette restructuring”, etc. CLAUDE.md section headings: “Project Overview” → “Project overview”, “Development Commands” → “Development commands”, etc. IMPROVED: Consistent normal sentence case better readability less formal appearance SIMPLIFIED: Removed subtitle text colons vignette titles cleaner presentation One-time data (demographics): Added rows person Annual data (income, family status): Added rows specific year Event-based data (diagnoses, prescriptions, deaths): Added rows events occurred CLARIFIED: Step 1 documentation now properly explains skeleton columns including isoyearweeksun VERIFIED: vignettes compile successfully improved content","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"major-documentation-and-vignette-reorganization-25-7-15","dir":"Changelog","previous_headings":"","what":"Major documentation and vignette reorganization","title":"swereg 25.7.15","text":"swereg.Rmd → basic-workflow.Rmd: Focused introduction skeleton1_create advanced-workflow.Rmd → complete-workflow.Rmd: Two-stage workflow (skeleton1_create + skeleton2_clean) memory-efficient-batching.Rmd: Maintained comprehensive three-stage workflow guide IMPROVED: Eliminated content redundancy vignettes clearer learning progression ENHANCED: Updated _pkgdown.yml configuration reflect new vignette structure","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"function-documentation-improvements-25-7-15","dir":"Changelog","previous_headings":"","what":"Function documentation improvements","title":"swereg 25.7.15","text":"Added @family tags logical grouping (data_integration, skeleton_creation, data_preprocessing) Added @seealso sections cross-references related functions vignettes Replaced placeholder examples runnable code using synthetic data Improved parameter documentation detailed descriptions expected formats Enhanced return value documentation explicit side effects description STANDARDIZED: Consistent academic tone throughout documentation","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"professional-presentation-updates-25-7-15","dir":"Changelog","previous_headings":"","what":"Professional presentation updates","title":"swereg 25.7.15","text":"IMPROVED: Removed informal elements adopted academic tone across documentation UPDATED: Changed terminology “fake data” “synthetic data” throughout ENHANCED: professional language README.md vignettes STANDARDIZED: Consistent formal tone appropriate scientific software","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"technical-improvements-25-7-15","dir":"Changelog","previous_headings":"","what":"Technical improvements","title":"swereg 25.7.15","text":"VERIFIED: vignettes compile successfully updated content TESTED: Package passes R CMD check documentation improvements UPDATED: CLAUDE.md reflects new vignette structure documentation standards","code":""},{"path":[]},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"vignette-restructuring-25-7-1","dir":"Changelog","previous_headings":"","what":"Vignette restructuring","title":"swereg 25.7.1","text":"swereg.Rmd: Clean skeleton1_create tutorial using full datasets (removed subset filtering) advanced-workflow.Rmd: Focused skeleton1→skeleton2 workflow (removed batching skeleton3 content) memory-efficient-batching.Rmd: NEW comprehensive batching vignette complete skeleton1→skeleton2→skeleton3 workflow large-scale studies IMPROVED: GitHub Actions workflow optimization dependency caching binary packages faster CI/CD","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"batching-vignette-fixes-25-7-1","dir":"Changelog","previous_headings":"","what":"Batching vignette fixes","title":"swereg 25.7.1","text":"Replace split() csutil::easy_split better batch handling Replace saveRDS/readRDS qs::qsave/qread 2-10x faster file /O Fix skeleton3_analyze properly aggregate weekly→yearly data using swereg::max_with_infinite_as_na Remove incorrect is_isoyear == TRUE filter skeleton3_analyze Fix analysis results avoid NaN outputs treatment rate calculations Add explanations weekly→yearly data aggregation qs package performance benefits","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"new-features-25-7-1","dir":"Changelog","previous_headings":"","what":"New features","title":"swereg 25.7.1","text":"NEW: Added isoyearweeksun variable create_skeleton() function - provides Date representing Sunday (last day) ISO week/year easier date calculations NEW: Updated package logo IMPROVED: Updated vignettes assume swereg loaded - functions use swereg:: prefix data() calls use package=\"swereg\" argument IMPROVED: Updated function documentation clarify pattern matching functions (add_diagnoses, add_cods, add_rx) automatically add “^” prefix - users include “^” patterns fake_person_ids: 1000 synthetic personal identifiers fake_demographics: Demographics data matching SCB format fake_annual_family: Annual family status data fake_inpatient_diagnoses fake_outpatient_diagnoses: NPR diagnosis data ICD-10 codes fake_prescriptions: LMED prescription data ATC codes hormone therapy focus fake_cod: Cause death data swereg.Rmd: Basic skeleton1_create workflow tutorial advanced-workflow.Rmd: Complete 3-phase workflow (skeleton1 → skeleton2 → skeleton3) NEW: Replaced magrittr pipe (%>%) base pipe (|>) throughout codebase NEW: Added memory-efficient batched processing examples large registry studies","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"bug-fixes-25-7-1","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"swereg 25.7.1","text":"CRITICAL: Fixed incorrect variable names fake_cod dataset - changed non-Swedish underlying_cod/contributory_cod1/contributory_cod2 correct Swedish registry names ulorsak/morsak1/morsak2 VERIFIED: Confirmed fake datasets use correct Swedish registry variable name conventions VERIFIED: ICD-10 ATC codes fake datasets properly formatted realistic","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"documentation-improvements-25-7-1","dir":"Changelog","previous_headings":"","what":"Documentation improvements","title":"swereg 25.7.1","text":"BREAKING: Fixed incorrect function descriptions copied another package add_onetime(): Documents merging one-time/baseline data skeleton add_annual(): Documents merging annual data specific ISO years add_cods(): Documents cause death analysis ICD-10 codes add_diagnoses(): Documents diagnosis analysis main/secondary diagnoses add_operations(): Documents surgical operation analysis including gender-affirming procedures add_rx(): Documents prescription drug analysis ATC/product codes create_skeleton(): Documents longitudinal skeleton creation detailed return structure make_lowercase_names(): Documents generic function S3 methods x2023_mht_add_lmed(): Documents specialized MHT study function min_with_infinite_as_na(), max_with_infinite_as_na() as_logical_min_with_infinite_as_na(), as_logical_max_with_infinite_as_na() first_non_na(), last_non_na() NEW: Added @param descriptions function parameters NEW: Added @return descriptions explaining function outputs NEW: Added @examples practical usage demonstrations NEW: Added @details @note sections complex functions IMPROVED: Used proper roxygen2 practices including @rdname S3 methods @seealso cross-references","code":""},{"path":"https://papadopoulos-lab.github.io/swereg/news/index.html","id":"package-structure-25-7-1","dir":"Changelog","previous_headings":"","what":"Package structure","title":"swereg 25.7.1","text":"exported functions now complete, accurate documentation suitable CRAN submission Documentation focuses Swedish registry data analysis workflows Examples use \\dontrun{} appropriately functions requiring external data","code":""}]
